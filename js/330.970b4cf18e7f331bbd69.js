(self.webpackChunkprovisioning_frontend=self.webpackChunkprovisioning_frontend||[]).push([[330],{94673:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>tn});var r=n(87462),a=n(70885),o=n(45987),i=n(45697),c=n.n(i),u=n(3669),s=n(93264),l=n.n(s),p=n(64572),d=n(33806);const f={chosenSource:void 0,chosenNumOfInstances:1,chosenInstanceType:void 0,uploadedKey:!1,chosenRegion:void 0,chosenImageID:void 0,sshPublicName:"",sshPublicKey:"",chosenSshKeyId:void 0,chosenSshKeyName:null,provider:void 0};function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=(0,d.fH)((function(e){return(0,s.useState)(b(b({},f),e))})),y=g.Provider,v=g.useTracked,h=n(88767),O=new h.QueryClient;const E=function(e){var t=e.children;return l().createElement(h.QueryClientProvider,{client:O},t)};var S=function(e){var t=e.isOpen,n=e.onConfirm,r=e.onCancel;return l().createElement(u.Modal,{ouiaId:"app-confirm-modal",id:"app-confirm-modal","aria-label":"confirm cancel of launch modal",variant:u.ModalVariant.small,title:"Exit instance launching?",isOpen:t,onClose:r,actions:[l().createElement(u.Button,{key:"exit",variant:"primary",onClick:n,ouiaId:"btn-exit-confirm"},"Exit"),l().createElement(u.Button,{key:"stay",variant:"link",onClick:r},"Stay")],titleIconVariant:"warning"},"All inputs will be discarded.")};S.propTypes={isOpen:c().bool.isRequired,onConfirm:c().func.isRequired,onCancel:c().func.isRequired};const w=S;var P=n(80159),I=n(20777),j=n(84564),D=n(50470),k=n(58061),_=n(42982),Z=function(e){return["sources",e]},T="pubkeys",x="image_region",C=n(15861),z=n(64687),R=n.n(z),L=n(65564),N=n.n(L),A=function(e){return"/api/provisioning/v1/".concat(e)},q=function(e){return"/api/image-builder/v1/".concat(e)},V=function(e,t){return e===k.kD?A("instance_types/".concat(e,"?region=").concat(t,"&zone=1")):A("instance_types/".concat(e,"?region=").concat(t))},B=function(){var e=(0,C.Z)(R().mark((function e(t){var n,r;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(A("sources?provider=".concat(t)));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=(0,C.Z)(R().mark((function e(t){var n,r;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(A("sources/".concat(t,"/upload_info")));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=(0,C.Z)(R().mark((function e(){var t,n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(A("pubkeys"));case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(){var e=(0,C.Z)(R().mark((function e(t,n){var r,a,o;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=V(n,t),e.next=3,N().get(r);case 3:return a=e.sent,o=a.data,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),H=function(e){return function(){var t=(0,C.Z)(R().mark((function t(n){return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",N().post(A("reservations/".concat(e)),n));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},M=function(){var e=(0,C.Z)(R().mark((function e(t){return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",N().post(A("pubkeys"),t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=(0,C.Z)(R().mark((function e(t){var n,r;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(A("reservations/".concat(t)));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=(0,C.Z)(R().mark((function e(t){var n,r;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(q("composes/".concat(t,"/clones")));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=(0,C.Z)(R().mark((function e(t){var n,r;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(q("clones/".concat(t)));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=(0,C.Z)(R().mark((function e(t,n){var r,a;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(A("reservations/".concat(n,"/").concat(t)));case 2:return r=e.sent,a=r.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),$=function(){var e=(0,C.Z)(R().mark((function e(t,n){var r,a;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(A("/sources/".concat(t,"/launch_templates?region=").concat(n)));case 2:return r=e.sent,a=r.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),X=function(e){switch(e){case k.Zz:return"us-east-1";case k.go:return"us-central1-a";case k.kD:return"eastus";default:throw new Error("Unrecognized provider was entered: ".concat(e))}},Y=function(e){switch(e){case k.Zz:return"Amazon cloud";case k.kD:return"Azure";case k.go:return"Google cloud";default:throw new Error("Unrecognized provider was entered: ".concat(e))}},ee=["id"];function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var re=function(e){var t=e.provider,n=e.currentRegion,r=e.composeID,i=e.onChange,c=l().useState(!1),s=(0,a.Z)(c,2),p=s[0],d=s[1],f=(0,h.useQuery)([x,r],(function(){return W(r)}),{select:function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{id:e.id,region:e.request.region}}))}}),m=f.isError,b=f.isLoading,g=f.data,y=(0,h.useQueries)((null==g?void 0:g.map((function(e){return{queryKey:[x,e.id],queryFn:function(){return U(e.id)}}})))||[]),v=y.some((function(e){return e.isLoading})),O=[{region:t&&X(t),id:r}];if(y.length&&y.every((function(e){return!1===e.isLoading}))){var E=null==y?void 0:y.map((function(e){return null==e?void 0:e.data}));null==E||E.forEach((function(e,t){g[t]=ne(ne({},g[t]),null==e?void 0:e.options)}));var S=null==g?void 0:g.filter((function(e,t){return"success"===E[t].status}));O.push.apply(O,(0,_.Z)(S))}return m?l().createElement(l().Fragment,null,l().createElement(u.Alert,{ouiaId:"regions_alert",variant:"warning",isInline:!0,title:"There are problems fetching image's regions"}),l().createElement(u.Select,{ouiaId:"regions_empty",isDisabled:!0,placeholderText:"No regions have been found"})):b||v?l().createElement(u.Spinner,{isSVG:!0,size:"sm","aria-label":"loading available regions"}):l().createElement(u.Select,{ouiaId:"select_regions",variant:"typeahead","aria-label":"Select region",label:"Select region",maxHeight:"450px",isOpen:p,selections:n,onToggle:function(e){d(e)},onSelect:function(e,t){var n=O.find((function(e){return e.region===t})),r=n.id,a=(0,o.Z)(n,ee);i(ne({region:t,imageID:r},a)),d(!1)},isDisabled:((null==g?void 0:g.length)||0)<=1},O.map((function(e){var t=e.id,n=e.region;return l().createElement(u.SelectOption,{"aria-label":"Region item",key:t,value:n})})))};re.propTypes={provider:c().oneOf([k.Zz,k.kD,k.go]).isRequired,composeID:c().string.isRequired,onChange:c().func.isRequired,currentRegion:c().string};const ae=re;function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=c().shape({name:c().string,id:c().string,provider:c().string,architecture:c().string,sourceIDs:c().arrayOf(c().string),accountIDs:c().arrayOf(c().string)}).isRequired,ue=function(e,t){var n=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).refetch,n=void 0!==t&&t,r=(0,h.useQuery)(Z(e.provider),(function(){return B(e.provider)}),{enabled:!!e.provider,refetchInterval:n&&1e4}),a=r.error,o=r.isLoading,i=r.data;return{error:a,isLoading:o,sources:i}}(e,{refetch:t.refetch}),r=n.sources,a=n.isLoading,o=n.error,i=(0,h.useQueries)((null==r?void 0:r.map((function(e){return{queryKey:(t=e.id,["source_upload_info",t]),queryFn:function(){return F(e.id)},retry:1};var t})))||[]),c=a||i.every((function(e){return e.isLoading})),u=[];return null==r||r.forEach((function(e,t){i[t].isSuccess&&u.push(ie(ie({},i[t].data),{},{source_id:e.id}))})),{isLoading:c,error:o,infos:u}},se=function(e){switch(e.provider){case k.Zz:return function(t){var n,r;return(null===(n=e.sourceIDs)||void 0===n?void 0:n.includes(t.source_id))||(null===(r=e.accountIDs)||void 0===r?void 0:r.includes(t.aws.account_id))};case k.kD:return function(t){var n,r,a;return(null===(n=e.uploadOptions)||void 0===n?void 0:n.source_id)===t.source_id||(null===(r=t.azure)||void 0===r?void 0:r.subscription_id)===(null===(a=e.uploadOptions)||void 0===a?void 0:a.subscription_id)};default:return function(t){var n;return null===(n=e.sourceIDs)||void 0===n?void 0:n.includes(t.source_id)}}};function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var pe=function(e){var t,n,r=e.image,o=r.uploadStatus||{options:{}},i=r.uploadOptions||{},c=l().useState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({imageID:r.id},o.options)),s=(0,a.Z)(c,2),d=s[0],f=s[1];switch(r.provider){case k.Zz:n="Launch with AWS console",t="https://console.aws.amazon.com/ec2/v2/home?region="+d.region+"#LaunchInstanceWizard:ami="+d.ami;break;case k.kD:n="View uploaded image",t="https://portal.azure.com/#@"+i.tenant_id+"/resource/subscriptions/"+i.subscription_id+"/resourceGroups/"+i.resource_group+"/providers/Microsoft.Compute/images/"+o.options.image_name;break;default:throw new Error("Steps requested for unknown provider: ".concat(r.provider))}return l().createElement(u.Stack,null,l().createElement(u.StackItem,null,l().createElement(u.Button,{component:"a",variant:"link",icon:l().createElement(D.ZP,null),iconPosition:"right",target:"_blank",href:t},n)),r.provider===k.Zz&&l().createElement(u.StackItem,null,l().createElement(u.Bullseye,null,l().createElement(ae,{composeID:r.id,provider:r.provider,currentRegion:d.region,onChange:function(e){console.log(e),f(e)}}))))};pe.propTypes={image:ce};const de=pe;var fe=["isLoading"],me=function(){return l().createElement(u.EmptyState,null,l().createElement(u.EmptyStateIcon,{variant:"container",component:u.Spinner}),l().createElement(u.Title,{size:"lg",headingLevel:"h4"},"Loading available Sources"))},be=function(e){var t=e.error,n=e.image;return l().createElement(u.EmptyState,null,l().createElement(u.EmptyStateIcon,{icon:t?j.ZP:I.ZP}),l().createElement(u.Title,{headingLevel:"h4",size:"lg"},t?"Failed to fetch available sources.":"No sources available"),l().createElement(u.EmptyStateBody,null,t||"There are no sources available for use with this image. Create a source, grant an existing source launch functionality, or launch directly from the cloud provider console."),l().createElement(u.Button,{variant:"primary",component:"a",target:"_blank",href:"/settings/sources/new"},"Create Source"),l().createElement(u.EmptyStateSecondaryActions,null,l().createElement(de,{image:n})))};be.propTypes={error:c().string,image:ce};var ge=function(e){var t=e.isLoading,n=(0,o.Z)(e,fe);return t?l().createElement(me,null):l().createElement(be,n)};ge.propTypes={error:c().string,isLoading:c().bool,image:ce};const ye=ge;var ve=n(84213),he=n(57223);function Oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Se=function(e){var t=e.setValidation,n=e.imageSourceID,r=v(),o=(0,a.Z)(r,2),i=o[0],c=i.provider,s=i.chosenSource,p=o[1],d=l().useState(!1),f=(0,a.Z)(d,2),m=f[0],b=f[1],g=l().useState(null),y=(0,a.Z)(g,2),O=y[0],E=y[1],S=function(e,t){return{id:e,toString:function(){return t},compareTo:function(t){return t.id===e}}},w=(0,h.useQuery)(Z(c),(function(){return B(c)}),{enabled:!!c,onSuccess:function(e){var r=s;if(k.zc.includes(c)&&n)E(S(n,e.find((function(e){return e.id===n})).name)),p((function(e){return Ee(Ee({},e),{},{chosenSource:n})})),t("success");else{if(!r)return;E(S(r,e.find((function(e){return e.id===r})).name))}}}),P=w.error,I=w.isLoading,j=w.data;return P?(console.warn("Failed to fetch sources list"),l().createElement(l().Fragment,null,l().createElement(u.Alert,{ouiaId:"select_account_alert",variant:"warning",isInline:!0,title:"There are problems fetching accounts"}),l().createElement(u.Select,{ouiaId:"select_account_empty",isDisabled:!0,placeholderText:"No accounts found","aria-label":"Select account"}))):I?l().createElement(u.Spinner,{isSVG:!0,size:"sm","aria-label":"Loading accounts"}):l().createElement(u.Select,{ouiaId:"select_account",isOpen:m,onToggle:function(e){return b(e)},selections:O,isDisabled:!!n,onSelect:function(e,n,r){r?(E(null),p((function(e){return Ee(Ee({},e),{},{chosenSource:null})})),t("error")):(E(n),p((function(e){return Ee(Ee({},e),{},{chosenSource:n.id})})),t("success")),b(!1)},placeholderText:"Select account","aria-label":"Select account"},j&&j.map((function(e){var t=e.name,n=e.id;return l().createElement(u.SelectOption,{"aria-label":"Source account",key:n,value:S(n,t)})})))};Se.propTypes={setValidation:c().func.isRequired,imageSourceID:c().string};const we=Se;function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const je=function(){var e=v(),t=(0,a.Z)(e,2),n=t[0].chosenNumOfInstances,r=t[1];return l().createElement(u.NumberInput,{max:45,min:1,value:n,onMinus:function(){var e=n-1;r((function(t){return Ie(Ie({},t),{},{chosenNumOfInstances:e})}))},onChange:function(e){var t=Math.floor(Number(e.target.value));t>45&&(t=45),t<1&&(t=1),r((function(e){return Ie(Ie({},e),{},{chosenNumOfInstances:t})}))},onPlus:function(){var e=n+1;r((function(t){return Ie(Ie({},t),{},{chosenNumOfInstances:e})}))},inputName:"instances",inputAriaLabel:"number of instances",minusBtnAriaLabel:"instances-minus",plusBtnAriaLabel:"instances-plus"})};function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _e=function(e){var t=e.setValidation,n=e.architecture,o=v(),i=(0,a.Z)(o,2),c=i[0],s=c.chosenInstanceType,p=c.chosenRegion,d=c.chosenSource,f=c.provider,m=i[1],b=l().useState(!1),g=(0,a.Z)(b,2),y=g[0],O=g[1],E=l().useState(5),S=(0,a.Z)(E,2),w=S[0],P=S[1],I=l().useState(null),j=(0,a.Z)(I,2),D=j[0],k=j[1],_=l().useState(""),Z=(0,a.Z)(_,2),T=Z[0],x=Z[1],C=l().useState(!0),z=(0,a.Z)(C,2),R=z[0],L=z[1],N=(0,h.useQuery)(["instanceTypes",p],(function(){return K(p,f)}),{select:function(e){return e.filter((function(e){return e.architecture===n}))},enabled:!!p&&!!d}),A=N.isLoading,q=N.error,V=N.data;if(!d||""===d)return l().createElement(l().Fragment,null,l().createElement(u.TextInput,{ouiaId:"instance_type_readonly",className:"pf-c-form-control",readOnly:!0,type:"text",value:"Select account to load instances",id:"input-readonly","aria-label":"Select instance type - disabled"}));if(q)return console.warn("Failed to fetch instance types list"),l().createElement(l().Fragment,null,l().createElement(u.Alert,{ouiaId:"instance_type_alert",variant:"warning",isInline:!0,title:"There are problems fetching instance types"}),l().createElement(u.Select,{ouiaId:"instance_type_empty",isDisabled:!0,placeholderText:"No instance types found",toggleAriaLabel:"Select instance type"}));if(A)return l().createElement(u.Spinner,{isSVG:!0,size:"sm","aria-label":"Contents of the small example"});var B=D||V;return l().createElement(l().Fragment,null,!R&&l().createElement(u.Alert,{"data-testid":"unsupported_type_alert",ouiaId:"instance_type_not_supported_alert",variant:"warning",isInline:!0,title:"Warning: The selected specification does not meet minimum requirements for this image."}),l().createElement(u.Select,(0,r.Z)({ouiaId:"select_instance_type",variant:"typeahead",typeAheadAriaLabel:"Selected instance type",toggleAriaLabel:"Select instance type",placeholderText:"Select instance type",maxHeight:"450px",isOpen:y,selections:s,onToggle:function(e){O(e)},onSelect:function(e,n,r){if(r)t("error"),L(!0),m((function(e){return ke(ke({},e),{},{chosenInstanceType:null})})),O(!1);else{var a=V.find((function(e){return n===e.name}));L(a.supported),m((function(e){return ke(ke({},e),{},{chosenInstanceType:n})})),t("success"),O(!1)}},onFilter:function(e,t){var n=t.replace(/\\+$/,"");T!==n&&(P(5),x(n),k(V.filter((function(e){return e.name.includes(n)}))))}},w<(null==B?void 0:B.length)&&{loadingVariant:{text:"View more (".concat(B.length-w,")"),onClick:function(){return P(w+5)}}}),function(e,t){var n,r;return t<(null===(n=e)||void 0===n?void 0:n.length)&&(e=e.slice(0,t)),null===(r=e)||void 0===r?void 0:r.map((function(e,t){return l().createElement(u.SelectOption,{"aria-label":"Instance Type ".concat(e.name),key:t,description:"".concat(e.cores||"only vCPU"," cores |\n          ").concat(e.vcpus," vCPU |\n          ").concat((parseFloat(e.memory_mib)/1024).toFixed(1)," GiB memory |\n          ").concat(e.storage_gb>0?e.storage_gb+" GB storage | ":"EBS only | ","\n          ").concat(e.architecture),value:e.name})}))}(B,w)))};_e.propTypes={setValidation:c().func.isRequired,architecture:c().string.isRequired};const Ze=_e;function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Ce=function(){var e,t=v(),n=(0,a.Z)(t,2),r=n[0],o=r.chosenSource,i=r.chosenRegion,c=r.chosenTemplate,s=n[1],p=l().useState(!1),d=(0,a.Z)(p,2),f=d[0],m=d[1],b=(0,h.useQuery)(["Templates","".concat(i,"-").concat(o)],(function(){return $(o,i)}),{enabled:!!o&&!!i}),g=b.error,y=b.isLoading,O=b.data,E=c&&(null===(e=O.find((function(e){return e.id===c})))||void 0===e?void 0:e.name);return g?l().createElement(l().Fragment,null,l().createElement(u.Alert,{ouiaId:"select_template_alert",variant:"warning",isInline:!0,title:"There are problems fetching templates"}),l().createElement(u.Select,{ouiaId:"select_template_empty",isDisabled:!0,placeholderText:"No templates found","aria-label":"Select template"})):y?l().createElement(u.Spinner,{isSVG:!0,size:"sm","aria-label":"Loading templates"}):l().createElement(u.Select,{ouiaId:"select_templates",isOpen:f,onToggle:function(e){return m(e)},selections:E,onSelect:function(e,t,n){n||s((function(e){var n;return xe(xe({},e),{},{chosenTemplate:null===(n=O.find((function(e){return e.name===t})))||void 0===n?void 0:n.id})})),m(!1)},placeholderText:"Select templates","aria-label":"Select templates"},O&&O.map((function(e){var t=e.name,n=e.id;return l().createElement(u.SelectOption,{"aria-label":"template option",key:n,value:t})})))};function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Le=function(e){var t=e.setStepValidated,n=e.architecture,r=e.composeID,o=e.imageSourceID,i=v(),c=(0,a.Z)(i,2),s=c[0],p=s.chosenSource,d=s.chosenRegion,f=s.chosenInstanceType,m=c[1],b=l().useState({sources:p?"success":"default",types:f?"success":"default"}),g=(0,a.Z)(b,2),y=g[0],h=g[1],O=(0,he.useFlag)("provisioning.aws.templates");return l().useEffect((function(){var e=Object.values(y).some((function(e){return"success"!==e}));t(!e)}),[y]),l().createElement(u.Form,null,l().createElement(u.Title,{ouiaId:"account_custom_title",headingLevel:"h1",size:"xl"},"Account and customizations | Amazon"),l().createElement(u.Text,{ouiaId:"account_custom_description"},"Configure instances that will run on your AWS. All the instances will launch with the same configuration."),l().createElement(u.FormGroup,{label:"Select account",validated:y.sources,helperTextInvalid:"Please pick a value",isRequired:!0,fieldId:"aws-select-source"},l().createElement(we,{imageSourceID:o,setValidation:function(e){return h((function(t){return Re(Re({},t),{},{sources:e})}))}})),l().createElement(u.FormGroup,{label:"Select region",isRequired:!0,fieldId:"aws-select-region",labelIcon:l().createElement(u.Popover,{bodyContent:"Select available geographical region"},l().createElement(u.Button,{ouiaId:"region_help",type:"button","aria-label":"More info for regions field",onClick:function(e){return e.preventDefault()},"aria-describedby":"aws-select-region",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(ve.ZP,{noVerticalAlign:!0})))},l().createElement(ae,{provider:k.Zz,onChange:function(e){var t=e.region,n=e.imageID;m((function(e){return Re(Re({},e),{},{chosenRegion:t,chosenImageID:n})}))},composeID:r,currentRegion:d})),O&&l().createElement(u.FormGroup,{label:"Select template",fieldId:"aws-select-template",labelIcon:l().createElement(u.Popover,{bodyContent:l().createElement("span",null,"Launch templates contains the configuration information to launch an instance. Note that instance type and public SSH key will be still required and will override template values. For further information and for creating launch templates"," ",l().createElement("a",{rel:"noreferrer",target:"_blank",href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-launch-templates.html"},"click here"))},l().createElement(u.Button,{ouiaId:"template_help",type:"button","aria-label":"template field info",onClick:function(e){return e.preventDefault()},"aria-describedby":"aws-select-template",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(ve.ZP,{noVerticalAlign:!0})))},l().createElement(Ce,null)),l().createElement(u.FormGroup,{label:"Select instance type",isRequired:!0,helperTextInvalid:"Please pick a value",fieldId:"aws-select-instance-types",labelIcon:l().createElement(u.Popover,{bodyContent:"Select AWS instance type based on your computing, memory, networking, or storage needs"},l().createElement(u.Button,{ouiaId:"instance_type_help",type:"button","aria-label":"More info for instance types field",onClick:function(e){return e.preventDefault()},"aria-describedby":"aws-select-instance-types",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(ve.ZP,{noVerticalAlign:!0})))},l().createElement(Ze,{architecture:n,setValidation:function(e){return h((function(t){return Re(Re({},t),{},{types:e})}))}})),l().createElement(u.FormGroup,{label:"Count",isRequired:!0,fieldId:"aws-select-instance-counter",labelIcon:l().createElement(u.Popover,{bodyContent:"Specify the number of AWS instances to be launched"},l().createElement(u.Button,{ouiaId:"instance_count_help",type:"button","aria-label":"More info for instance counter field",onClick:function(e){return e.preventDefault()},"aria-describedby":"aws-select-instance-counter",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(ve.ZP,{noVerticalAlign:!0})))},l().createElement(je,null)))};Le.propTypes={setStepValidated:c().func.isRequired,architecture:c().string.isRequired,composeID:c().string.isRequired,imageSourceID:c().number.isRequired};const Ne=Le;function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ve=function(e){var t=e.setStepValidated,n=e.architecture,r=e.composeID,o=v(),i=(0,a.Z)(o,2),c=i[0],s=i[1],p=l().useState({sources:c.chosenSource?"success":"default",types:c.chosenInstanceType?"success":"default"}),d=(0,a.Z)(p,2),f=d[0],m=d[1];return l().useEffect((function(){var e=Object.values(f).some((function(e){return"success"!==e}));t(!e)}),[f]),l().createElement(u.Form,null,l().createElement(u.Title,{ouiaId:"account_custom_title",headingLevel:"h1",size:"xl"},"Account and customizations | Google cloud"),l().createElement(u.Text,{ouiaId:"account_custom_description"},"Configure instances that will run on your Google cloud. All the instances will launch with the same configuration."),l().createElement(u.FormGroup,{label:"Select account",validated:f.sources,helperTextInvalid:"Please pick a value",isRequired:!0,fieldId:"gcp-select-source"},l().createElement(we,{setValidation:function(e){return m((function(t){return qe(qe({},t),{},{sources:e})}))}})),l().createElement(u.FormGroup,{label:"Select zone",isRequired:!0,fieldId:"gcp-select-zone",labelIcon:l().createElement(u.Popover,{headerContent:l().createElement("div",null,"GCP zones")},l().createElement(u.Button,{ouiaId:"zone_help",type:"button","aria-label":"More info for zones field",onClick:function(e){return e.preventDefault()},"aria-describedby":"gcp-select-zone",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(ve.ZP,{noVerticalAlign:!0})))},l().createElement(ae,{provider:k.go,onChange:function(e){var t=e.region,n=e.imageID;s((function(e){return qe(qe({},e),{},{chosenRegion:t,chosenImageID:n})}))},composeID:r,currentRegion:c.chosenRegion})),l().createElement(u.FormGroup,{label:"Select machine type",isRequired:!0,helperTextInvalid:"Please pick a value",fieldId:"gcp-select-machine-types",labelIcon:l().createElement(u.Popover,{headerContent:l().createElement("div",null,"GCP machine types")},l().createElement(u.Button,{ouiaId:"machine_type_help",type:"button","aria-label":"More info for machine types field",onClick:function(e){return e.preventDefault()},"aria-describedby":"gcp-select-machine-types",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(ve.ZP,{noVerticalAlign:!0})))},l().createElement(Ze,{architecture:n,setValidation:function(e){return m((function(t){return qe(qe({},t),{},{types:e})}))}})),l().createElement(u.FormGroup,{label:"Count",isRequired:!0,fieldId:"gcp-select-instance-counter",labelIcon:l().createElement(u.Popover,{headerContent:l().createElement("div",null,"Number of GCP instances")},l().createElement(u.Button,{ouiaId:"instance_count_help",type:"button","aria-label":"More info for instance counter field",onClick:function(e){return e.preventDefault()},"aria-describedby":"gcp-select-instance-counter",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(ve.ZP,{noVerticalAlign:!0})))},l().createElement(je,null)))};Ve.propTypes={architecture:c().string.isRequired,composeID:c().string.isRequired,setStepValidated:c().func.isRequired};const Be=Ve;function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ke=function(e){var t=e.setStepValidated,n=e.architecture,r=e.composeID,o=v(),i=(0,a.Z)(o,2),c=i[0],s=i[1],p=l().useState({sources:c.chosenSource?"success":"default",types:c.chosenInstanceType?"success":"default"}),d=(0,a.Z)(p,2),f=d[0],m=d[1];return l().useEffect((function(){var e=Object.values(f).some((function(e){return"success"!==e}));t(!e)}),[f]),l().createElement(u.Form,null,l().createElement(u.Title,{ouiaId:"account_custom_title",headingLevel:"h1",size:"xl"},"Account and customizations | Azure"),l().createElement(u.Text,{ouiaId:"account_custom_description"},"Configure instances that will run on your Azure cloud. All the instances will launch with the same configuration."),l().createElement(u.FormGroup,{label:"Select account",validated:f.sources,helperTextInvalid:"Please pick a value",isRequired:!0,fieldId:"azure-select-source"},l().createElement(we,{setValidation:function(e){return m((function(t){return Ge(Ge({},t),{},{sources:e})}))}})),l().createElement(u.FormGroup,{label:"Select location",isRequired:!0,fieldId:"azure-select-location",labelIcon:l().createElement(u.Popover,{headerContent:l().createElement("div",null,"Azure locations")},l().createElement(u.Button,{ouiaId:"location_help",type:"button","aria-label":"More info for location field",onClick:function(e){return e.preventDefault()},"aria-describedby":"azure-select-location",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(ve.ZP,{noVerticalAlign:!0})))},l().createElement(ae,{provider:k.kD,currentRegion:c.chosenRegion,onChange:function(e){var t=e.region,n=e.imageID;s((function(e){return Ge(Ge({},e),{},{chosenRegion:t,chosenImageID:n})}))},composeID:r})),l().createElement(u.FormGroup,{label:"Select instance size",isRequired:!0,helperTextInvalid:"Please pick a value",fieldId:"azure-select-instance-size",labelIcon:l().createElement(u.Popover,{headerContent:l().createElement("div",null,"Azure instance sizes")},l().createElement(u.Button,{ouiaId:"machine_type_help",type:"button","aria-label":"More info for instance size field",onClick:function(e){return e.preventDefault()},"aria-describedby":"azure-select-instance-size",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(ve.ZP,{noVerticalAlign:!0})))},l().createElement(Ze,{architecture:n,setValidation:function(e){return m((function(t){return Ge(Ge({},t),{},{types:e})}))}})),l().createElement(u.FormGroup,{label:"Count",isRequired:!0,fieldId:"azure-select-instance-counter",labelIcon:l().createElement(u.Popover,{headerContent:l().createElement("div",null,"Number of Azure instances")},l().createElement(u.Button,{ouiaId:"instance_count_help",type:"button","aria-label":"More info for instance counter field",onClick:function(e){return e.preventDefault()},"aria-describedby":"azure-select-instance-counter",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(ve.ZP,{noVerticalAlign:!0})))},l().createElement(je,null)))};Ke.propTypes={architecture:c().string.isRequired,composeID:c().string.isRequired,setStepValidated:c().func.isRequired};const He=Ke;function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var We=function(e){var t=e.setStepValidated,n=e.architecture,r=e.composeID,o=e.provider,i=e.imageSourceID,c=v(),u=(0,a.Z)(c,2)[1];switch(l().useEffect((function(){o&&u((function(e){return Qe(Qe({},e),{},{provider:o,chosenRegion:X(o),chosenImageID:r})}))}),[o,u]),o){case k.Zz:return l().createElement(Ne,{setStepValidated:t,architecture:n,composeID:r,imageSourceID:i});case k.kD:return l().createElement(He,{setStepValidated:t,architecture:n,composeID:r});case k.go:return l().createElement(Be,{setStepValidated:t,architecture:n,composeID:r});default:throw new Error("Can not render AccountCustomizations for unrecognized provider: ".concat(o))}};We.propTypes={setStepValidated:c().func.isRequired,architecture:c().string.isRequired,composeID:c().string.isRequired,provider:c().oneOf([k.Zz,k.kD,k.go]),imageSourceID:c().string};const Ue=We;var Je=[500,600,700,800,900,1e3,1200,1400,1600,1800,2e3,3e3,4e3,5e3,1e4,15e3,2e4,25e3,3e4,6e4],$e=[{name:"Create reservation",description:"Submit requested data"},{name:"Transfer keys",description:"Uploading public key to AWS"},{name:"Launch instance(s)",description:"Call AWS API for launching instance(s)"},{name:"Instance description",description:"Fetch instance(s) descriptions"}],Xe=[{name:"Create reservation",description:"Submit data of requested instances"},{name:"Ensure resource group",description:"Ensure resource group is present on Azure account"},{name:"Launch instance(s)",description:"Launch defined instance(s) on Azure"}],Ye=[{name:"Create reservation",description:"Submit requested data"},{name:"Launch instance(s)",description:"Call Google API"}],et=[{name:"New SSH key",description:"Creating new SSH public key resource"}],tt=[k.Zz,k.kD],nt=function(e){switch(e){case k.Zz:return $e;case k.kD:return Xe;case k.go:return Ye;default:throw new Error("Steps requested for unknown provider: ".concat(e))}},rt=function(e){switch(e){case k.Zz:return"instance_type";case k.kD:return"instance_size";case k.go:return"machine_type";default:return"instance_type"}},at=function(e){switch(e){case k.Zz:return"region";case k.go:return"zone";default:return"region"}},ot=function(e){var t=e.imageName,n=v(),r=(0,a.Z)(n,1)[0],o=r.chosenRegion,i=r.chosenSshKeyName,c=r.uploadedKey,s=r.chosenInstanceType,p=r.chosenNumOfInstances,d=r.chosenSource,f=r.sshPublicName,m=r.provider,b=(0,h.useQuery)(Z(m),(function(){return B(m)})).data,g=l().useState(!0),y=(0,a.Z)(g,2),O=y[0],E=y[1],S=at(m).charAt(0).toUpperCase()+at(m).slice(1),w=rt(m).replace("_"," "),P=w.charAt(0).toUpperCase()+w.slice(1);return l().createElement(u.ExpandableSection,{toggleText:m,onToggle:function(e){E(e)},isExpanded:O,isIndented:!0},l().createElement(u.DescriptionList,{isHorizontal:!0},l().createElement(u.DescriptionListGroup,null,l().createElement(u.DescriptionListTerm,null,"Image"),l().createElement(u.DescriptionListDescription,null,t)),l().createElement(u.DescriptionListGroup,null,l().createElement(u.DescriptionListTerm,null,"Account"),l().createElement(u.DescriptionListDescription,null,null==b?void 0:b.find((function(e){return e.id===d})).name)),l().createElement(u.DescriptionListGroup,null,l().createElement(u.DescriptionListTerm,null,S),l().createElement(u.DescriptionListDescription,null,o)),l().createElement(u.DescriptionListGroup,null,l().createElement(u.DescriptionListTerm,null,P),l().createElement(u.DescriptionListDescription,null,s)),l().createElement(u.DescriptionListGroup,null,l().createElement(u.DescriptionListTerm,null,"Count"),l().createElement(u.DescriptionListDescription,null,p)),l().createElement(u.DescriptionListGroup,null,l().createElement(u.DescriptionListTerm,null,c?"New SSH key":"Existing SSH key"),l().createElement(u.DescriptionListDescription,null,c?f:i))))};ot.propTypes={imageName:c().string.isRequired};const it=ot;var ct=function(e){var t=e.imageName;return l().createElement("div",{className:"pf-c-form"},l().createElement(u.Title,{ouiaId:"review_details_title",headingLevel:"h1"},"Review details"),l().createElement(u.Text,{ouiaId:"review_details_description"},"Review the information below and then click ",l().createElement("b",null,"Launch")," to finish the process."),l().createElement(it,{imageName:t}))};ct.propTypes={imageName:c().string.isRequired};const ut=ct;function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pt=function(e,t){return{id:e,toString:function(){return t},compareTo:function(t){return t.id==e}}},dt=function(e){var t=e.setStepValidated,n=v(),r=(0,a.Z)(n,2),o=r[0],i=r[1],c=l().useState(!1),s=(0,a.Z)(c,2),p=s[0],d=s[1],f=l().useState(o.chosenSshKeyId?pt(o.chosenSshKeyId,o.chosenSshKeyName):null),m=(0,a.Z)(f,2),b=m[0],g=m[1];l().useEffect((function(){t(!!b)}),[b]);var y=(0,h.useQuery)(T,G),O=y.isLoading,E=y.isError,S=y.data;return O?l().createElement(u.Spinner,{isSVG:!0,size:"sm","aria-label":"Loading saved SSH keys"}):E||S&&S.length<1?l().createElement(l().Fragment,null,E&&l().createElement(u.Alert,{ouiaId:"pubkey_alert",variant:"warning",isInline:!0,title:"There are problems fetching saved SSH keys"}),l().createElement(u.Select,{ouiaId:"pubkey_empty",isDisabled:!0,placeholderText:"No SSH key found","aria-label":"Select public key"})):l().createElement(u.Select,{ouiaId:"select_pubkey",onToggle:function(e){return d(e)},onSelect:function(e,t){i((function(e){return lt(lt({},e),{},{chosenSshKeyId:t.id,chosenSshKeyName:t.toString()})})),g(t),d(!1)},isOpen:p,selections:b,placeholderText:"Select public key...","aria-label":"Select public key"},S.map((function(e){var t=e.id,n=e.name;return l().createElement(u.SelectOption,{"aria-label":"Public key ".concat(n),key:t,value:pt(t,n)})})))};dt.propTypes={setStepValidated:c().func.isRequired};const ft=dt;function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var gt=function(e){return new RegExp("^(ssh|ecdsa)").test(e)},yt=function(e){var t=e.setStepValidated,n=v(),r=(0,a.Z)(n,2),o=r[0],i=o.sshPublicName,c=o.sshPublicKey,s=r[1],d=l().useState(),f=(0,a.Z)(d,2),m=f[0],b=f[1],g=l().useState({sshKeyBody:gt(c)?"success":"default",sshKeyName:i?"success":"default"}),y=(0,a.Z)(g,2),h=y[0],O=y[1],E=l().useState(i),S=(0,a.Z)(E,2),w=S[0],P=S[1],I=l().useState(c),j=(0,a.Z)(I,2),D=j[0],k=j[1];l().useEffect((function(){var e=Object.values(h).some((function(e){return"success"!==e}));t(!e)}),[h]);var _=function(e,t){return O((function(n){return bt(bt({},n),{},(0,p.Z)({},e,t))}))};return l().createElement(u.FormGroup,{isStack:!0},l().createElement(u.FormGroup,{validated:h.sshKeyName,helperTextInvalid:"Name is required",label:"Name",isRequired:!0,fieldId:"ssh-name"},l().createElement(u.TextInput,{ouiaId:"new_pubkey_name",validated:h.sshKeyName,value:w,id:"public-key-name",onChange:function(e){s((function(t){return bt(bt({},t),{},{sshPublicName:e})})),P(e)},onBlur:function(){0!==w.length?_("sshKeyName","success"):_("sshKeyName","error")},type:"text"})),l().createElement(u.FormGroup,{helperTextInvalid:"Must be SSH public key format",label:"SSH public key",isRequired:!0,fieldId:"ssh-file",validated:h.sshKeyBody},l().createElement(u.FileUpload,{ouiaId:"new_pubkey_file",id:"public-key-value",onDataChange:function(e){gt(e)?(s((function(t){return bt(bt({},t),{},{sshPublicKey:e})})),k(e),_("sshKeyBody","success")):_("sshKeyBody","error")},allowEditingUploadedText:!0,onTextChange:function(e){s((function(t){return bt(bt({},t),{},{sshPublicKey:e})})),k(e)},onTextAreaBlur:function(){_("sshKeyBody",""===D?"default":gt(D)?"success":"error")},type:"text",value:D,validated:h.sshKeyBody,onReadStarted:function(){b(!0)},onReadFinished:function(){b(!1)},onReadFailed:function(){s((function(e){return bt(bt({},e),{},{sshPublicName:"<Failed to load the file>"})})),_("sshKeyBody","error")},onClearClick:function(){s((function(e){return bt(bt({},e),{},{sshPublicName:void 0,sshPublicKey:void 0})})),k(""),_("sshKeyBody","default")},isLoading:m,filenamePlaceholder:"Drag a file here"})))};yt.propTypes={setStepValidated:c().func.isRequired};const vt=yt;function ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Et="newKey",St=function(e){var t=e.setStepValidated,n=v(),r=(0,a.Z)(n,2),o=r[0],i=r[1],c=(0,h.useQuery)(T,G),s=c.isError,p=c.data,d=l().useState(!1),f=(0,a.Z)(d,2),m=f[0],b=f[1],g=function(e){i((function(t){return Ot(Ot({},t),{},{uploadedKey:Et===e})}))},y=function(e,t){g(t.currentTarget.value)};return l().useEffect((function(){(s||(null==p?void 0:p.length)<1)&&(b(!0),g(Et))}),[s,p]),l().createElement(u.Form,{className:"pubkeys"},l().createElement(u.Title,{ouiaId:"pubkey_title",headingLevel:"h1"},"SSH keys authentication"),l().createElement(u.Text,{ouiaId:"pubkey_description"},"Establish secure, reliable communication and strong encryption to protect data."),l().createElement(u.FormGroup,{role:"radiogroup",isStack:!0,isRequired:!0,label:"Select a method to add SSH pubic key"},l().createElement(u.Radio,{id:"existing-pubkey-radio",ouiaId:"pubkey_radio",isChecked:!o.uploadedKey,isDisabled:m,name:"ssh-keys-radio",value:"existKey",onChange:y,label:"Select existing SSH public key","data-testid":"existing-pubkey-radio",body:(!o.uploadedKey||m)&&l().createElement(u.FormGroup,{label:"Select public key"},l().createElement(ft,{setStepValidated:t}))}),l().createElement(u.Radio,{id:"upload-pubkey-radio",ouiaId:"new_pubkey_radio",isChecked:o.uploadedKey,name:"ssh-keys-radio",value:Et,onChange:y,label:"Add and save a new SSH public key",description:"Newly added key will be automatically saved. Result of the provisioning will not be affected this process.","data-testid":"upload-pubkey-radio",body:o.uploadedKey&&l().createElement(vt,{setStepValidated:t})})))};St.propTypes={setStepValidated:c().func.isRequired};const wt=St;var Pt=n(16948),It=n(41942),jt=n(35451);function Dt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return kt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _t=R().mark((function e(t){var n,r,a;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Dt(t),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return a=r.value,e.next=7,a;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])}));var Zt=n(51249),Tt=n(58240),xt=n(76771),Ct=n(97365),zt=n(3134),Rt=n(24793),Lt=function(e,t,n){switch(t){case k.Zz:return"https://console.aws.amazon.com/ec2/home?region=".concat(n,"#InstanceDetails:instanceId=").concat(e);case k.kD:return"https://portal.azure.com/#@rhdevcloudops.onmicrosoft.com/resource".concat(e,"/overview");default:return null}};function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function At(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qt=[{title:"5",value:5},{title:"10",value:10},{title:"20",value:20},{title:"50",value:50}],Vt=function(e){var t=e.reservationID,n=e.provider,r=e.region,o=l().useState({perPage:5,page:1,startIdx:0,endIdx:5}),i=(0,a.Z)(o,2),c=i[0],s=i[1],p=(0,h.useQuery)(["launchInfo",t],(function(){return J(t,n)}),{select:function(e){return null==e?void 0:e.instances}}).data,d=null==p?void 0:p.slice(c.startIdx,c.endIdx);return l().createElement(u.Card,{style:{position:"relative",marginLeft:"-20%",marginRight:"-20%"}},l().createElement(u.Pagination,{itemCount:(null==p?void 0:p.length)||0,page:c.page,onSetPage:function(e,t,n,r,a){s({perPage:n,page:t,startIdx:r,endIdx:a})},perPage:c.perPage,onPerPageSelect:function(e,t,n,r,a){s((function(e){return At(At({},e),{},{perPage:t,page:n,startIdx:r,endIdx:a})}))},perPageOptions:qt,isCompact:!0,ouiaId:"instances-pagination"}),l().createElement(Zt.X,{ouiaId:"instances table","aria-label":"instances description table",variant:"compact"},l().createElement(Tt.h,null,l().createElement(xt.Tr,null,l().createElement(Ct.Th,null,"ID"),l().createElement(Ct.Th,null,"DNS"),l().createElement(Ct.Th,null,"SSH command"))),l().createElement(zt.p,null,null==d?void 0:d.map((function(e){var t=e.instance_id,a=e.detail;return l().createElement(xt.Tr,{key:t},l().createElement(Rt.Td,{"aria-label":"instance id",dataLabel:"ID"},l().createElement(u.Button,{variant:"link",icon:l().createElement(D.ZP,null),iconPosition:"right",isInline:!0,component:"a",rel:"noreferrer",target:"_blank",href:Lt(t,n,r)},function(e,t){return t===k.kD?e.split("/").slice(-1):e}(t,n))),l().createElement(Rt.Td,{"aria-label":"instance dns",dataLabel:"DNS"},null!=a&&a.public_dns?l().createElement(u.ClipboardCopy,{isReadOnly:!0,hoverTip:"Copy DNS",clickTip:"DNS was copied!",variant:"expansion"},null==a?void 0:a.public_dns):"N/A"),l().createElement(Rt.Td,{"aria-label":"ssh command",dataLabel:"SSH"},null!=a&&a.public_ipv4?l().createElement(u.ClipboardCopy,{isReadOnly:!0,hoverTip:"Copy SSH command",clickTip:"SSH was copied!",variant:"expansion"},"ssh ".concat(function(e){switch(e){case k.Zz:return"ec2-user";case k.kD:return"azureuser"}}(n),"@").concat(null==a?void 0:a.public_ipv4)):"N/A"))})))))};Vt.propTypes={provider:c().string.isRequired,region:c().string.isRequired,reservationID:c().number.isRequired};const Bt=Vt;function Ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Kt=function(e){var t=e.setLaunchSuccess,n=l().useState([]),r=(0,a.Z)(n,2),o=r[0],i=r[1],c=l().useState(),s=(0,a.Z)(c,2),d=s[0],f=s[1],m=l().useState(),b=(0,a.Z)(m,2),g=b[0],y=b[1],O=l().useState(0),E=(0,a.Z)(O,2),S=E[0],w=E[1],P=l().useState(0),I=(0,a.Z)(P,2),j=I[0],D=I[1],k=l().useState(),_=(0,a.Z)(k,2),Z=_[0],T=_[1],x=v(),C=(0,a.Z)(x,1)[0],z=C.chosenSource,R=C.chosenInstanceType,L=C.chosenNumOfInstances,N=C.chosenRegion,A=C.sshPublicName,q=C.sshPublicKey,V=C.chosenSshKeyId,B=C.uploadedKey,F=C.chosenImageID,G=C.provider,K=C.chosenTemplate,W=function(e){var t=l().useRef(null),n=l().useRef(e),r=l().useState(),o=(0,a.Z)(r,2),i=o[0],c=o[1];return l().useEffect((function(){t.current=_t(n.current)}),[]),{nextInterval:function(){var e=t.current.next().value;return c(void 0!==e&&e),void 0!==e&&e},currentInterval:i}}(Je),U=W.nextInterval,J=W.currentInterval,$=(0,h.useMutation)(H(G),{onSuccess:function(e){var t;ie(),T(null==e||null===(t=e.data)||void 0===t?void 0:t.reservation_id)}}),X=$.mutate,ee=$.error,te=function(){var e;return Gt((e={source_id:z},(0,p.Z)(e,rt(G),R),(0,p.Z)(e,"amount",L),(0,p.Z)(e,"image_id",F),(0,p.Z)(e,at(G),N),(0,p.Z)(e,"pubkey_id",V),e),K&&{launch_template_id:K})};l().useEffect((function(){H&&(B?(i(et.concat(nt(G))),re({name:A,body:q})):(i(nt(G)),X(te())))}),[H,i,B]);var ne=(0,h.useMutation)(M,{onSuccess:function(e){var t;ie(),X(Gt(Gt({},te()),{},{pubkey_id:null==e||null===(t=e.data)||void 0===t?void 0:t.id}))}}),re=ne.mutate,ae=ne.error,oe=(0,h.useQuery)(["reservation",Z],(function(){return Q(Z)}),{enabled:!!Z&&S<o.length&&!d,refetchInterval:function(e){return!(null!=e&&e.success||null!=e&&e.error)&&J},onSuccess:function(e){j<e.step&&!e.error&&(D((function(e){return e+1})),ie()),(null==e||!e.success)&&U(),e.success&&t()},refetchIntervalInBackground:!0}).data;l().useEffect((function(){if(!1===J&&y("The launch progress is slower than expected, but we are still on it.\n         It is safe to close this window and check your ".concat(Y(G)," console later")),ee||ae||null!=oe&&oe.error){var e,t,n,r,a=null==ee||null===(e=ee.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.msg,o=null==ae||null===(n=ae.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.msg;f(a||o||(null==oe?void 0:oe.error))}}),[ee,ae,null==oe?void 0:oe.error,J]);var ie=function(){return w((function(e){return e+1}))};return l().createElement(u.WizardContextConsumer,null,(function(e){var t=e.goToStepById,n=e.onClose;return l().createElement(u.EmptyState,{variant:"large"},l().createElement(u.EmptyStateIcon,{color:(null==oe?void 0:oe.success)?"#3E8635":null,icon:null!=oe&&oe.success?jt.ZP:Pt.ZP}),l().createElement(u.Title,{headingLevel:"h4",size:"lg",ouiaId:"launch-status"},null!=oe&&oe.success?"System(s) launched successfully":"Launching system(s)"),Z&&l().createElement(u.Text,{component:"small",ouiaId:"launch-id"},"launch ID: ".concat(Z)),l().createElement(u.EmptyStateBody,null,!(null!=oe&&oe.success)&&l().createElement(u.ProgressStepper,{isCenterAligned:!0},o.map((function(e,t){var n=e.name,r=e.description,a=function(e,t,n,r){return e<t?"success":e===t&&n?"danger":e===t&&r?"warning":e===t?"info":e>t?"pending":void 0}(t,S,d,g);return l().createElement(u.ProgressStep,{variant:a,id:n,key:n,icon:t>S?l().createElement(It.ZP,null):void 0,isCurrent:t===S,description:r,titleId:n,"aria-label":"step ".concat(n," ").concat(a),popoverRender:(d||g)&&t===S?function(e){return l().createElement(u.Popover,{"aria-label":"".concat(n," error message"),headerContent:d?"Error":"Warning",bodyContent:d||g,reference:e,position:"right"})}:void 0},n)})))),(null==oe?void 0:oe.success)&&tt.includes(G)&&l().createElement(Bt,{provider:G,region:N,reservationID:Z}),d&&l().createElement(u.Button,{id:"wizard-provisioning-failed-edit-button",onClick:function(){return t(1)},variant:"primary"},"Edit"),l().createElement(u.EmptyStateSecondaryActions,null,l().createElement(u.Button,{variant:"link",isDisabled:!d&&S<2,onClick:n},"Close")))}))};Kt.propTypes={setLaunchSuccess:c().func.isRequired};const Ht=Kt;function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Wt={1:"account",4:"sshkey",5:"review"},Ut=function(e){return Wt[e]};const Jt=function(){return s.createElement(u.WizardFooter,null,s.createElement(u.WizardContextConsumer,null,(function(e){var t=e.activeStep,n=e.onNext,r=e.onBack,a=e.onClose,o=void 0===t.enableNext||t.enableNext;return s.createElement(s.Fragment,null,s.createElement(u.Button,{id:"wizard-provisioning-".concat(Ut(t.id),"-next-button"),variant:u.ButtonVariant.primary,type:"submit",onClick:n,isDisabled:!o},t.nextButtonText||"Next"),!t.hideBackButton&&s.createElement(u.Button,{id:"wizard-provisioning-".concat(Ut(t.id),"-back-button"),variant:u.ButtonVariant.secondary,onClick:r,isDisabled:1==t.id},"Back"),!t.hideCancelButton&&s.createElement("div",{className:P.Z.wizardFooterCancel},s.createElement(u.Button,{variant:u.ButtonVariant.link,onClick:a},"Cancel")))})))};var $t=["isOpen","onClose","image"],Xt={sshStep:!1,awsStep:!1},Yt=function(e){e.isOpen;var t=e.onClose,n=e.image,i=(0,o.Z)(e,$t),c=l().useState(1),s=(0,a.Z)(c,2),p=s[0],d=s[1],f=l().useState(Xt),m=(0,a.Z)(f,2),b=m[0],g=m[1],v=l().useState(!1),h=(0,a.Z)(v,2),O=h[0],E=h[1],S=l().useState(),P=(0,a.Z)(S,2),I=P[0],j=P[1],D=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).refetch,n=ue(e,{refetch:void 0!==t&&t}),r=n.isLoading,a=n.error,o=n.infos;if(r||a)return{isLoading:r,error:a,sources:[]};var i=e.isTesting?o:o.filter(se(e));return{isLoading:r,error:a,sources:i}}(n,{refetch:p<=2}),k=D.isLoading,_=D.error,Z=D.sources,T=function(){E(!1),d(1),g(Xt),t()},x=function(e){return!e.isLoading&&e.availableSources.length>0?(i=(o=e).stepIdReached,u=(c=o.image).name,s=c.id,p=c.architecture,d=c.provider,f=c.sourceIDs,m=o.stepValidation,b=o.setStepValidation,g=o.setLaunchSuccess,[{name:"Account and customization",steps:[{name:Y(d),id:1,enableNext:m.awsStep,component:l().createElement(Ue,{provider:d,architecture:p||"x86_64",composeID:s,imageSourceID:null==f?void 0:f[0],setStepValidated:function(e){return b((function(t){return Qt(Qt({},t),{},{awsStep:e})}))}}),canJumpTo:i>=1}]},{name:"SSH key authentication",id:4,component:l().createElement(wt,{setStepValidated:function(e){return b((function(t){return Qt(Qt({},t),{},{sshStep:e})}))}}),canJumpTo:i>=4,enableNext:m.sshStep},{name:"Review details",id:5,component:l().createElement(ut,{imageName:u}),canJumpTo:i>=5,nextButtonText:"Launch"},{name:"Finish Progress",id:6,component:l().createElement(Ht,{setLaunchSuccess:function(){return g(!0)},imageID:s}),isFinishedStep:!0}]):(n=(t=e).image,r=t.isLoading,a=t.sourcesError,[{name:"Define source",id:1,component:l().createElement(ye,{image:n,isLoading:r,error:a}),isFinishedStep:!0}]);var t,n,r,a,o,i,c,u,s,p,d,f,m,b,g}({sourcesError:_,isLoading:k,availableSources:Z,stepIdReached:p,image:n,stepValidation:b,setStepValidation:g,setLaunchSuccess:j});return l().createElement(y,null,l().createElement(u.Wizard,(0,r.Z)({},i,{title:"Launch",description:"Launch image ".concat(n.name),steps:x,isOpen:!0,onClose:function(){p>=5&&!I?E(!0):T()},onNext:function(e,t){var n=e.id,r=e.name,a=t.prevId,o=t.prevName;console.debug("current id: ".concat(n,", current name: ").concat(r,", previous id: ").concat(a,", previous name: ").concat(o)),d((function(e){return e<n?n:e}))},className:"provisioning",footer:l().createElement(Jt,null)})),l().createElement(w,{isOpen:O,onConfirm:T,onCancel:function(){return E(!1)}}))},en=function(e){return l().createElement(E,null,e.isOpen&&l().createElement(Yt,e))};Yt.propTypes={isOpen:c().bool.isRequired,onClose:c().func,image:ce},en.propTypes=Yt.propTypes;const tn=en},58061:(e,t,n)=>{"use strict";n.d(t,{Zz:()=>r,go:()=>o,kD:()=>a,zc:()=>i});var r="aws",a="azure",o="gcp",i=[r]},11452:()=>{},34946:()=>{},32857:()=>{},28992:()=>{},30187:()=>{},21626:()=>{},66822:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},67761:()=>{},49854:()=>{},40209:()=>{},74543:()=>{}}]);