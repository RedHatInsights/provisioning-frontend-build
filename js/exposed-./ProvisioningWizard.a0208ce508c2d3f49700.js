(self.webpackChunkprovisioning=self.webpackChunkprovisioning||[]).push([[852],{1407:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>En});var r=n(7462),a=n(885),o=n(4925),c=n(5697),i=n.n(c),l=n(6911),u=n(3264),s=n.n(u),p=n(6734),d=n(950),m=new p.S({defaultOptions:{queries:{staleTime:5e3}}});const f=function(e){var t=e.children;return s().createElement(d.aH,{client:m},t)};var b=n(4572),v=n(3806);const g={chosenSource:void 0,chosenNumOfInstances:1,chosenInstanceType:void 0,uploadedKey:!1,chosenRegion:void 0,chosenImageID:void 0,sshPublicName:"",sshPublicKey:"",chosenSshKeyId:void 0,chosenSshKeyName:null,provider:void 0};function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=(0,v.fH)((function(e){return(0,u.useState)(h(h({},g),e))})),O=E.Provider,S=E.useTracked,w=n(5435),P=n(1536),j=["pubkeys"],I="image_region",k="templates",D=n(5861),T=n(4687),x=n.n(T),_=n(256),C=n.n(_),Z="aws",L="azure",R="gcp",N=[Z],z=function(e){return"/api/provisioning/v1/".concat(e)},V=function(e){return"/api/image-builder/v1/".concat(e)},A=function(e,t){return z(e===L?"instance_types/".concat(e,"?region=").concat(t,"&zone=1"):"instance_types/".concat(e,"?region=").concat(t))},q=function(){var e=(0,D.Z)(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C().get(z("sources?provider=".concat(t)));case 2:return n=e.sent,r=n.data.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=(0,D.Z)(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C().get(z("sources/".concat(t,"/upload_info")));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=(0,D.Z)(x().mark((function e(){var t,n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C().get(z("pubkeys"));case 2:return t=e.sent,n=t.data.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=(0,D.Z)(x().mark((function e(t,n){var r,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=A(n,t),e.next=3,C().get(r);case 3:return a=e.sent,o=a.data.data,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),K=function(e){return function(){var t=(0,D.Z)(x().mark((function t(n){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",C().post(z("reservations/".concat(e)),n));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},H=function(){var e=(0,D.Z)(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",C().post(z("pubkeys"),t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=(0,D.Z)(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C().get(z("reservations/".concat(t)));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=(0,D.Z)(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C().get(V("composes/".concat(t,"/clones")));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=(0,D.Z)(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C().get(V("clones/".concat(t)));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=(0,D.Z)(x().mark((function e(t,n){var r,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C().get(z("reservations/".concat(n,"/").concat(t)));case 2:return r=e.sent,a=r.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),X=function(){var e=(0,D.Z)(x().mark((function e(t,n){var r,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C().get(z("sources/".concat(t,"/launch_templates?region=").concat(n)));case 2:return r=e.sent,a=r.data.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).refetch,n=void 0!==t&&t,r=(0,w.a)(["sources",e],(function(){return q(e)}),{enabled:!!e,refetchInterval:n&&1e4});return{error:r.error,isLoading:r.isInitialLoading,sources:r.data}},ee=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.refetch,r=void 0!==n&&n,a=t.onSuccess,o=void 0===a?function(){}:a,c=function(e,t){var n=Q(e,{refetch:t.refetch}),r=n.sources,a=n.isLoading,o=n.error,c=(null==r?void 0:r.map((function(e){return{queryKey:["source_upload_info",e.id],queryFn:function(){return F(e.id)},retry:1}})))||[],i=(0,P.h)({queries:c}),l=a||i.some((function(e){return e.isLoading})),u=[];return!a&&(null==r||r.forEach((function(e,t){i[t].isSuccess&&u.push($($({},i[t].data),e))}))),{isLoading:l,error:o,infos:u}}(e.provider,{refetch:r}),i=c.isLoading,l=c.error,u=c.infos,p=e.isTesting?u:null==u?void 0:u.filter(function(e){switch(e.provider){case Z:return function(t){var n,r;return(null===(n=e.sourceIDs)||void 0===n?void 0:n.includes(t.id))||(null===(r=e.accountIDs)||void 0===r?void 0:r.includes(t.aws.account_id))};case L:return function(t){var n,r,a;return(null===(n=e.uploadOptions)||void 0===n?void 0:n.source_id)===t.id||(null===(r=t.azure)||void 0===r?void 0:r.subscription_id)===(null===(a=e.uploadOptions)||void 0===a?void 0:a.subscription_id)};case R:return function(){return!0};default:return function(t){var n;return null===(n=e.sourceIDs)||void 0===n?void 0:n.includes(t.id)}}}(e));return s().useEffect((function(){i||l||o(p)}),[i,l]),{isLoading:i,error:l,sources:p||[]}},te=function(e){var t=e.isOpen,n=e.onConfirm,r=e.onCancel;return s().createElement(l.Modal,{ouiaId:"app-confirm-modal",id:"app-confirm-modal","aria-label":"confirm cancel of launch modal",variant:l.ModalVariant.small,title:"Exit instance launching?",isOpen:t,onClose:r,actions:[s().createElement(l.Button,{key:"exit",variant:"primary",onClick:n,ouiaId:"btn-exit-confirm"},"Exit"),s().createElement(l.Button,{key:"stay",variant:"link",onClick:r},"Stay")],titleIconVariant:"warning"},"All inputs will be discarded.")};te.propTypes={isOpen:i().bool.isRequired,onConfirm:i().func.isRequired,onCancel:i().func.isRequired};const ne=te;var re=n(159),ae=n(777),oe=n(4564),ce=n(5140),ie=n(470),le=n(2982),ue=function(e){switch(e){case Z:return"us-east-1";case R:return"us-central1-a";case L:return"eastus";default:throw new Error("Unrecognized provider was entered: ".concat(e))}},se=function(e){switch(e){case Z:return"Amazon cloud";case L:return"Azure";case R:return"Google cloud";default:throw new Error("Unrecognized provider was entered: ".concat(e))}},pe=["id"];function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var fe=function(e){var t=e.provider,n=e.currentRegion,r=e.composeID,c=e.onChange,i=s().useState(!1),u=(0,a.Z)(i,2),p=u[0],d=u[1],m=(0,w.a)([I,r],(function(){return U(r)}),{select:function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{id:e.id,region:e.request.region}}))}}),f=m.isError,b=m.isLoading,v=m.data,g=(null==v?void 0:v.map((function(e){return{queryKey:[I,e.id],queryFn:function(){return W(e.id)}}})))||[],y=(0,P.h)({queries:g}),h=y.some((function(e){return e.isLoading})),E=[{region:t&&ue(t),id:r}];if(y.length&&y.every((function(e){return!1===e.isLoading}))){var O=null==y?void 0:y.map((function(e){return null==e?void 0:e.data}));null==O||O.forEach((function(e,t){v[t]=me(me({},v[t]),null==e?void 0:e.options)}));var S=null==v?void 0:v.filter((function(e,t){return"success"===O[t].status}));E.push.apply(E,(0,le.Z)(S))}return f?s().createElement(s().Fragment,null,s().createElement(l.Alert,{ouiaId:"regions_alert",variant:"warning",isInline:!0,title:"There are problems fetching image's regions"}),s().createElement(l.Select,{ouiaId:"regions_empty",isDisabled:!0,placeholderText:"No regions have been found"})):b||h?s().createElement(l.Spinner,{isSVG:!0,size:"sm","aria-label":"loading available regions"}):s().createElement(l.Select,{ouiaId:"select_regions",variant:"typeahead","aria-label":"Select region",label:"Select region",maxHeight:"180px",isOpen:p,selections:n,onToggle:function(e){d(e)},onSelect:function(e,t){var n=E.find((function(e){return e.region===t})),r=n.id,a=(0,o.Z)(n,pe);c(me({region:t,imageID:r},a)),d(!1)},isDisabled:!N.includes(t)},E.map((function(e){var t=e.id,n=e.region;return s().createElement(l.SelectOption,{"aria-label":"Region item",key:t,value:n})})))};fe.propTypes={provider:i().oneOf([Z,L,R]).isRequired,composeID:i().string.isRequired,onChange:i().func.isRequired,currentRegion:i().string};const be=fe;var ve=i().shape({name:i().string,id:i().string,provider:i().oneOf([Z,L,R]),architecture:i().string,sourceIDs:i().arrayOf(i().string),accountIDs:i().arrayOf(i().string)}).isRequired,ge=function(e){var t,n=e.image;return s().createElement(s().Fragment,null,s().createElement("br",null),s().createElement("p",null,"or"),s().createElement("br",null),s().createElement(l.StackItem,null,s().createElement("strong",null," Launch with Google Cloud Console ")),s().createElement(l.StackItem,{isFilled:!0},s().createElement(l.ClipboardCopy,{className:"custom-clipboard-copy",hoverTip:"Copy",clickTip:"Copied",ouiaId:"gcp-launch-instance",variant:"expansion",isReadOnly:!0},(t=n.uploadStatus.options,"gcloud compute instances create ".concat(t.image_name,"-instance --image-project ").concat(t.project_id," --image ").concat(t.image_name)))))};ge.propTypes={image:ve};const ye=ge;function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Ee=function(e){var t,n,r=e.image,o=r.uploadStatus||{options:{}},c=r.uploadOptions||{},i=s().useState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({imageID:r.id},o.options)),u=(0,a.Z)(i,2),p=u[0],d=u[1];switch(r.provider){case Z:n="Launch with AWS console",t="https://console.aws.amazon.com/ec2/v2/home?region="+p.region+"#LaunchInstanceWizard:ami="+p.ami;break;case L:n="View uploaded image",t="https://portal.azure.com/#@"+c.tenant_id+"/resource/subscriptions/"+c.subscription_id+"/resourceGroups/"+c.resource_group+"/providers/Microsoft.Compute/images/"+o.options.image_name;break;case R:break;default:throw new Error("Steps requested for unknown provider: ".concat(r.provider))}return s().createElement(l.Stack,null,r.provider===R?s().createElement(ye,{image:r}):s().createElement(l.StackItem,null,s().createElement(l.Button,{component:"a",variant:"link",icon:s().createElement(ie.ZP,null),iconPosition:"right",target:"_blank",href:t},n)),r.provider===Z&&s().createElement(l.StackItem,null,s().createElement(l.Bullseye,null,s().createElement(be,{composeID:r.id,provider:r.provider,currentRegion:p.region,onChange:function(e){console.log(e),d(e)}}))))};Ee.propTypes={image:ve};const Oe=Ee;var Se=["isLoading"],we=s().createElement(s().Fragment,null,s().createElement("p",null,"There are no sources available for use with this image."),s().createElement("p",null,"Create a source, grant an existing source launch functionality,"),s().createElement("p",null,"or launch directly from the cloud provider console.")),Pe=function(){return s().createElement(l.EmptyState,null,s().createElement(l.EmptyStateIcon,{variant:"container",component:l.Spinner}),s().createElement(l.Title,{size:"lg",headingLevel:"h4"},"Loading available Sources"))},je=function(e){var t=e.error,n=e.image,r=(0,ce.Z)().isBeta;return s().createElement(l.EmptyState,null,s().createElement(l.EmptyStateIcon,{icon:t?oe.ZP:ae.ZP}),s().createElement(l.Title,{headingLevel:"h4",size:"lg"},t?"Failed to fetch available sources.":"No sources available"),s().createElement(l.EmptyStateBody,null,(null==t?void 0:t.message)||we),s().createElement(l.Button,{variant:"primary",component:"a",target:"_blank",href:"".concat(r()?"/preview":"","/settings/sources/new")},"Create Source"),s().createElement(l.EmptyStateSecondaryActions,null,s().createElement(Oe,{image:n})))};je.propTypes={error:i().string,image:ve};var Ie=function(e){var t=e.isLoading,n=(0,o.Z)(e,Se);return t?s().createElement(Pe,null):s().createElement(je,n)};Ie.propTypes={error:i().string,isLoading:i().bool,image:ve};const ke=Ie;var De=n(4046);function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _e=function(e){var t=e.setValidation,n=e.image,r=S(),o=(0,a.Z)(r,2),c=o[0].chosenSource,i=o[1],u=s().useState(!1),p=(0,a.Z)(u,2),d=p[0],m=p[1],f=s().useState(null),b=(0,a.Z)(f,2),v=b[0],g=b[1],y=function(e,t){return{id:e,toString:function(){return t},compareTo:function(t){return t.id===e}}},h=ee(n,{onSuccess:function(e){c?(g(y(c,e.find((function(e){return e.id===c})).name)),t("success")):1===e.length&&(g(y(e[0].id,e[0].name)),i((function(t){return xe(xe({},t),{},{chosenSource:e[0].id})})),t("success"))}}),E=h.isLoading,O=h.error,w=h.sources;return O?(console.warn("Failed to fetch sources list"),s().createElement(s().Fragment,null,s().createElement(l.Alert,{ouiaId:"select_account_alert",variant:"warning",isInline:!0,title:"There are problems fetching accounts"}),s().createElement(l.Select,{ouiaId:"select_account_empty",isDisabled:!0,placeholderText:"No accounts found","aria-label":"Select account"}))):E?s().createElement(l.Spinner,{isSVG:!0,size:"sm","aria-label":"Loading accounts"}):s().createElement(l.Select,{ouiaId:"select_account",isOpen:d,onToggle:function(e){return m(e)},selections:v,maxHeight:"180px",onSelect:function(e,n,r){r?(g(null),i((function(e){return xe(xe({},e),{},{chosenSource:null})})),t("error")):(g(n),i((function(e){return xe(xe({},e),{},{chosenSource:n.id})})),t("success")),m(!1)},placeholderText:"Select account","aria-label":"Select account"},w&&w.map((function(e){var t=e.name,n=e.id;return s().createElement(l.SelectOption,{"aria-label":"Source account",key:n,value:y(n,t)})})))};_e.propTypes={setValidation:i().func.isRequired,image:ve};const Ce=_e;function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Re=function(e){var t,n=e.setValidation,r=S(),o=(0,a.Z)(r,2),c=o[0],i=c.chosenInstanceType,p=c.chosenNumOfInstances,d=c.chosenRegion,m=c.chosenSource,f=c.provider,b=o[1],v=(0,w.a)(["instanceTypes",d],(function(){return G(d,f)}),{enabled:!!d&&!!m&&!!i}).data,g=null==v||null===(t=v.find((function(e){return e.name===i})))||void 0===t?void 0:t.vcpus;(0,u.useEffect)((function(){y(p)}),[i]);var y=function(e){n(g*e>32?"warning":"success")},h=g*p>32;return s().createElement(s().Fragment,null,s().createElement(l.NumberInput,{max:45,min:1,value:p,validated:h&&"warning",onMinus:function(){var e=p-1;y(e),b((function(t){return Le(Le({},t),{},{chosenNumOfInstances:e})}))},onChange:function(e){var t=Math.floor(Number(e.target.value));t>45&&(t=45),t<1&&(t=1),y(t),b((function(e){return Le(Le({},e),{},{chosenNumOfInstances:t})}))},onPlus:function(){var e=p+1;y(e),b((function(t){return Le(Le({},t),{},{chosenNumOfInstances:e})}))},inputName:"instances",inputAriaLabel:"number of instances",minusBtnAriaLabel:"instances-minus",plusBtnAriaLabel:"instances-plus"}))};Re.propTypes={setValidation:i().func.isRequired};const Ne=Re;var ze=n(8998),Ve=["<",">","="],Ae=function(e){return e=(e=e.replace("memory","memory_mib")).replace("storage","storage_gb"),Ve.every((function(t){return!e.includes(t)}))&&(e="name ~> /".concat(e,"/i")),"types[".concat(e,"]")},qe=function(){var e=(0,D.Z)(x().mark((function e(t,n){var r,a,o,c;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ae(t),a={types:n},e.prev=2,o=ze(r),e.next=6,o.evaluate(a);case 6:if(c=e.sent){e.next=9;break}return e.abrupt("return",{error:!1,result:[]});case 9:return e.abrupt("return",{error:!1,result:c});case 12:return e.prev=12,e.t0=e.catch(2),e.abrupt("return",{error:!0,result:e.t0});case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t,n){return e.apply(this,arguments)}}(),Fe=n(3493),Be=n.n(Fe);function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He=function(e){var t=e.setValidation,n=e.architecture,o=S(),c=(0,a.Z)(o,2),i=c[0],u=i.chosenInstanceType,p=i.chosenRegion,d=i.chosenSource,m=i.provider,f=c[1],b=s().useState(!1),v=(0,a.Z)(b,2),g=v[0],y=v[1],h=s().useState(3),E=(0,a.Z)(h,2),O=E[0],P=E[1],j=s().useState(null),I=(0,a.Z)(j,2),k=I[0],T=I[1],_=s().useState(!0),C=(0,a.Z)(_,2),Z=C[0],L=C[1],R=s().useState(),N=(0,a.Z)(R,2),z=N[0],V=N[1],A=(0,w.a)(["instanceTypes",p],(function(){return G(p,m)}),{staleTime:3e5,select:function(e){return e.filter((function(e){return e.architecture===n}))},enabled:!!p&&!!d,onError:function(){t("error")}}),q=A.isInitialLoading,F=A.error,B=A.data;if(!d||""===d)return s().createElement(s().Fragment,null,s().createElement(l.TextInput,{ouiaId:"instance_type_readonly",className:"pf-c-form-control",readOnly:!0,type:"text",value:"Select account to load instances",id:"input-readonly","aria-label":"Select instance type - disabled"}));var K=function(){var e=(0,D.Z)(x().mark((function e(t){var n,r,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=7;break}return e.next=3,qe(t,B);case 3:n=e.sent,r=n.error,a=n.result,r?T([]):Array.isArray(a)?T(a):a instanceof Object&&T([a]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if(F)return s().createElement(s().Fragment,null,s().createElement(l.Select,{validated:"error",ouiaId:"instance_type_empty",isDisabled:!0,placeholderText:"No instance types found",toggleAriaLabel:"Select instance type"}));if(q)return s().createElement(l.Spinner,{isSVG:!0,size:"sm","aria-label":"loading instance type select"});var H=k||B;return s().createElement(s().Fragment,null,s().createElement(l.Select,(0,r.Z)({ouiaId:"select_instance_type",variant:"typeahead",id:"instance_type_select",validated:!Z&&"warning",typeAheadAriaLabel:"Selected instance type",toggleAriaLabel:"Select instance type",placeholderText:"Select instance type",maxHeight:"180px",isOpen:g,selections:u||z,onToggle:function(e){y(e)},onSelect:function(e,n,r){if(r)t("error"),L(!0),f((function(e){return Ke(Ke({},e),{},{chosenInstanceType:null})})),y(!1);else{var a=B.find((function(e){return n===e.name}));a?(L(a.supported),f((function(e){return Ke(Ke({},e),{},{chosenInstanceType:n})})),a.supported?t("success"):t("warning")):V(n),y(!1)}},onFilter:function(){},isInputValuePersisted:!0,onTypeaheadInputChanged:function(e){if(""!==e){var t=e.replace(/\\+$/,"");P(3),Be()(K,200)(t)}else T(null)}},O<(null==H?void 0:H.length)&&{loadingVariant:{text:"View more (".concat(H.length-O,")"),onClick:function(){return P(O+3)}}}),function(e,t){var n,r;return t<(null===(n=e)||void 0===n?void 0:n.length)&&(e=e.slice(0,t)),null===(r=e)||void 0===r?void 0:r.map((function(e,t){return s().createElement(l.SelectOption,{"aria-label":"Instance Type ".concat(e.name),key:t,description:"".concat(e.cores||"only vCPU"," cores |\n          ").concat(e.vcpus," vCPU |\n          ").concat((parseFloat(e.memory_mib)/1024).toFixed(1)," GiB memory |\n          ").concat(e.storage_gb>0?e.storage_gb+" GB storage | ":"EBS only | ","\n          ").concat(e.architecture),value:e.name})}))}(H,O)))};He.propTypes={setValidation:i().func.isRequired,architecture:i().string.isRequired};const Me=He;function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function We(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Je=function(){var e,t=S(),n=(0,a.Z)(t,2),r=n[0],o=r.chosenSource,c=r.chosenRegion,i=r.chosenTemplate,u=n[1],p=s().useState(!1),d=(0,a.Z)(p,2),m=d[0],f=d[1],b=(0,w.a)([k,"".concat(c,"-").concat(o)],(function(){return X(o,c)}),{enabled:!!o&&!!c}),v=b.error,g=b.isInitialLoading,y=b.data,h=i&&(null===(e=y.find((function(e){return e.id===i})))||void 0===e?void 0:e.name);return g?s().createElement(l.Spinner,{isSVG:!0,size:"sm","aria-label":"Loading templates"}):s().createElement(s().Fragment,null,s().createElement(l.Select,{ouiaId:"select_templates",isOpen:m,direction:"up",onToggle:function(e){return f(e)},selections:h,onSelect:function(e,t,n){n||u((function(e){var n;return We(We({},e),{},{chosenTemplate:null===(n=y.find((function(e){return e.name===t})))||void 0===n?void 0:n.id})})),f(!1)},maxHeight:"180px",placeholderText:v||0===(null==y?void 0:y.length)?"No template found":"Select templates","aria-label":"Select templates",clearSelectionsAriaLabel:"clear template selection",onClear:function(){u((function(e){return We(We({},e),{},{chosenTemplate:void 0})}))},isDisabled:v||0===(null==y?void 0:y.length),validated:v&&"error"},y&&y.map((function(e){var t=e.name,n=e.id;return s().createElement(l.SelectOption,{"aria-label":"template option",key:n,value:t})}))),v&&s().createElement(l.HelperText,{id:"template-error-inline"},s().createElement(l.HelperTextItem,{variant:"error"},"There are problems fetching templates: ".concat(null==v?void 0:v.message)," ")))};function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $e=function(e){var t=e.setStepValidated,n=e.image,r=S(),o=(0,a.Z)(r,2),c=o[0],i=c.chosenSource,u=c.chosenRegion,p=c.chosenInstanceType,d=o[1],m=s().useState({sources:i?"success":"default",types:p?"success":"default",amount:"success"}),f=(0,a.Z)(m,2),b=f[0],v=f[1];return s().useEffect((function(){var e=Object.values(b).some((function(e){return"error"==e||"default"==e}));t(!e)}),[b]),s().createElement(l.Form,null,s().createElement(l.Title,{ouiaId:"account_custom_title",headingLevel:"h1",size:"xl"},"Account and customizations | Amazon"),s().createElement(l.FormGroup,{label:"Select account",validated:b.sources,helperTextInvalid:"Please pick a value",isRequired:!0,fieldId:"aws-select-source"},s().createElement(Ce,{image:n,setValidation:function(e){return v((function(t){return Ye(Ye({},t),{},{sources:e})}))}})),s().createElement(l.FormGroup,{label:"Select region",isRequired:!0,fieldId:"aws-select-region",labelIcon:s().createElement(l.Popover,{bodyContent:"Select available geographical region"},s().createElement(l.Button,{ouiaId:"region_help",type:"button","aria-label":"More info for regions field",onClick:function(e){return e.preventDefault()},"aria-describedby":"aws-select-region",className:"pf-c-form__group-label-help",variant:"plain"},s().createElement(De.ZP,{noVerticalAlign:!0})))},s().createElement(be,{provider:Z,onChange:function(e){var t=e.region,n=e.imageID;d((function(e){return Ye(Ye({},e),{},{chosenRegion:t,chosenImageID:n})}))},composeID:n.id,currentRegion:u})),s().createElement(l.FormGroup,{label:"Select instance type",isRequired:!0,validated:b.types,helperTextInvalid:"There are problems fetching instance types.",helperText:"warning"===b.types&&"The selected specification does not meet minimum requirements for this image",fieldId:"aws-select-instance-types",labelIcon:s().createElement(l.Popover,{bodyContent:s().createElement("div",null,"Select AWS instance type based on your computing, memory, networking, or storage needs",s().createElement("br",null),s().createElement("br",null),s().createElement("b",null,"Tip:")," You can filter by a query search, i.e:",s().createElement("br",null),s().createElement(l.Text,{component:"small"},"vcpus = 2 and cores < 4 and memory < 4000"))},s().createElement(l.Button,{ouiaId:"instance_type_help",type:"button","aria-label":"More info for instance types field",onClick:function(e){return e.preventDefault()},"aria-describedby":"aws-select-instance-types",className:"pf-c-form__group-label-help",variant:"plain"},s().createElement(De.ZP,{noVerticalAlign:!0})))},s().createElement(Me,{architecture:n.architecture,setValidation:function(e){return v((function(t){return Ye(Ye({},t),{},{types:e})}))}})),s().createElement(l.FormGroup,{label:"Select template (optional)",fieldId:"aws-select-template",labelIcon:s().createElement(l.Popover,{bodyContent:s().createElement("span",null,"Launch templates contains the configuration information to launch an instance. Note that instance type and public SSH key will be still required and will override template values. For further information and for creating launch templates"," ",s().createElement("a",{rel:"noreferrer",target:"_blank",href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-launch-templates.html"},"click here"))},s().createElement(l.Button,{ouiaId:"template_help",type:"button","aria-label":"template field info",onClick:function(e){return e.preventDefault()},"aria-describedby":"aws-select-template",className:"pf-c-form__group-label-help",variant:"plain"},s().createElement(De.ZP,{noVerticalAlign:!0})))},s().createElement(Je,null)),s().createElement(l.FormGroup,{label:"Count",isRequired:!0,fieldId:"aws-select-instance-counter",validated:b.amount,helperText:"warning"===b.amount&&"Launching many vCPUs might exceed service quota limit.",labelIcon:s().createElement(l.Popover,{bodyContent:"Specify the number of AWS instances to be launched"},s().createElement(l.Button,{ouiaId:"instance_count_help",type:"button","aria-label":"More info for instance counter field",onClick:function(e){return e.preventDefault()},"aria-describedby":"aws-select-instance-counter",className:"pf-c-form__group-label-help",variant:"plain"},s().createElement(De.ZP,{noVerticalAlign:!0})))},s().createElement(Ne,{setValidation:function(e){return v((function(t){return Ye(Ye({},t),{},{amount:e})}))}})))};$e.propTypes={setStepValidated:i().func.isRequired,image:ve};const Qe=$e;function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var nt=function(e){var t=e.setStepValidated,n=e.image,r=S(),o=(0,a.Z)(r,2),c=o[0],i=o[1],u=s().useState({sources:c.chosenSource?"success":"default",types:c.chosenInstanceType?"success":"default",amount:"success"}),p=(0,a.Z)(u,2),d=p[0],m=p[1];return s().useEffect((function(){var e=Object.values(d).some((function(e){return"error"==e||"default"==e}));t(!e)}),[d]),s().createElement(l.Form,null,s().createElement(l.Title,{ouiaId:"account_custom_title",headingLevel:"h1",size:"xl"},"Account and customizations | Google cloud"),s().createElement(l.FormGroup,{label:"Select account",validated:d.sources,helperTextInvalid:"Please pick a value",isRequired:!0,fieldId:"gcp-select-source"},s().createElement(Ce,{image:n,setValidation:function(e){return m((function(t){return tt(tt({},t),{},{sources:e})}))}})),s().createElement(l.FormGroup,{label:"Select zone",isRequired:!0,fieldId:"gcp-select-zone",labelIcon:s().createElement(l.Popover,{headerContent:s().createElement("div",null,"GCP zones")},s().createElement(l.Button,{ouiaId:"zone_help",type:"button","aria-label":"More info for zones field",onClick:function(e){return e.preventDefault()},"aria-describedby":"gcp-select-zone",className:"pf-c-form__group-label-help",variant:"plain"},s().createElement(De.ZP,{noVerticalAlign:!0})))},s().createElement(be,{provider:R,onChange:function(e){var t=e.region,n=e.imageID;i((function(e){return tt(tt({},e),{},{chosenRegion:t,chosenImageID:n})}))},composeID:n.id,currentRegion:c.chosenRegion})),s().createElement(l.FormGroup,{label:"Select machine type",isRequired:!0,validated:d.types,helperTextInvalid:"There are problems fetching instance types.",helperText:"warning"===d.types&&"The selected specification does not meet minimum requirements for this image",fieldId:"gcp-select-machine-types",labelIcon:s().createElement(l.Popover,{bodyContent:s().createElement("div",null,"Select GCP instance type based on your computing, memory, networking, or storage needs",s().createElement("br",null),s().createElement("br",null),s().createElement("b",null,"Tip:")," You can filter by a query search, i.e:",s().createElement("br",null),s().createElement(l.Text,{component:"small"},"vcpus = 2 and storage > 30 and memory < 4000"))},s().createElement(l.Button,{ouiaId:"machine_type_help",type:"button","aria-label":"More info for machine types field",onClick:function(e){return e.preventDefault()},"aria-describedby":"gcp-select-machine-types",className:"pf-c-form__group-label-help",variant:"plain"},s().createElement(De.ZP,{noVerticalAlign:!0})))},s().createElement(Me,{architecture:n.architecture,setValidation:function(e){return m((function(t){return tt(tt({},t),{},{types:e})}))}})),s().createElement(l.FormGroup,{label:"Select template (optional)",fieldId:"gcp-select-template",labelIcon:s().createElement(l.Popover,{bodyContent:s().createElement("span",null,"Launch templates contains the configuration information to launch an instance. Note that machine type and public SSH key will be still required and will override template values. For further information and for creating launch templates"," ",s().createElement("a",{rel:"noreferrer",target:"_blank",href:"https://cloud.google.com/compute/docs/instance-templates"},"click here"))},s().createElement(l.Button,{ouiaId:"template_help",type:"button","aria-label":"template field info",onClick:function(e){return e.preventDefault()},"aria-describedby":"gcp-select-template",className:"pf-c-form__group-label-help",variant:"plain"},s().createElement(De.ZP,{noVerticalAlign:!0})))},s().createElement(Je,null)),s().createElement(l.FormGroup,{label:"Count",isRequired:!0,fieldId:"gcp-select-instance-counter",validated:d.amount,helperText:"warning"===d.amount&&"Launching many vCPUs might exceed service quota limit.",labelIcon:s().createElement(l.Popover,{headerContent:s().createElement("div",null,"Number of GCP instances")},s().createElement(l.Button,{ouiaId:"instance_count_help",type:"button","aria-label":"More info for instance counter field",onClick:function(e){return e.preventDefault()},"aria-describedby":"gcp-select-instance-counter",className:"pf-c-form__group-label-help",variant:"plain"},s().createElement(De.ZP,{noVerticalAlign:!0})))},s().createElement(Ne,{setValidation:function(e){return m((function(t){return tt(tt({},t),{},{amount:e})}))}})))};nt.propTypes={setStepValidated:i().func.isRequired,image:ve};const rt=nt;function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ct=function(e){var t=e.setStepValidated,n=e.image,r=S(),o=(0,a.Z)(r,2),c=o[0],i=o[1],u=s().useState({sources:c.chosenSource?"success":"default",types:c.chosenInstanceType?"success":"default",amount:"success"}),p=(0,a.Z)(u,2),d=p[0],m=p[1];return s().useEffect((function(){var e=Object.values(d).some((function(e){return"error"==e||"default"==e}));t(!e)}),[d]),s().createElement(l.Form,null,s().createElement(l.Title,{ouiaId:"account_custom_title",headingLevel:"h1",size:"xl"},"Account and customizations | Azure"),s().createElement(l.FormGroup,{label:"Select account",validated:d.sources,helperTextInvalid:"Please pick a value",isRequired:!0,fieldId:"azure-select-source"},s().createElement(Ce,{image:n,setValidation:function(e){return m((function(t){return ot(ot({},t),{},{sources:e})}))}})),s().createElement(l.FormGroup,{label:"Select location",isRequired:!0,fieldId:"azure-select-location",labelIcon:s().createElement(l.Popover,{headerContent:s().createElement("div",null,"Azure locations")},s().createElement(l.Button,{ouiaId:"location_help",type:"button","aria-label":"More info for location field",onClick:function(e){return e.preventDefault()},"aria-describedby":"azure-select-location",className:"pf-c-form__group-label-help",variant:"plain"},s().createElement(De.ZP,{noVerticalAlign:!0})))},s().createElement(be,{provider:L,currentRegion:c.chosenRegion,onChange:function(e){var t=e.region,n=e.imageID;i((function(e){return ot(ot({},e),{},{chosenRegion:t,chosenImageID:n})}))},composeID:n.id})),s().createElement(l.FormGroup,{label:"Select instance size",isRequired:!0,validated:d.types,helperTextInvalid:"There are problems fetching instance types.",helperText:"warning"===d.types&&"The selected specification does not meet minimum requirements for this image",fieldId:"azure-select-instance-size",labelIcon:s().createElement(l.Popover,{bodyContent:s().createElement("div",null,"Select Azure instance type based on your computing, memory, networking, or storage needs",s().createElement("br",null),s().createElement("br",null),s().createElement("b",null,"Tip:")," You can filter by a query search, i.e:",s().createElement("br",null),s().createElement(l.Text,{component:"small"},"vcpus = 2 and storage > 30 and memory < 4000"))},s().createElement(l.Button,{ouiaId:"machine_type_help",type:"button","aria-label":"More info for instance size field",onClick:function(e){return e.preventDefault()},"aria-describedby":"azure-select-instance-size",className:"pf-c-form__group-label-help",variant:"plain"},s().createElement(De.ZP,{noVerticalAlign:!0})))},s().createElement(Me,{architecture:n.architecture,setValidation:function(e){return m((function(t){return ot(ot({},t),{},{types:e})}))}})),s().createElement(l.FormGroup,{label:"Count",isRequired:!0,fieldId:"azure-select-instance-counter",validated:d.amount,helperText:"warning"===d.amount&&"Launching many vCPUs might exceed service quota limit.",labelIcon:s().createElement(l.Popover,{headerContent:s().createElement("div",null,"Number of Azure instances")},s().createElement(l.Button,{ouiaId:"instance_count_help",type:"button","aria-label":"More info for instance counter field",onClick:function(e){return e.preventDefault()},"aria-describedby":"azure-select-instance-counter",className:"pf-c-form__group-label-help",variant:"plain"},s().createElement(De.ZP,{noVerticalAlign:!0})))},s().createElement(Ne,{setValidation:function(e){return m((function(t){return ot(ot({},t),{},{amount:e})}))}})))};ct.propTypes={setStepValidated:i().func.isRequired,image:ve};const it=ct;function lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var st=function(e){var t=e.setStepValidated,n=e.image,r=S(),o=(0,a.Z)(r,2)[1],c=n.provider;switch(s().useEffect((function(){c&&o((function(e){return ut(ut({},e),{},{provider:c,chosenRegion:ue(c),chosenImageID:n.id})}))}),[c,o]),c){case Z:return s().createElement(Qe,{setStepValidated:t,image:n});case L:return s().createElement(it,{setStepValidated:t,image:n});case R:return s().createElement(rt,{setStepValidated:t,image:n});default:throw new Error("Can not render AccountCustomizations for unrecognized provider: ".concat(c))}};st.propTypes={setStepValidated:i().func.isRequired,image:ve};const pt=st;var dt=[500,600,700,800,900,1e3,1200,1400,1600,1800,2e3,3e3,4e3,5e3,1e4,15e3,2e4,25e3,3e4,6e4,6e4],mt=[{name:"Create reservation",description:"Submit requested data"},{name:"Transfer keys",description:"Uploading public key to AWS"},{name:"Launch instance(s)",description:"Call AWS API for launching instance(s)"},{name:"Instance description",description:"Fetch instance(s) descriptions"}],ft=[{name:"Create reservation",description:"Submit data of requested instances"},{name:"Ensure resource group",description:"Ensure resource group is present on Azure account"},{name:"Launch instance(s)",description:"Launch defined instance(s) on Azure"}],bt=[{name:"Create reservation",description:"Submit requested data"},{name:"Launch instance(s)",description:"Call Google API"},{name:"Fetch instance(s) description",description:"Fetch instance(s) descriptions"}],vt=[{name:"New SSH key",description:"Creating new SSH public key resource"}],gt=[Z,L,R],yt=function(e){switch(e){case Z:return mt;case L:return ft;case R:return bt;default:throw new Error("Steps requested for unknown provider: ".concat(e))}},ht=function(e){switch(e){case Z:return"instance_type";case L:return"instance_size";case R:return"machine_type";default:return"instance_type"}},Et=function(e){switch(e){case Z:return"region";case R:return"zone";default:return"region"}},Ot=function(e){var t,n=e.imageName,r=S(),o=(0,a.Z)(r,1)[0],c=o.chosenRegion,i=o.chosenSshKeyName,u=o.uploadedKey,p=o.chosenInstanceType,d=o.chosenNumOfInstances,m=o.chosenSource,f=o.sshPublicName,b=o.provider,v=o.chosenTemplate,g=Q(b).sources,y=(0,w.a)([k,"".concat(c,"-").concat(m)],(function(){return X(m,c)}),{enabled:!!m&&!!c}).data,h=s().useState(!0),E=(0,a.Z)(h,2),O=E[0],P=E[1],j=null==y||null===(t=y.find((function(e){return e.id===v})))||void 0===t?void 0:t.name,I=Et(b).charAt(0).toUpperCase()+Et(b).slice(1),D=ht(b).replace("_"," "),T=D.charAt(0).toUpperCase()+D.slice(1);return s().createElement(l.ExpandableSection,{toggleText:b&&se(b),onToggle:function(e){P(e)},isExpanded:O,isIndented:!0},s().createElement(l.DescriptionList,{isHorizontal:!0},s().createElement(l.DescriptionListGroup,null,s().createElement(l.DescriptionListTerm,null,"Image"),s().createElement(l.DescriptionListDescription,null,n)),s().createElement(l.DescriptionListGroup,null,s().createElement(l.DescriptionListTerm,null,"Account"),s().createElement(l.DescriptionListDescription,null,null==g?void 0:g.find((function(e){return e.id===m})).name)),s().createElement(l.DescriptionListGroup,null,s().createElement(l.DescriptionListTerm,null,I),s().createElement(l.DescriptionListDescription,null,c)),s().createElement(l.DescriptionListGroup,null,s().createElement(l.DescriptionListTerm,null,T),s().createElement(l.DescriptionListDescription,null,p)),s().createElement(l.DescriptionListGroup,null,s().createElement(l.DescriptionListTerm,null,"Count"),s().createElement(l.DescriptionListDescription,null,d)),s().createElement(l.DescriptionListGroup,null,s().createElement(l.DescriptionListTerm,null,u?"New SSH key":"Existing SSH key"),s().createElement(l.DescriptionListDescription,null,u?f:i)),v&&s().createElement(l.DescriptionListGroup,null,s().createElement(l.DescriptionListTerm,null,"Launch template"),s().createElement(l.DescriptionListDescription,null,j))))};Ot.propTypes={imageName:i().string.isRequired};const St=Ot;var wt=function(e){var t=e.imageName;return s().createElement("div",{className:"pf-c-form"},s().createElement(l.Title,{ouiaId:"review_details_title",headingLevel:"h1"},"Review details"),s().createElement(l.Text,{ouiaId:"review_details_description"},"Review the information below and then click ",s().createElement("b",null,"Launch")," to finish the process."),s().createElement(St,{imageName:t}))};wt.propTypes={imageName:i().string.isRequired};const Pt=wt;var jt=(0,b.Z)({},L,["ssh-ed25519"]);function It(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?It(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Dt=function(e,t){return{id:e,toString:function(){return t},compareTo:function(t){return t.id==e}}},Tt=function(e){var t=e.setStepValidated,n=S(),r=(0,a.Z)(n,2),o=r[0],c=r[1],i=s().useState(!1),u=(0,a.Z)(i,2),p=u[0],d=u[1],m=s().useState(o.chosenSshKeyId?Dt(o.chosenSshKeyId,o.chosenSshKeyName):null),f=(0,a.Z)(m,2),b=f[0],v=f[1],g=s().useState(!0),y=(0,a.Z)(g,2),h=y[0],E=y[1];s().useEffect((function(){var e,n,r,a,c=null==k||null===(e=k.find((function(e){return e.id===(null==b?void 0:b.id)})))||void 0===e?void 0:e.type;n=o.provider,r=c,(null===(a=jt[n])||void 0===a?void 0:a.includes(r))?(t(!1),E(!1)):(t(!!b),E(!0))}),[b]);var O=(0,w.a)(j,B),P=O.isLoading,I=O.isError,k=O.data;return P?s().createElement(l.Spinner,{isSVG:!0,size:"sm","aria-label":"Loading saved SSH keys"}):I||k&&k.length<1?s().createElement(s().Fragment,null,I&&s().createElement(l.Alert,{ouiaId:"pubkey_alert",variant:"warning",isInline:!0,title:"There are problems fetching saved SSH keys"}),s().createElement(l.Select,{ouiaId:"pubkey_empty",isDisabled:!0,placeholderText:"No SSH key found","aria-label":"Select public key"})):s().createElement(l.FormGroup,{helperTextInvalid:"Key format is not support in ".concat(se(o.provider)),label:"Select public key",validated:!h&&"error"},s().createElement(l.Select,{ouiaId:"select_pubkey",onToggle:function(e){return d(e)},onSelect:function(e,t){c((function(e){return kt(kt({},e),{},{chosenSshKeyId:t.id,chosenSshKeyName:t.toString()})})),v(t),d(!1)},isOpen:p,selections:b,placeholderText:"Select public key...","aria-label":"Select public key",validated:!h&&"error"},k.map((function(e){var t=e.id,n=e.name;return s().createElement(l.SelectOption,{"aria-label":"Public key ".concat(n),key:t,value:Dt(t,n)})}))))};Tt.propTypes={setStepValidated:i().func.isRequired};const xt=Tt;function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Zt=function(e){var t=e.setStepValidated,n=function(e){var t,n=new RegExp("^(ssh|ecdsa)");return(null===(t=jt[p])||void 0===t||!t.some((function(t){return null==e?void 0:e.startsWith(t)})))&&n.test(e)},r=S(),o=(0,a.Z)(r,2),c=o[0],i=c.sshPublicName,u=c.sshPublicKey,p=c.provider,d=o[1],m=s().useState(),f=(0,a.Z)(m,2),v=f[0],g=f[1],y=s().useState({sshKeyBody:n(u)?"success":"default",sshKeyName:i?"success":"default"}),h=(0,a.Z)(y,2),E=h[0],O=h[1],w=s().useState(i),P=(0,a.Z)(w,2),j=P[0],I=P[1],k=s().useState(u),D=(0,a.Z)(k,2),T=D[0],x=D[1];s().useEffect((function(){var e=Object.values(E).some((function(e){return"success"!==e}));t(!e)}),[E]);var _=function(e,t){return O((function(n){return Ct(Ct({},n),{},(0,b.Z)({},e,t))}))};return s().createElement(l.FormGroup,{isStack:!0},s().createElement(l.FormGroup,{validated:E.sshKeyName,helperTextInvalid:"Name is required",label:"Name",isRequired:!0,fieldId:"ssh-name"},s().createElement(l.TextInput,{ouiaId:"new_pubkey_name",validated:E.sshKeyName,value:j,id:"public-key-name",onChange:function(e){d((function(t){return Ct(Ct({},t),{},{sshPublicName:e})})),I(e)},onBlur:function(){0!==j.length?_("sshKeyName","success"):_("sshKeyName","error")},type:"text"})),s().createElement(l.FormGroup,{helperTextInvalid:"Public key format is invalid or unsupported",label:"SSH public key",isRequired:!0,fieldId:"ssh-file",validated:E.sshKeyBody,labelIcon:Object.keys(jt).includes(p)&&s().createElement(l.Popover,{bodyContent:s().createElement("span",null,"Azure does not support ed25519 keys, please use RSA key instead. See",s().createElement("a",{rel:"noreferrer",target:"_blank",href:"https://learn.microsoft.com/en-us/troubleshoot/azure/virtual-machines/ed25519-ssh-keys"},"further information"))},s().createElement(l.Button,{ouiaId:"pubkey_help",type:"button","aria-label":"More info for pubkeys format",onClick:function(e){return e.preventDefault()},"aria-describedby":"public key content",className:"pf-c-form__group-label-help",variant:"plain"},s().createElement(De.ZP,{noVerticalAlign:!0})))},s().createElement(l.FileUpload,{id:"public-key-value",onDataChange:function(e){n(e)?(d((function(t){return Ct(Ct({},t),{},{sshPublicKey:e})})),x(e),_("sshKeyBody","success")):_("sshKeyBody","error")},allowEditingUploadedText:!0,onTextChange:function(e){d((function(t){return Ct(Ct({},t),{},{sshPublicKey:e})})),x(e)},onTextAreaBlur:function(){_("sshKeyBody",""===T?"default":n(T)?"success":"error")},type:"text",value:T,validated:E.sshKeyBody,onReadStarted:function(){g(!0)},onReadFinished:function(){g(!1)},onReadFailed:function(){d((function(e){return Ct(Ct({},e),{},{sshPublicName:"<Failed to load the file>"})})),_("sshKeyBody","error")},onClearClick:function(){d((function(e){return Ct(Ct({},e),{},{sshPublicName:void 0,sshPublicKey:void 0})})),x(""),_("sshKeyBody","default")},isLoading:v,filenamePlaceholder:"Drag a file here"})))};Zt.propTypes={setStepValidated:i().func.isRequired};const Lt=Zt;function Rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zt="newKey",Vt=function(e){var t=e.setStepValidated,n=S(),r=(0,a.Z)(n,2),o=r[0],c=r[1],i=(0,w.a)(j,B),u=i.isError,p=i.data,d=s().useState(!1),m=(0,a.Z)(d,2),f=m[0],b=m[1],v=function(e){c((function(t){return Nt(Nt({},t),{},{uploadedKey:zt===e})}))},g=function(e,t){v(t.currentTarget.value)};return s().useEffect((function(){(u||(null==p?void 0:p.length)<1)&&(b(!0),v(zt))}),[u,p]),s().createElement(l.Form,{className:"pubkeys"},s().createElement(l.Title,{ouiaId:"pubkey_title",headingLevel:"h1"},"SSH key authentication"),s().createElement(l.Text,{ouiaId:"pubkey_description"},"Establish secure, reliable communication and strong encryption to protect data."),s().createElement(l.FormGroup,{role:"radiogroup",isStack:!0,isRequired:!0,label:"Select a method to add SSH public key"},s().createElement(l.Radio,{id:"existing-pubkey-radio",ouiaId:"pubkey_radio",isChecked:!o.uploadedKey,isDisabled:f,name:"ssh-keys-radio",value:"existKey",onChange:g,label:"Select existing SSH public key","data-testid":"existing-pubkey-radio",body:(!o.uploadedKey||f)&&s().createElement(xt,{setStepValidated:t})}),s().createElement(l.Radio,{id:"upload-pubkey-radio",ouiaId:"new_pubkey_radio",isChecked:o.uploadedKey,name:"ssh-keys-radio",value:zt,onChange:g,label:"Add and save a new SSH public key",description:"Newly added key will be automatically saved.","data-testid":"upload-pubkey-radio",body:o.uploadedKey&&s().createElement(Lt,{setStepValidated:t})})))};Vt.propTypes={setStepValidated:i().func.isRequired};const At=Vt;var qt=n(6948),Ft=n(1942),Bt=n(5451),Gt=n(9609);function Kt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ht(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ht(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw o}}}}function Ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Mt=x().mark((function e(t){var n,r,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Kt(t),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return a=r.value,e.next=7,a;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])}));var Ut=n(1249),Wt=n(8240),Jt=n(6771),Xt=n(3912),Yt=n(3134),$t=n(4793),Qt=function(e,t,n){switch(t){case Z:return"https://console.aws.amazon.com/ec2/home?region=".concat(n,"#InstanceDetails:instanceId=").concat(e);case L:return"https://portal.azure.com/#@rhdevcloudops.onmicrosoft.com/resource".concat(e,"/overview");case R:return"https://console.cloud.google.com/compute/instancesDetail/zones/".concat(n,"/instances/").concat(e);default:return null}};function en(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?en(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):en(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var nn=[{title:"5",value:5},{title:"10",value:10},{title:"20",value:20},{title:"50",value:50}],rn=function(e){var t=e.reservationID,n=e.provider,r=e.region,o=s().useState({perPage:5,page:1,startIdx:0,endIdx:5}),c=(0,a.Z)(o,2),i=c[0],u=c[1],p=(0,w.a)(["launchInfo",t],(function(){return J(t,n)}),{select:function(e){return null==e?void 0:e.instances}}),d=p.data,m=p.isLoading,f=null==d?void 0:d.slice(i.startIdx,i.endIdx),b=null==f?void 0:f.some((function(e){var t,n;return(null===(t=e.detail)||void 0===t||null===(n=t.public_dns)||void 0===n?void 0:n.length)>0}));return m?s().createElement(l.Bullseye,null,s().createElement(l.Spinner,{isSVG:!0,size:"xl"})):s().createElement(l.Card,{style:{position:"relative",marginLeft:"-20%",marginRight:"-20%"}},s().createElement(l.Pagination,{itemCount:(null==d?void 0:d.length)||0,page:i.page,onSetPage:function(e,t,n,r,a){u({perPage:n,page:t,startIdx:r,endIdx:a})},perPage:i.perPage,onPerPageSelect:function(e,t,n,r,a){u((function(e){return tn(tn({},e),{},{perPage:t,page:n,startIdx:r,endIdx:a})}))},perPageOptions:nn,isCompact:!0,ouiaId:"instances-pagination"}),s().createElement(Ut.X,{ouiaId:"instances table","aria-label":"instances description table",variant:"compact"},s().createElement(Wt.h,null,s().createElement(Jt.Tr,null,s().createElement(Xt.Th,null,"ID"),b&&s().createElement(Xt.Th,null,"DNS"),s().createElement(Xt.Th,null,"SSH command"))),s().createElement(Yt.p,null,null==f?void 0:f.map((function(e){var t=e.instance_id,a=e.detail;return s().createElement(Jt.Tr,{key:t},s().createElement($t.Td,{"aria-label":"instance id",dataLabel:"ID"},s().createElement(l.Button,{variant:"link",icon:s().createElement(ie.ZP,null),iconPosition:"right",isInline:!0,component:"a",rel:"noreferrer",target:"_blank",href:Qt(t,n,r)},function(e,t){return t===L?e.split("/").slice(-1):e}(t,n))),b&&s().createElement($t.Td,{"aria-label":"instance dns",dataLabel:"DNS"},null!=a&&a.public_dns?s().createElement(l.ClipboardCopy,{isReadOnly:!0,hoverTip:"Copy DNS",clickTip:"DNS was copied!",variant:"expansion"},null==a?void 0:a.public_dns):"N/A"),s().createElement($t.Td,{"aria-label":"ssh command",dataLabel:"SSH"},null!=a&&a.public_ipv4?s().createElement(l.ClipboardCopy,{isReadOnly:!0,hoverTip:"Copy SSH command",clickTip:"SSH was copied!",variant:"expansion"},"ssh ".concat(function(e){switch(e){case Z:return"ec2-user";case L:return"azureuser";case R:return"gcp-user"}}(n),"@").concat(null==a?void 0:a.public_ipv4)):"N/A"))})))))};rn.propTypes={provider:i().string.isRequired,region:i().string.isRequired,reservationID:i().number.isRequired};const an=rn;function on(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?on(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):on(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ln=function(e){var t=e.setLaunchSuccess,n=s().useState([]),r=(0,a.Z)(n,2),o=r[0],c=r[1],i=s().useState(),u=(0,a.Z)(i,2),p=u[0],d=u[1],m=s().useState(),f=(0,a.Z)(m,2),v=f[0],g=f[1],y=s().useState(0),h=(0,a.Z)(y,2),E=h[0],O=h[1],P=s().useState(0),j=(0,a.Z)(P,2),I=j[0],k=j[1],D=s().useState(),T=(0,a.Z)(D,2),x=T[0],_=T[1],C=S(),Z=(0,a.Z)(C,1)[0],L=Z.chosenSource,R=Z.chosenInstanceType,N=Z.chosenNumOfInstances,z=Z.chosenRegion,V=Z.sshPublicName,A=Z.sshPublicKey,q=Z.chosenSshKeyId,F=Z.uploadedKey,B=Z.chosenImageID,G=Z.provider,U=Z.chosenTemplate,W=function(e){var t=s().useRef(null),n=s().useRef(e),r=s().useState(),o=(0,a.Z)(r,2),c=o[0],i=o[1];return s().useEffect((function(){t.current=Mt(n.current)}),[]),{nextInterval:function(){var e=t.current.next().value;return i(void 0!==e&&e),void 0!==e&&e},currentInterval:c}}(dt),J=W.nextInterval,X=W.currentInterval,Y=(0,Gt.D)(K(G),{onSuccess:function(e){var t;oe(),_(null==e||null===(t=e.data)||void 0===t?void 0:t.reservation_id)}}),$=Y.mutate,Q=Y.error,ee=function(){var e;return cn((e={source_id:L},(0,b.Z)(e,ht(G),R),(0,b.Z)(e,"amount",N),(0,b.Z)(e,"image_id",B),(0,b.Z)(e,Et(G),z),(0,b.Z)(e,"pubkey_id",q),e),U&&{launch_template_id:U})};s().useEffect((function(){K&&(F?(c(vt.concat(yt(G))),ne({name:V,body:A})):(c(yt(G)),$(ee())))}),[K,c,F]);var te=(0,Gt.D)(H,{onSuccess:function(e){var t;oe(),$(cn(cn({},ee()),{},{pubkey_id:null==e||null===(t=e.data)||void 0===t?void 0:t.id}))}}),ne=te.mutate,re=te.error,ae=(0,w.a)(["reservation",x],(function(){return M(x)}),{enabled:!!x&&!p,staleTime:0,refetchInterval:function(e){return!(null!=e&&e.success||null!=e&&e.error)&&X},onSuccess:function(e){I<e.step&&!e.error&&(k((function(e){return e+1})),oe()),(null==e||!e.success)&&J(),e.success&&t()},onError:function(){g("The reservation was created but we can't get the launch progress status.\n           Check your ".concat(se(G)," console later. If this issue persists, please contact support."))},refetchIntervalInBackground:!0}).data;s().useEffect((function(){if(!1===X&&g("The launch progress is slower than expected, but we are still on it.\n         It is safe to close this window and check your ".concat(se(G)," console later")),Q||re||null!=ae&&ae.error){var e,t,n,r,a=null==Q||null===(e=Q.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.msg,o=null==re||null===(n=re.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.msg;d(a||o||(null==ae?void 0:ae.error))}}),[Q,re,null==ae?void 0:ae.error,X]);var oe=function(){return O((function(e){return e+1}))};return s().createElement(l.WizardContextConsumer,null,(function(e){var t=e.goToStepById,n=e.onClose;return s().createElement(l.EmptyState,{variant:"large"},s().createElement(l.EmptyStateIcon,{color:(null==ae?void 0:ae.success)?"#3E8635":null,icon:null!=ae&&ae.success?Bt.ZP:qt.ZP}),s().createElement(l.Title,{headingLevel:"h4",size:"lg",ouiaId:"launch-status"},null!=ae&&ae.success?"System(s) launched successfully":"Launching system(s)"),x&&s().createElement(l.Text,{component:"small",ouiaId:"launch-id"},"launch ID: ".concat(x)),s().createElement(l.EmptyStateBody,null,!(null!=ae&&ae.success)&&s().createElement(l.ProgressStepper,{isCenterAligned:!0},o.map((function(e,t){var n=e.name,r=e.description,a=function(e,t,n,r){return e<t?"success":e===t&&n?"danger":e===t&&r?"warning":e===t?"info":e>t?"pending":void 0}(t,E,p,v);return s().createElement(l.ProgressStep,{variant:a,id:n,key:n,icon:t>E?s().createElement(Ft.ZP,null):void 0,isCurrent:t===E,description:r,titleId:n,"aria-label":"step ".concat(n," ").concat(a),popoverRender:(p||v)&&t===E?function(e){return s().createElement(l.Popover,{"aria-label":"".concat(n," error message"),headerContent:p?"Error":"Warning",bodyContent:p||v,reference:e,position:"right"})}:void 0},n)})))),(null==ae?void 0:ae.success)&&gt.includes(G)&&s().createElement(an,{provider:G,region:z,reservationID:x}),p&&s().createElement(l.Button,{id:"wizard-provisioning-failed-edit-button",onClick:function(){return t(1)},variant:"primary"},"Edit"),s().createElement(l.EmptyStateSecondaryActions,null,s().createElement(l.Button,{variant:"link",isDisabled:!p&&E<2,onClick:n},"Close")))}))};ln.propTypes={setLaunchSuccess:i().func.isRequired};const un=ln;function sn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sn(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var dn={1:"account",4:"sshkey",5:"review"},mn=function(e){return dn[e]};const fn=function(){return u.createElement(l.WizardFooter,null,u.createElement(l.WizardContextConsumer,null,(function(e){var t=e.activeStep,n=e.onNext,r=e.onBack,a=e.onClose,o=void 0===t.enableNext||t.enableNext;return u.createElement(u.Fragment,null,u.createElement(l.Button,{id:"wizard-provisioning-".concat(mn(t.id),"-next-button"),variant:l.ButtonVariant.primary,type:"submit",onClick:n,isDisabled:!o},t.nextButtonText||"Next"),!t.hideBackButton&&u.createElement(l.Button,{id:"wizard-provisioning-".concat(mn(t.id),"-back-button"),variant:l.ButtonVariant.secondary,onClick:r,isDisabled:1==t.id},"Back"),!t.hideCancelButton&&u.createElement("div",{className:re.Z.wizardFooterCancel},u.createElement(l.Button,{variant:l.ButtonVariant.link,onClick:a},"Cancel")))})))};var bn=n(5387),vn=["onClose","image"],gn={sshStep:!1,awsStep:!1},yn=function(e){var t,n,c,i,p,d,m=e.onClose,f=e.image,b=(0,o.Z)(e,vn),v=s().useState(1),g=(0,a.Z)(v,2),y=g[0],h=g[1],E=s().useState(gn),O=(0,a.Z)(E,2),S=O[0],w=O[1],P=s().useState(!1),j=(0,a.Z)(P,2),I=j[0],k=j[1],D=s().useState(),T=(0,a.Z)(D,2),x=T[0],_=T[1],Z=ee(f,{refetch:y<=2}),L=Z.isLoading,R=Z.error,N=Z.sources;t=function(){return C().defaults.headers.common["X-Correlation-Id"]=(0,bn.Z)(),function(){return delete C().defaults.headers.common["X-Correlation-Id"]}},n=(0,u.useRef)(),c=(0,u.useRef)(!1),i=(0,u.useRef)(!1),p=(0,u.useState)(0),d=(0,a.Z)(p,2)[1],c.current&&(i.current=!0),(0,u.useEffect)((function(){return c.current||(n.current=t(),c.current=!0),d((function(e){return e+1})),function(){i.current&&n.current&&n.current()}}),[]);var z=function(){k(!1),h(1),w(gn),m()},V=function(e){return e.availableSources.length>0?(n=(t=e).stepIdReached,r=t.image,a=t.stepValidation,o=t.setStepValidation,c=t.setLaunchSuccess,[{name:"Account and customization",steps:[{name:se(r.provider),id:1,enableNext:a.awsStep,component:s().createElement(pt,{image:r,setStepValidated:function(e){return o((function(t){return pn(pn({},t),{},{awsStep:e})}))}}),canJumpTo:n>=1}]},{name:"SSH key authentication",id:4,component:s().createElement(At,{setStepValidated:function(e){return o((function(t){return pn(pn({},t),{},{sshStep:e})}))}}),canJumpTo:n>=4,enableNext:a.sshStep},{name:"Review details",id:5,component:s().createElement(Pt,{imageName:r.name}),canJumpTo:n>=5,nextButtonText:"Launch"},{name:"Finish Progress",id:6,component:s().createElement(un,{setLaunchSuccess:function(){return c(!0)},imageID:r.id}),isFinishedStep:!0}]):function(e){var t=e.image,n=e.isLoading,r=e.sourcesError;return[{name:"Define source",id:1,component:s().createElement(ke,{image:t,isLoading:n,error:r}),isFinishedStep:!0}]}(e);var t,n,r,a,o,c}({sourcesError:R,isLoading:L,availableSources:N,stepIdReached:y,image:f,stepValidation:S,setStepValidation:w,setLaunchSuccess:_});return s().createElement(s().Fragment,null,s().createElement(l.Wizard,(0,r.Z)({},b,{title:"Launch",description:"Launch image ".concat(f.name),steps:V,onClose:function(){y>=5&&!x?k(!0):z()},onNext:function(e,t){var n=e.id,r=e.name,a=t.prevId,o=t.prevName;console.debug("current id: ".concat(n,", current name: ").concat(r,", previous id: ").concat(a,", previous name: ").concat(o)),h((function(e){return e<n?n:e}))},className:"provisioning",footer:s().createElement(fn,null)})),s().createElement(ne,{isOpen:I,onConfirm:z,onCancel:function(){return k(!1)}}))},hn=function(e){return s().createElement(O,null,s().createElement(f,null,s().createElement(yn,e)))};yn.propTypes={onClose:i().func,image:ve},hn.propTypes=yn.propTypes;const En=hn},5467:()=>{},1452:()=>{},4946:()=>{},2857:()=>{},8992:()=>{},187:()=>{},1626:()=>{},1993:()=>{},6822:()=>{},4994:()=>{},4690:()=>{},7494:()=>{},7761:()=>{},314:()=>{},9854:()=>{},209:()=>{}}]);
//# sourceMappingURL=../../sourcemaps/exposed-./ProvisioningWizard.da7fec2af7634dc011b9c3811c1dfd2b.js.map