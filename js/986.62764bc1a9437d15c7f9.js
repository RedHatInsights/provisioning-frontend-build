(self.webpackChunkprovisioning=self.webpackChunkprovisioning||[]).push([[986],{3115:(e,t,r)=>{"use strict";r.d(t,{l:()=>c});var n=r(1988),a=r(3264),i=r(1924),o=r(8296);const s=e=>{var{children:t=null,className:r="",isHorizontal:s=!1,isWidthLimited:c=!1,maxWidth:u="",innerRef:l}=e,p=(0,n._T)(e,["children","className","isHorizontal","isWidthLimited","maxWidth","innerRef"]);return a.createElement("form",Object.assign({noValidate:!0},u&&{style:Object.assign({"--pf-c-form--m-limit-width--MaxWidth":u},p.style)},p,{className:(0,o.i)(i.Z.form,s&&i.Z.modifiers.horizontal,(c||u)&&i.Z.modifiers.limitWidth,r),ref:l}),t)},c=a.forwardRef(((e,t)=>a.createElement(s,Object.assign({innerRef:t},e))));c.displayName="Form"},9775:(e,t,r)=>{"use strict";r.d(t,{c:()=>l});var n=r(1988),a=r(3264),i=r(1924),o=r(1888),s=r(8296),c=r(344),u=r(1724);const l=e=>{var{children:t=null,className:r="",label:l,labelInfo:p,labelIcon:f,isRequired:d=!1,validated:h="default",isInline:v=!1,hasNoPaddingTop:m=!1,isStack:g=!1,helperText:b,isHelperTextBeforeField:y=!1,helperTextInvalid:w,helperTextIcon:x,helperTextInvalidIcon:k,fieldId:E,role:T}=e,A=(0,n._T)(e,["children","className","label","labelInfo","labelIcon","isRequired","validated","isInline","hasNoPaddingTop","isStack","helperText","isHelperTextBeforeField","helperTextInvalid","helperTextIcon","helperTextInvalidIcon","fieldId","role"]);const D="string"!=typeof b?b:a.createElement("div",{className:(0,s.i)(i.Z.formHelperText,h===c.LD.success&&i.Z.modifiers.success,h===c.LD.warning&&i.Z.modifiers.warning),id:`${E}-helper`,"aria-live":"polite"},x&&a.createElement("span",{className:(0,s.i)(i.Z.formHelperTextIcon)},x),b),S="string"!=typeof w?w:a.createElement("div",{className:(0,s.i)(i.Z.formHelperText,i.Z.modifiers.error),id:`${E}-helper`,"aria-live":"polite"},k&&a.createElement("span",{className:(0,s.i)(i.Z.formHelperTextIcon)},k),w),O=h===c.LD.error&&w?S:h!==c.LD.error&&b?D:"",C="group"===T||"radiogroup"===T,P=C?"span":"label",N=a.createElement(a.Fragment,null,a.createElement(P,Object.assign({className:(0,s.i)(i.Z.formLabel)},!C&&{htmlFor:E}),a.createElement("span",{className:(0,s.i)(i.Z.formLabelText)},l),d&&a.createElement("span",{className:(0,s.i)(i.Z.formLabelRequired),"aria-hidden":"true"}," ",o.t))," ",a.isValidElement(f)&&f);return a.createElement(u.w,null,(e=>a.createElement("div",Object.assign({className:(0,s.i)(i.Z.formGroup,r)},T&&{role:T},C&&{"aria-labelledby":`${E||e}-legend`},A),l&&a.createElement("div",Object.assign({className:(0,s.i)(i.Z.formGroupLabel,p&&i.Z.modifiers.info,m&&i.Z.modifiers.noPaddingTop)},C&&{id:`${E||e}-legend`}),p&&a.createElement(a.Fragment,null,a.createElement("div",{className:(0,s.i)(i.Z.formGroupLabelMain)},N),a.createElement("div",{className:(0,s.i)(i.Z.formGroupLabelInfo)},p)),!p&&N),a.createElement("div",{className:(0,s.i)(i.Z.formGroupControl,v&&i.Z.modifiers.inline,g&&i.Z.modifiers.stack)},y&&O,t,!y&&O))))};l.displayName="FormGroup"},6621:(e,t,r)=>{"use strict";r.d(t,{p:()=>s});var n=r(1988),a=r(3264),i=r(9945),o=r(8296);const s=e=>{var{children:t,className:r,component:s="div",id:c,isLiveRegion:u=!1}=e,l=(0,n._T)(e,["children","className","component","id","isLiveRegion"]);const p=s;return a.createElement(p,Object.assign({id:c,className:(0,o.i)(i.Z.helperText,r)},u&&{"aria-live":"polite"},l),t)};s.displayName="HelperText"},5673:(e,t,r)=>{"use strict";r.d(t,{u:()=>f});var n=r(1988),a=r(3264),i=r(9945),o=r(8296),s=r(965),c=r(9957),u=r(8778),l=r(3047);const p={default:"",indeterminate:i.Z.modifiers.indeterminate,warning:i.Z.modifiers.warning,success:i.Z.modifiers.success,error:i.Z.modifiers.error},f=e=>{var{children:t,className:r,component:f="div",variant:d="default",icon:h,isDynamic:v=!1,hasIcon:m=v,id:g,screenReaderText:b=`${d} status`}=e,y=(0,n._T)(e,["children","className","component","variant","icon","isDynamic","hasIcon","id","screenReaderText"]);const w=f;return a.createElement(w,Object.assign({className:(0,o.i)(i.Z.helperTextItem,p[d],v&&i.Z.modifiers.dynamic,r),id:g},y),h&&a.createElement("span",{className:(0,o.i)(i.Z.helperTextItemIcon),"aria-hidden":!0},h),m&&!h&&a.createElement("span",{className:(0,o.i)(i.Z.helperTextItemIcon),"aria-hidden":!0},("default"===d||"indeterminate"===d)&&a.createElement(s.ZP,null),"warning"===d&&a.createElement(c.ZP,null),"success"===d&&a.createElement(u.ZP,null),"error"===d&&a.createElement(l.ZP,null)),a.createElement("span",{className:(0,o.i)(i.Z.helperTextItemText)},t,v&&a.createElement("span",{className:"pf-u-screen-reader"},": ",b,";")))};f.displayName="HelperTextItem"},9787:(e,t,r)=>{"use strict";r.d(t,{B:()=>f});var n=r(1988),a=r(3264);r(4282);var i=r(8296),o=r(2455),s=r(344),c=r(2472);class u extends a.Component{constructor(e){super(e),this.handleChange=e=>{this.props.onChange(e.currentTarget.value,e)},e.id||e["aria-label"]||console.error("FormSelect requires either an id or aria-label to be specified"),this.state={ouiaStateId:(0,c.ql)(u.displayName,e.validated)}}render(){const e=this.props,{children:t,className:r,value:l,validated:p,isDisabled:f,isRequired:d,isIconSprite:h,ouiaId:v,ouiaSafe:m}=e,g=(0,n._T)(e,["children","className","value","validated","isDisabled","isRequired","isIconSprite","ouiaId","ouiaSafe"]),b=a.Children.toArray(t).find((e=>e.props.value===l)),y=b&&b.props.isPlaceholder;return a.createElement("select",Object.assign({},g,{className:(0,i.i)(o.Z.formControl,h&&o.Z.modifiers.iconSprite,r,p===s.LD.success&&o.Z.modifiers.success,p===s.LD.warning&&o.Z.modifiers.warning,y&&o.Z.modifiers.placeholder),"aria-invalid":p===s.LD.error},(0,c.dp)(u.displayName,void 0!==v?v:this.state.ouiaStateId,m),{onChange:this.handleChange,disabled:f,required:d,value:l}),t)}}u.displayName="FormSelect",u.defaultProps={className:"",value:"",validated:"default",isDisabled:!1,isRequired:!1,isIconSprite:!1,onBlur:()=>{},onFocus:()=>{},onChange:()=>{},ouiaSafe:!0};var l=r(3393),p=r(2607);const f=e=>{var{className:t="",children:r,innerRef:o}=e,s=(0,n._T)(e,["className","children","innerRef"]);const c=[u,l.Kx,p.oi].map((e=>e.displayName)),f=a.Children.toArray(r).find((e=>!c.includes(e.type.displayName)&&e.props.id)),d=a.useRef(null),h=o||d;return a.createElement("div",Object.assign({ref:h,className:(0,i.i)("pf-c-input-group",t)},s),f?a.Children.map(r,(e=>!c.includes(e.type.displayName)||e.props["aria-describedby"]?e:a.cloneElement(e,{"aria-describedby":""===e.props["aria-describedby"]?void 0:f.props.id}))):r)};f.displayName="InputGroup"},614:(e,t,r)=>{"use strict";r.d(t,{Y:()=>h});var n=r(1988),a=r(3264);r(9076);const i="pf-m-status",o="pf-c-number-input__icon";var s=r(8296),c=r(965);const u=(0,r(400).IU)({name:"PlusIcon",height:512,width:448,svgPath:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",yOffset:0,xOffset:0});var l=r(9787),p=r(2588),f=r(344),d=r(2607);const h=e=>{var{value:t=0,className:r,widthChars:h,isDisabled:v=!1,validated:m=f.LD.default,onMinus:g=(()=>{}),onChange:b,onBlur:y,onPlus:w=(()=>{}),unit:x,unitPosition:k="after",min:E,max:T,inputName:A,inputAriaLabel:D="Input",minusBtnAriaLabel:S="Minus",plusBtnAriaLabel:O="Plus",inputProps:C,minusBtnProps:P,plusBtnProps:N,allowEmptyInput:M=!1}=e,I=(0,n._T)(e,["value","className","widthChars","isDisabled","validated","onMinus","onChange","onBlur","onPlus","unit","unitPosition","min","max","inputName","inputAriaLabel","minusBtnAriaLabel","plusBtnAriaLabel","inputProps","minusBtnProps","plusBtnProps","allowEmptyInput"]);M||(t=t||0);const j=a.createElement("div",{className:(0,s.i)("pf-c-number-input__unit")},x),U=C&&C.onKeyDown?C.onKeyDown:(F={inputName:A,onMinus:g,onPlus:w},e=>{f.yu.ArrowUp===e.key&&F.onPlus&&(e.preventDefault(),F.onPlus(null,F.inputName)),f.yu.ArrowDown===e.key&&F.onMinus&&(e.preventDefault(),F.onMinus(null,F.inputName))});var F;return a.createElement("div",Object.assign({className:(0,s.i)("pf-c-number-input","default"!==m&&i,r)},h&&{style:Object.assign({"--pf-c-number-input--c-form-control--width-chars":h},I.style)},I),x&&"before"===k&&j,a.createElement(l.B,null,a.createElement(p.zx,Object.assign({variant:"control","aria-label":S,isDisabled:v||t<=E,onClick:e=>g(e,A)},P),a.createElement("span",{className:(0,s.i)(o)},a.createElement(c.ZP,{"aria-hidden":"true"}))),a.createElement(d.oi,Object.assign({},C,{type:"number",value:t,name:A,"aria-label":D},v&&{isDisabled:v},b&&{onChange:(e,t)=>b(t)},{onBlur:e=>{e.target.value=Number(e.target.value).toString(),b&&b(e),y&&y(e)}},!b&&{isReadOnly:!0},{onKeyDown:U,validated:m})),a.createElement(p.zx,Object.assign({variant:"control","aria-label":O,isDisabled:v||t>=T,onClick:e=>w(e,A)},N),a.createElement("span",{className:(0,s.i)(o)},a.createElement(u,{"aria-hidden":"true"})))),x&&"after"===k&&j)};h.displayName="NumberInput"},7646:(e,t,r)=>{"use strict";r.d(t,{x:()=>u});var n=r(1988),a=r(3264),i=r(8296);r(108);const o="pf-m-visited";var s,c=r(2472);!function(e){e.h1="h1",e.h2="h2",e.h3="h3",e.h4="h4",e.h5="h5",e.h6="h6",e.p="p",e.a="a",e.small="small",e.blockquote="blockquote",e.pre="pre"}(s||(s={}));const u=e=>{var{children:t=null,className:r="",component:l=s.p,isVisitedLink:p=!1,ouiaId:f,ouiaSafe:d=!0}=e,h=(0,n._T)(e,["children","className","component","isVisitedLink","ouiaId","ouiaSafe"]);const v=l,m=(0,c.S$)(u.displayName,f,d);return a.createElement(v,Object.assign({},m,h,{"data-pf-content":!0,className:(0,i.i)(p&&l===s.a&&o,r)}),t)};u.displayName="Text"},3393:(e,t,r)=>{"use strict";r.d(t,{f:()=>s,Kx:()=>d});var n=r(1988),a=r(3264),i=r(2455);const o="--pf-c-form-control--textarea--Height";var s,c,u=r(8296),l=r(164),p=r(344);!function(e){e.horizontal="horizontal",e.vertical="vertical",e.both="both"}(s||(s={})),function(e){e.default="default",e.plain="plain"}(c||(c={}));class f extends a.Component{constructor(e){super(e),this.inputRef=a.createRef(),this.setAutoHeight=e=>{e.style.setProperty(o,"inherit");const t=window.getComputedStyle(e),r=parseInt(t.getPropertyValue("border-top-width"))+parseInt(t.getPropertyValue("padding-top"))+e.scrollHeight+parseInt(t.getPropertyValue("padding-bottom"))+parseInt(t.getPropertyValue("border-bottom-width"));e.style.setProperty(o,`${r}px`)},this.handleChange=e=>{const t=e.currentTarget;this.props.autoResize&&l.Nq&&this.setAutoHeight(t),this.props.onChange&&this.props.onChange(t.value,e)},e.id||e["aria-label"]||console.error("TextArea: TextArea requires either an id or aria-label to be specified")}componentDidMount(){const e=this.props.innerRef||this.inputRef;if(this.props.autoResize&&l.Nq){const t=e.current;this.setAutoHeight(t)}}render(){const e=this.props,{className:t,value:r,validated:o,isRequired:c,isDisabled:f,isIconSprite:d,isReadOnly:h,readOnlyVariant:v,resizeOrientation:m,innerRef:g,disabled:b,autoResize:y,onChange:w}=e,x=(0,n._T)(e,["className","value","validated","isRequired","isDisabled","isIconSprite","isReadOnly","readOnlyVariant","resizeOrientation","innerRef","disabled","autoResize","onChange"]),k=`resize${(0,l.kC)(m)}`;return a.createElement("textarea",Object.assign({className:(0,u.i)(i.Z.formControl,d&&i.Z.modifiers.iconSprite,"plain"===v&&i.Z.modifiers.plain,t,m!==s.both&&i.Z.modifiers[k],o===p.LD.success&&i.Z.modifiers.success,o===p.LD.warning&&i.Z.modifiers.warning),onChange:this.handleChange},"string"!=typeof this.props.defaultValue&&{value:r},{"aria-invalid":o===p.LD.error,required:c,disabled:f||b,readOnly:!!v||h,ref:g||this.inputRef},x))}}f.displayName="TextArea",f.defaultProps={innerRef:a.createRef(),className:"",isRequired:!1,isDisabled:!1,isIconSprite:!1,validated:"default",resizeOrientation:"both","aria-label":null};const d=a.forwardRef(((e,t)=>a.createElement(f,Object.assign({},e,{innerRef:t}))));d.displayName="TextArea"},1888:(e,t,r)=>{"use strict";r.d(t,{t:()=>n});const n="*"},965:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>n});const n=(0,r(400).IU)({name:"MinusIcon",height:512,width:448,svgPath:"M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",yOffset:0,xOffset:0})},4046:(e,t,r)=>{"use strict";t.MU={name:"HelpIcon",height:1024,width:1024,svgPath:"M521.3,576 C627.5,576 713.7,502 713.7,413.7 C713.7,325.4 627.6,253.6 521.3,253.6 C366,253.6 334.5,337.7 329.2,407.2 C329.2,414.3 335.2,416 343.5,416 L445,416 C450.5,416 458,415.5 460.8,406.5 C460.8,362.6 582.9,357.1 582.9,413.6 C582.9,441.9 556.2,470.9 521.3,473 C486.4,475.1 447.3,479.8 447.3,521.7 L447.3,553.8 C447.3,570.8 456.1,576 472,576 C487.9,576 521.3,576 521.3,576 M575.3,751.3 L575.3,655.3 C575.313862,651.055109 573.620137,646.982962 570.6,644 C567.638831,640.947672 563.552355,639.247987 559.3,639.29884 L463.3,639.29884 C459.055109,639.286138 454.982962,640.979863 452,644 C448.947672,646.961169 447.247987,651.047645 447.29884,655.3 L447.29884,751.3 C447.286138,755.544891 448.979863,759.617038 452,762.6 C454.961169,765.652328 459.047645,767.352013 463.3,767.30116 L559.3,767.30116 C563.544891,767.313862 567.617038,765.620137 570.6,762.6 C573.659349,759.643612 575.360354,755.553963 575.3,751.3 M512,896 C300.2,896 128,723.9 128,512 C128,300.3 300.2,128 512,128 C723.8,128 896,300.2 896,512 C896,723.8 723.7,896 512,896 M512.1,0 C229.7,0 0,229.8 0,512 C0,794.2 229.8,1024 512.1,1024 C794.4,1024 1024,794.3 1024,512 C1024,229.7 794.4,0 512.1,0",yOffset:0,xOffset:0},t.by=r(5183).IU(t.MU),t.ZP=t.by},9945:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n}),r(1338);const n={helperText:"pf-c-helper-text",helperTextItem:"pf-c-helper-text__item",helperTextItemIcon:"pf-c-helper-text__item-icon",helperTextItemText:"pf-c-helper-text__item-text",modifiers:{indeterminate:"pf-m-indeterminate",warning:"pf-m-warning",success:"pf-m-success",error:"pf-m-error",dynamic:"pf-m-dynamic"},themeDark:"pf-theme-dark"}},8998:(e,t,r)=>{e.exports=function e(t,r,n){function a(o,s){if(!r[o]){if(!t[o]){if(i)return i(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[o]={exports:{}};t[o][0].call(u.exports,(function(e){return a(t[o][1][e]||e)}),u,u.exports,e,t,r,n)}return r[o].exports}for(var i=void 0,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(e,t,r){const n=e("./utils"),a=function(){"use strict";const e=n.stringToArray,t=["Zero","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["Zeroth","First","Second","Third","Fourth","Fifth","Sixth","Seventh","Eighth","Ninth","Tenth","Eleventh","Twelfth","Thirteenth","Fourteenth","Fifteenth","Sixteenth","Seventeenth","Eighteenth","Nineteenth"],a=["Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety","Hundred"],i=["Thousand","Million","Billion","Trillion"];const o={};t.forEach((function(e,t){o[e.toLowerCase()]=t})),r.forEach((function(e,t){o[e.toLowerCase()]=t})),a.forEach((function(e,t){const r=e.toLowerCase();o[r]=10*(t+2),o[r.substring(0,e.length-1)+"ieth"]=o[r]})),o.hundredth=100,i.forEach((function(e,t){const r=e.toLowerCase(),n=Math.pow(10,3*(t+1));o[r]=n,o[r+"th"]=n}));const s=[[1e3,"m"],[900,"cm"],[500,"d"],[400,"cd"],[100,"c"],[90,"xc"],[50,"l"],[40,"xl"],[10,"x"],[9,"ix"],[5,"v"],[4,"iv"],[1,"i"]],c={M:1e3,D:500,C:100,L:50,X:10,V:5,I:1};function u(e){for(var t=0;t<s.length;t++){const r=s[t];if(e>=r[0])return r[1]+u(e-r[0])}return""}function l(e,t){if(void 0!==e)return d(e=Math.floor(e),v(t))}const p={DECIMAL:"decimal",LETTERS:"letters",ROMAN:"roman",WORDS:"words",SEQUENCE:"sequence"},f={UPPER:"upper",LOWER:"lower",TITLE:"title"};function d(n,o){let s;const c=n<0;switch(n=Math.abs(n),o.primary){case p.LETTERS:s=function(e,t){for(var r=[],n=t.charCodeAt(0);e>0;)r.unshift(String.fromCharCode((e-1)%26+n)),e=Math.floor((e-1)/26);return r.join("")}(n,o.case===f.UPPER?"A":"a");break;case p.ROMAN:s=u(n),o.case===f.UPPER&&(s=s.toUpperCase());break;case p.WORDS:s=function(e,n){var o=function(e,n,s){var c="";if(e<=19)c=(n?" and ":"")+(s?r[e]:t[e]);else if(e<100){const t=Math.floor(e/10),r=e%10;c=(n?" and ":"")+a[t-2],r>0?c+="-"+o(r,!1,s):s&&(c=c.substring(0,c.length-1)+"ieth")}else if(e<1e3){const r=Math.floor(e/100),a=e%100;c=(n?", ":"")+t[r]+" Hundred",a>0?c+=o(a,!0,s):s&&(c+="th")}else{var u=Math.floor(Math.log10(e)/3);u>i.length&&(u=i.length);const t=Math.pow(10,3*u),r=Math.floor(e/t),a=e-r*t;c=(n?", ":"")+o(r,!1,!1)+" "+i[u-1],a>0?c+=o(a,!0,s):s&&(c+="th")}return c};return o(e,!1,n)}(n,o.ordinal),o.case===f.UPPER?s=s.toUpperCase():o.case===f.LOWER&&(s=s.toLowerCase());break;case p.DECIMAL:s=""+n;var l=o.mandatoryDigits-s.length;if(l>0){var d=new Array(l+1).join("0");s=d+s}if(48!==o.zeroCode&&(s=e(s).map((e=>String.fromCodePoint(e.codePointAt(0)+o.zeroCode-48))).join("")),o.regular)for(let e=Math.floor((s.length-1)/o.groupingSeparators.position);e>0;e--){const t=s.length-e*o.groupingSeparators.position;s=s.substr(0,t)+o.groupingSeparators.character+s.substr(t)}else o.groupingSeparators.reverse().forEach((e=>{const t=s.length-e.position;s=s.substr(0,t)+e.character+s.substr(t)}));if(o.ordinal){var h={1:"st",2:"nd",3:"rd"}[s[s.length-1]];(!h||s.length>1&&"1"===s[s.length-2])&&(h="th"),s+=h}break;case p.SEQUENCE:throw{code:"D3130",value:o.token}}return c&&(s="-"+s),s}const h=[48,1632,1776,1984,2406,2534,2662,2790,2918,3046,3174,3302,3430,3558,3664,3792,3872,4160,4240,6112,6160,6470,6608,6784,6800,6992,7088,7232,7248,42528,43216,43264,43472,43504,43600,44016,65296];function v(t){const r={type:"integer",primary:p.DECIMAL,case:f.LOWER,ordinal:!1};let n,a;const i=t.lastIndexOf(";");switch(-1===i?n=t:(n=t.substring(0,i),a=t.substring(i+1),"o"===a[0]&&(r.ordinal=!0)),n){case"A":r.case=f.UPPER;case"a":r.primary=p.LETTERS;break;case"I":r.case=f.UPPER;case"i":r.primary=p.ROMAN;break;case"W":r.case=f.UPPER,r.primary=p.WORDS;break;case"Ww":r.case=f.TITLE,r.primary=p.WORDS;break;case"w":r.primary=p.WORDS;break;default:{let t=null,a=0,i=0,o=[],s=0;if(e(n).map((e=>e.codePointAt(0))).reverse().forEach((e=>{let r=!1;for(let n=0;n<h.length;n++){const i=h[n];if(e>=i&&e<=i+9){if(r=!0,a++,s++,null===t)t=i;else if(i!==t)throw{code:"D3131"};break}}r||(35===e?(s++,i++):o.push({position:s,character:String.fromCodePoint(e)}))})),a>0){r.primary=p.DECIMAL,r.zeroCode=t,r.mandatoryDigits=a,r.optionalDigits=i;const e=function(e){if(0===e.length)return 0;const t=e[0].character;for(let r=1;r<e.length;r++)if(e[r].character!==t)return 0;const r=e.map((e=>e.position)),n=function(e,t){return 0===t?e:n(t,e%t)},a=r.reduce(n);for(let e=1;e<=r.length;e++)if(-1===r.indexOf(e*a))return 0;return a}(o);e>0?(r.regular=!0,r.groupingSeparators={position:e,character:o[0].character}):(r.regular=!1,r.groupingSeparators=o)}else r.primary=p.SEQUENCE,r.token=n}}return r}const m={Y:"1",M:"1",D:"1",d:"1",F:"n",W:"1",w:"1",X:"1",x:"1",H:"1",h:"1",P:"n",m:"01",s:"01",f:"1",Z:"01:01",z:"01:01",C:"n",E:"n"};function g(e){var t=[];const r={type:"datetime",parts:t},n=function(r,n){if(n>r){let a=e.substring(r,n);a=a.split("]]").join("]"),t.push({type:"literal",value:a})}};for(var a=0,i=0;i<e.length;){if("["===e.charAt(i)){if("["===e.charAt(i+1)){n(a,i),t.push({type:"literal",value:"["}),a=i+=2;continue}if(n(a,i),a=i,-1===(i=e.indexOf("]",a)))throw{code:"D3135"};let r=e.substring(a+1,i);r=r.split(/\s+/).join("");var o,s={type:"marker",component:r.charAt(0)},c=r.lastIndexOf(",");if(-1!==c){const e=r.substring(c+1),t=e.indexOf("-");let n,a;const i=function(e){return void 0===e||"*"===e?void 0:parseInt(e)};-1===t?n=e:(n=e.substring(0,t),a=e.substring(t+1));const u={min:i(n),max:i(a)};s.width=u,o=r.substring(1,c)}else o=r.substring(1);if(1===o.length)s.presentation1=o;else if(o.length>1){var u=o.charAt(o.length-1);-1!=="atco".indexOf(u)?(s.presentation2=u,"o"===u&&(s.ordinal=!0),s.presentation1=o.substring(0,o.length-1)):s.presentation1=o}else s.presentation1=m[s.component];if(void 0===s.presentation1)throw{code:"D3132",value:s.component};if("n"===s.presentation1[0])s.names=f.LOWER;else if("N"===s.presentation1[0])"n"===s.presentation1[1]?s.names=f.TITLE:s.names=f.UPPER;else if(-1!=="YMDdFWwXxHhmsf".indexOf(s.component)){var l=s.presentation1;if(s.presentation2&&(l+=";"+s.presentation2),s.integerFormat=v(l),s.width&&void 0!==s.width.min&&s.integerFormat.mandatoryDigits<s.width.min&&(s.integerFormat.mandatoryDigits=s.width.min),-1!=="YMD".indexOf(s.component))if(s.n=-1,s.width&&void 0!==s.width.max)s.n=s.width.max,s.integerFormat.mandatoryDigits=s.n;else{var p=s.integerFormat.mandatoryDigits+s.integerFormat.optionalDigits;p>=2&&(s.n=p)}}"Z"!==s.component&&"z"!==s.component||(s.integerFormat=v(s.presentation1)),t.push(s),a=i+1}i++}return n(a,i),r}const b=["","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],y=["January","February","March","April","May","June","July","August","September","October","November","December"],w=864e5,x=function(e){const t=Date.UTC(e.year,e.month);var r=new Date(t).getUTCDay();return 0===r&&(r=7),r>4?t+(8-r)*w:t-(r-1)*w},k=function(e,t){return{year:e,month:t,nextMonth:function(){return 11===t?k(e+1,0):k(e,t+1)},previousMonth:function(){return 0===t?k(e-1,11):k(e,t-1)},nextYear:function(){return k(e+1,t)},previousYear:function(){return k(e-1,t)}}},E=function(e,t){return(t-e)/6048e5+1},T=(e,t)=>{let r;switch(t){case"Y":r=e.getUTCFullYear();break;case"M":r=e.getUTCMonth()+1;break;case"D":r=e.getUTCDate();break;case"d":r=(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())-Date.UTC(e.getUTCFullYear(),0))/w+1;break;case"F":r=e.getUTCDay(),0===r&&(r=7);break;case"W":{const t=k(e.getUTCFullYear(),0),n=x(t),a=Date.UTC(t.year,e.getUTCMonth(),e.getUTCDate());let i=E(n,a);if(i>52)a>=x(t.nextYear())&&(i=1);else if(i<1){const e=x(t.previousYear());i=E(e,a)}r=Math.floor(i);break}case"w":{const t=k(e.getUTCFullYear(),e.getUTCMonth()),n=x(t),a=Date.UTC(t.year,t.month,e.getUTCDate());let i=E(n,a);if(i>4)a>=x(t.nextMonth())&&(i=1);else if(i<1){const e=x(t.previousMonth());i=E(e,a)}r=Math.floor(i);break}case"X":{const t=k(e.getUTCFullYear(),0),n=x(t),a=x(t.nextYear()),i=e.getTime();r=i<n?t.year-1:i>=a?t.year+1:t.year;break}case"x":{const t=k(e.getUTCFullYear(),e.getUTCMonth()),n=x(t),a=t.nextMonth(),i=x(a),o=e.getTime();r=o<n?t.previousMonth().month+1:o>=i?a.month+1:t.month+1;break}case"H":r=e.getUTCHours();break;case"h":r=e.getUTCHours(),r%=12,0===r&&(r=12);break;case"P":r=e.getUTCHours()>=12?"pm":"am";break;case"m":r=e.getUTCMinutes();break;case"s":r=e.getUTCSeconds();break;case"f":r=e.getUTCMilliseconds();break;case"Z":case"z":break;case"C":case"E":r="ISO"}return r};let A=null;function D(e,t,r){var n=0,a=0;if(void 0!==r){const e=parseInt(r);n=Math.floor(e/100),a=e%100}let i;void 0===t?(null===A&&(A=g("[Y0001]-[M01]-[D01]T[H01]:[m01]:[s01].[f001][Z01:01t]")),i=A):i=g(t);const o=new Date(e+60*(60*n+a)*1e3);let s="";return i.parts.forEach((function(e){"literal"===e.type?s+=e.value:s+=function(e,t){var r=T(e,t.component);if(-1!=="YMDdFWwXxHhms".indexOf(t.component))if("Y"===t.component&&-1!==t.n&&(r%=Math.pow(10,t.n)),t.names){if("M"===t.component||"x"===t.component)r=y[r-1];else{if("F"!==t.component)throw{code:"D3133",value:t.component};r=b[r]}t.names===f.UPPER?r=r.toUpperCase():t.names===f.LOWER&&(r=r.toLowerCase()),t.width&&r.length>t.width.max&&(r=r.substring(0,t.width.max))}else r=d(r,t.integerFormat);else if("f"===t.component)r=d(r,t.integerFormat);else if("Z"===t.component||"z"===t.component){const e=100*n+a;if(t.integerFormat.regular)r=d(e,t.integerFormat);else{const i=t.integerFormat.mandatoryDigits;if(1===i||2===i)r=d(n,t.integerFormat),0!==a&&(r+=":"+l(a,"00"));else{if(3!==i&&4!==i)throw{code:"D3134",value:i};r=d(e,t.integerFormat)}}e>=0&&(r="+"+r),"z"===t.component&&(r="GMT"+r),0===e&&"t"===t.presentation2&&(r="Z")}return r}(o,e)})),s}function S(e){var t={};if("datetime"===e.type)t.type="datetime",t.parts=e.parts.map((function(e){var t={};if("literal"===e.type)t.regex=e.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");else if("Z"===e.component||"z"===e.component){let r;Array.isArray(e.integerFormat.groupingSeparators)||(r=e.integerFormat.groupingSeparators),t.regex="","z"===e.component&&(t.regex="GMT"),t.regex+="[-+][0-9]+",r&&(t.regex+=r.character+"[0-9]+"),t.parse=function(t){"z"===e.component&&(t=t.substring(3));let n=0,a=0;return r?(n=Number.parseInt(t.substring(0,t.indexOf(r.character))),a=Number.parseInt(t.substring(t.indexOf(r.character)+1))):t.length-1<=2?n=Number.parseInt(t):(n=Number.parseInt(t.substring(0,3)),a=Number.parseInt(t.substring(3))),60*n+a}}else if(e.integerFormat)e.integerFormat.n=e.n,t=S(e.integerFormat);else{t.regex="[a-zA-Z]+";var r={};if("M"===e.component||"x"===e.component)y.forEach((function(t,n){e.width&&e.width.max?r[t.substring(0,e.width.max)]=n+1:r[t]=n+1}));else if("F"===e.component)b.forEach((function(t,n){n>0&&(e.width&&e.width.max?r[t.substring(0,e.width.max)]=n:r[t]=n)}));else{if("P"!==e.component)throw{code:"D3133",value:e.component};r={am:0,AM:0,pm:1,PM:1}}t.parse=function(e){return r[e]}}return t.component=e.component,t}));else{t.type="integer";const r=e.case===f.UPPER;let n;switch(n=e.n&&e.n>0?0===e.optionalDigits?`{${e.n}}`:`{${e.n-e.optionalDigits},${e.n}}`:"+",e.primary){case p.LETTERS:t.regex=r?"[A-Z]+":"[a-z]+",t.parse=function(e){return function(e,t){for(var r=t.charCodeAt(0),n=0,a=0;a<e.length;a++)n+=(e.charCodeAt(e.length-a-1)-r+1)*Math.pow(26,a);return n}(e,r?"A":"a")};break;case p.ROMAN:t.regex=r?"[MDCLXVI]+":"[mdclxvi]+",t.parse=function(e){return function(e){for(var t=0,r=1,n=e.length-1;n>=0;n--){const a=e[n],i=c[a];i<r?t-=i:(r=i,t+=i)}return t}(r?e:e.toUpperCase())};break;case p.WORDS:t.regex="(?:"+Object.keys(o).concat("and","[\\-, ]").join("|")+")+",t.parse=function(e){return function(e){const t=e.split(/,\s|\sand\s|[\s\\-]/).map((e=>o[e]));let r=[0];return t.forEach((e=>{if(e<100){let t=r.pop();t>=1e3&&(r.push(t),t=0),r.push(t+e)}else r.push(r.pop()*e)})),r.reduce(((e,t)=>e+t),0)}(e.toLowerCase())};break;case p.DECIMAL:t.regex=`[0-9]${n}`,e.ordinal&&(t.regex+="(?:th|st|nd|rd)"),t.parse=function(t){let r=t;return e.ordinal&&(r=t.substring(0,t.length-2)),e.regular?r=r.split(",").join(""):e.groupingSeparators.forEach((e=>{r=r.split(e.character).join("")})),48!==e.zeroCode&&(r=r.split("").map((t=>String.fromCodePoint(t.codePointAt(0)-e.zeroCode+48))).join("")),parseInt(r)};break;case p.SEQUENCE:throw{code:"D3130",value:e.token}}}return t}function O(e,t){const r=S(g(t)),n="^"+r.parts.map((e=>"("+e.regex+")")).join("")+"$";var a=new RegExp(n,"i").exec(e);if(null!==a){const e=161,t=130,n=84,o=72,s=23,c=47,u={};for(let e=1;e<a.length;e++){const t=r.parts[e-1];t.parse&&(u[t.component]=t.parse(a[e]))}if(0===Object.getOwnPropertyNames(u).length)return;let l=0;const p=e=>{l<<=1,l+=e?1:0},f=e=>!(~e&l||!(e&l));"YXMxWwdD".split("").forEach((e=>p(u[e])));const d=!f(e)&&f(t),h=f(n),v=!h&&f(o);l=0,"PHhmsf".split("").forEach((e=>p(u[e])));const m=!f(s)&&f(c),g=(d?"YD":h?"XxwF":v?"XWF":"YMD")+(m?"Phmsf":"Hmsf"),b=this.environment.timestamp;let y=!1,w=!1;if(g.split("").forEach((e=>{if(void 0===u[e])y?(u[e]=-1!=="MDd".indexOf(e)?1:0,w=!0):u[e]=T(b,e);else if(y=!0,w)throw{code:"D3136"}})),u.M>0?u.M-=1:u.M=0,d){const e=Date.UTC(u.Y,0),t=1e3*(u.d-1)*60*60*24,r=new Date(e+t);u.M=r.getUTCMonth(),u.D=r.getUTCDate()}if(h)throw{code:"D3136"};if(v)throw{code:"D3136"};m&&(u.H=12===u.h?0:u.h,1===u.P&&(u.H+=12));var i=Date.UTC(u.Y,u.M,u.D,u.H,u.m,u.s,u.f);return(u.Z||u.z)&&(i-=60*(u.Z||u.z)*1e3),i}}var C=new RegExp("^\\d{4}(-[01]\\d)*(-[0-3]\\d)*(T[0-2]\\d:[0-5]\\d:[0-5]\\d)*(\\.\\d+)?([+-][0-2]\\d:?[0-5]\\d|Z)?$");return{formatInteger:l,parseInteger:function(e,t){if(void 0!==e)return S(v(t)).parse(e)},fromMillis:function(e,t,r){if(void 0!==e)return D.call(this,e,t,r)},toMillis:function(e,t){if(void 0!==e){if(void 0===t){if(!C.test(e))throw{stack:(new Error).stack,code:"D3110",value:e};return Date.parse(e)}return O.call(this,e,t)}}}}();t.exports=a},{"./utils":6}],2:[function(e,t,n){(function(r){(function(){var n=e("./utils");const a=(()=>{"use strict";var e=n.isNumeric,t=n.isArrayOfStrings,a=n.isArrayOfNumbers,i=n.createSequence,o=n.isSequence,s=n.isFunction,c=n.isLambda,u=n.isPromise,l=n.getFunctionArity,p=n.isDeepEqual,f=n.stringToArray;function d(e,t,r){if(void 0!==e){var n=f(e),a=n.length;if(a+t<0&&(t=0),void 0!==r){if(r<=0)return"";var i=t>=0?t+r:a+t+r;return n.slice(t,i).join("")}return n.slice(t).join("")}}function h(e){if(void 0!==e)return f(e).length}async function v(e,t){var r=e.apply(this,[t]);if(u(r)&&(r=await r),r&&"number"!=typeof r.start&&"number"!==r.end&&!Array.isArray(r.groups)&&!s(r.next))throw{code:"T1010",stack:(new Error).stack};return r}function m(e,t){var r;if(void 0!==e){if(t){var n=e.toString().split("e");e=+(n[0]+"e"+(n[1]?+n[1]+t:t))}var a=(r=Math.round(e))-e;return.5===Math.abs(a)&&1===Math.abs(r%2)&&(r-=1),t&&(n=r.toString().split("e"),r=+(n[0]+"e"+(n[1]?+n[1]-t:-t))),Object.is(r,-0)&&(r=0),r}}function g(t){if(void 0!==t){var r=!1;return Array.isArray(t)?1===t.length?r=g(t[0]):t.length>1&&(r=t.filter((function(e){return g(e)})).length>0):"string"==typeof t?t.length>0&&(r=!0):e(t)?0!==t&&(r=!0):null!==t&&"object"==typeof t?Object.keys(t).length>0&&(r=!0):"boolean"==typeof t&&!0===t&&(r=!0),r}}function b(e,t,r,n){var a=[t],i=l(e);return i>=2&&a.push(r),i>=3&&a.push(n),a}function y(e,t){return void 0===e?t:void 0===t?e:(Array.isArray(e)||(e=i(e)),Array.isArray(t)||(t=[t]),e.concat(t))}return{sum:function(e){if(void 0!==e){var t=0;return e.forEach((function(e){t+=e})),t}},count:function(e){return void 0===e?0:e.length},max:function(e){if(void 0!==e&&0!==e.length)return Math.max.apply(Math,e)},min:function(e){if(void 0!==e&&0!==e.length)return Math.min.apply(Math,e)},average:function(e){if(void 0!==e&&0!==e.length){var t=0;return e.forEach((function(e){t+=e})),t/e.length}},string:function(t,r=!1){if(void 0!==t){var n;if("string"==typeof t)n=t;else if(s(t))n="";else{if("number"==typeof t&&!isFinite(t))throw{code:"D3001",value:t,stack:(new Error).stack};var a=r?2:0;Array.isArray(t)&&t.outerWrapper&&(t=t[0]),n=JSON.stringify(t,(function(t,r){return null!=r&&r.toPrecision&&e(r)?Number(r.toPrecision(15)):r&&s(r)?"":r}),a)}return n}},substring:d,substringBefore:function(e,t){if(void 0!==e){var r=e.indexOf(t);return r>-1?e.substr(0,r):e}},substringAfter:function(e,t){if(void 0!==e){var r=e.indexOf(t);return r>-1?e.substr(r+t.length):e}},lowercase:function(e){if(void 0!==e)return e.toLowerCase()},uppercase:function(e){if(void 0!==e)return e.toUpperCase()},length:h,trim:function(e){if(void 0!==e){var t=e.replace(/[ \t\n\r]+/gm," ");return" "===t.charAt(0)&&(t=t.substring(1))," "===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),t}},pad:function(e,t,r){if(void 0!==e){var n;void 0!==r&&0!==r.length||(r=" ");var a=Math.abs(t)-h(e);if(a>0){var i=new Array(a+1).join(r);r.length>1&&(i=d(i,0,a)),n=t>0?e+i:i+e}else n=e;return n}},match:async function(e,t,r){if(void 0!==e){if(r<0)throw{stack:(new Error).stack,value:r,code:"D3040",index:3};var n=i();if(void 0===r||r>0){var a=0,o=await v(t,e);if(void 0!==o)for(;void 0!==o&&(void 0===r||a<r);)n.push({match:o.match,index:o.start,groups:o.groups}),o=await v(o.next),a++}return n}},contains:async function(e,t){if(void 0!==e)return"string"==typeof t?-1!==e.indexOf(t):void 0!==await v(t,e)},replace:async function(e,t,r,n){if(void 0!==e){var a;if(""===t)throw{code:"D3010",stack:(new Error).stack,value:t,index:2};if(n<0)throw{code:"D3011",stack:(new Error).stack,value:n,index:4};a="string"==typeof r?function(e){for(var t="",n=0,a=r.indexOf("$",n);-1!==a&&n<r.length;){t+=r.substring(n,a),n=a+1;var i=r.charAt(n);if("$"===i)t+="$",n++;else if("0"===i)t+=e.match,n++;else{var o;if(o=0===e.groups.length?1:Math.floor(Math.log(e.groups.length)*Math.LOG10E)+1,a=parseInt(r.substring(n,n+o),10),o>1&&a>e.groups.length&&(a=parseInt(r.substring(n,n+o-1),10)),isNaN(a))t+="$";else{if(e.groups.length>0){var s=e.groups[a-1];void 0!==s&&(t+=s)}n+=a.toString().length}}a=r.indexOf("$",n)}return t+r.substring(n)}:r;var i="",o=0;if(void 0===n||n>0){var s=0;if("string"==typeof t){for(var c=e.indexOf(t,o);-1!==c&&(void 0===n||s<n);)i+=e.substring(o,c),i+=r,o=c+t.length,s++,c=e.indexOf(t,o);i+=e.substring(o)}else{var l=await v(t,e);if(void 0!==l){for(;void 0!==l&&(void 0===n||s<n);){i+=e.substring(o,l.start);var p=a.apply(this,[l]);if(u(p)&&(p=await p),"string"!=typeof p)throw{code:"D3012",stack:(new Error).stack,value:p};i+=p,o=l.start+l.match.length,s++,l=await v(l.next)}i+=e.substring(o)}else i=e}}else i=e;return i}},split:async function(e,t,r){if(void 0!==e){if(r<0)throw{code:"D3020",stack:(new Error).stack,value:r,index:3};var n=[];if(void 0===r||r>0)if("string"==typeof t)n=e.split(t,r);else{var a=0,i=await v(t,e);if(void 0!==i){for(var o=0;void 0!==i&&(void 0===r||a<r);)n.push(e.substring(o,i.start)),o=i.end,i=await v(i.next),a++;(void 0===r||a<r)&&n.push(e.substring(o))}else n.push(e)}return n}},join:function(e,t){if(void 0!==e)return void 0===t&&(t=""),e.join(t)},formatNumber:function(e,t,r){if(void 0!==e){var n={"decimal-separator":".","grouping-separator":",","exponent-separator":"e",infinity:"Infinity","minus-sign":"-",NaN:"NaN",percent:"%","per-mille":"‰","zero-digit":"0",digit:"#","pattern-separator":";"};void 0!==r&&Object.keys(r).forEach((function(e){n[e]=r[e]}));for(var a=[],i=n["zero-digit"].charCodeAt(0),o=i;o<i+10;o++)a.push(String.fromCharCode(o));var s=a.concat([n["decimal-separator"],n["exponent-separator"],n["grouping-separator"],n.digit,n["pattern-separator"]]),c=t.split(n["pattern-separator"]);if(c.length>2)throw{code:"D3080",stack:(new Error).stack};var u=c.map((function(e){var t,r,a,i,o=function(){for(var t,r=0;r<e.length;r++)if(t=e.charAt(r),-1!==s.indexOf(t)&&t!==n["exponent-separator"])return e.substring(0,r)}(),c=function(){for(var t,r=e.length-1;r>=0;r--)if(t=e.charAt(r),-1!==s.indexOf(t)&&t!==n["exponent-separator"])return e.substring(r+1)}(),u=e.substring(o.length,e.length-c.length),l=e.indexOf(n["exponent-separator"],o.length);-1===l||l>e.length-c.length?(t=u,r=void 0):(t=u.substring(0,l),r=u.substring(l+1));var p=t.indexOf(n["decimal-separator"]);return-1===p?(a=t,i=c):(a=t.substring(0,p),i=t.substring(p+1)),{prefix:o,suffix:c,activePart:u,mantissaPart:t,exponentPart:r,integerPart:a,fractionalPart:i,subpicture:e}}));u.forEach((function(e){var t,r,i=e.subpicture,o=i.indexOf(n["decimal-separator"]);o!==i.lastIndexOf(n["decimal-separator"])&&(t="D3081"),i.indexOf(n.percent)!==i.lastIndexOf(n.percent)&&(t="D3082"),i.indexOf(n["per-mille"])!==i.lastIndexOf(n["per-mille"])&&(t="D3083"),-1!==i.indexOf(n.percent)&&-1!==i.indexOf(n["per-mille"])&&(t="D3084");var c=!1;for(r=0;r<e.mantissaPart.length;r++){var u=e.mantissaPart.charAt(r);if(-1!==a.indexOf(u)||u===n.digit){c=!0;break}}c||(t="D3085"),-1!==e.activePart.split("").map((function(e){return-1===s.indexOf(e)?"p":"a"})).join("").indexOf("p")&&(t="D3086"),-1!==o?i.charAt(o-1)!==n["grouping-separator"]&&i.charAt(o+1)!==n["grouping-separator"]||(t="D3087"):e.integerPart.charAt(e.integerPart.length-1)===n["grouping-separator"]&&(t="D3088"),-1!==i.indexOf(n["grouping-separator"]+n["grouping-separator"])&&(t="D3089");var l=e.integerPart.indexOf(n.digit);-1!==l&&e.integerPart.substring(0,l).split("").filter((function(e){return a.indexOf(e)>-1})).length>0&&(t="D3090"),-1!==(l=e.fractionalPart.lastIndexOf(n.digit))&&e.fractionalPart.substring(l).split("").filter((function(e){return a.indexOf(e)>-1})).length>0&&(t="D3091");var p="string"==typeof e.exponentPart;if(p&&e.exponentPart.length>0&&(-1!==i.indexOf(n.percent)||-1!==i.indexOf(n["per-mille"]))&&(t="D3092"),p&&(0===e.exponentPart.length||e.exponentPart.split("").filter((function(e){return-1===a.indexOf(e)})).length>0)&&(t="D3093"),t)throw{code:t,stack:(new Error).stack}}));var l,p,f,d,h=u.map((function(e){var t=function(t,r){for(var i=[],o=t.indexOf(n["grouping-separator"]);-1!==o;){var s=(r?t.substring(0,o):t.substring(o)).split("").filter((function(e){return-1!==a.indexOf(e)||e===n.digit})).length;i.push(s),o=e.integerPart.indexOf(n["grouping-separator"],o+1)}return i},r=t(e.integerPart),i=function(e){if(0===e.length)return 0;for(var t=function(e,r){return 0===r?e:t(r,e%r)},r=e.reduce(t),n=1;n<=e.length;n++)if(-1===e.indexOf(n*r))return 0;return r}(r),o=t(e.fractionalPart,!0),s=e.integerPart.split("").filter((function(e){return-1!==a.indexOf(e)})).length,c=s,u=e.fractionalPart.split(""),l=u.filter((function(e){return-1!==a.indexOf(e)})).length,p=u.filter((function(e){return-1!==a.indexOf(e)||e===n.digit})).length,f="string"==typeof e.exponentPart;0===s&&0===p&&(f?(l=1,p=1):s=1),f&&0===s&&-1!==e.integerPart.indexOf(n.digit)&&(s=1),0===s&&0===l&&(l=1);var d=0;return f&&(d=e.exponentPart.split("").filter((function(e){return-1!==a.indexOf(e)})).length),{integerPartGroupingPositions:r,regularGrouping:i,minimumIntegerPartSize:s,scalingFactor:c,prefix:e.prefix,fractionalPartGroupingPositions:o,minimumFactionalPartSize:l,maximumFactionalPartSize:p,minimumExponentSize:d,suffix:e.suffix,picture:e.subpicture}})),v=n["minus-sign"],g=n["zero-digit"],b=n["decimal-separator"],y=n["grouping-separator"];if(1===h.length&&(h.push(JSON.parse(JSON.stringify(h[0]))),h[1].prefix=v+h[1].prefix),p=-1!==(l=e>=0?h[0]:h[1]).picture.indexOf(n.percent)?100*e:-1!==l.picture.indexOf(n["per-mille"])?1e3*e:e,0===l.minimumExponentSize)f=p;else{var w=Math.pow(10,l.scalingFactor),x=Math.pow(10,l.scalingFactor-1);for(f=p,d=0;f<x;)f*=10,d-=1;for(;f>w;)f/=10,d+=1}var k=function(e,t){var r=Math.abs(e).toFixed(t);return"0"!==g&&(r=r.split("").map((function(e){return e>="0"&&e<="9"?a[e.charCodeAt(0)-48]:e})).join("")),r},E=k(m(f,l.maximumFactionalPartSize),l.maximumFactionalPartSize),T=E.indexOf(".");for(-1===T?E+=b:E=E.replace(".",b);E.charAt(0)===g;)E=E.substring(1);for(;E.charAt(E.length-1)===g;)E=E.substring(0,E.length-1);T=E.indexOf(b);var A=l.minimumIntegerPartSize-T,D=l.minimumFactionalPartSize-(E.length-T-1);if(E=(A>0?new Array(A+1).join(g):"")+E,E+=D>0?new Array(D+1).join(g):"",T=E.indexOf(b),l.regularGrouping>0)for(var S=Math.floor((T-1)/l.regularGrouping),O=1;O<=S;O++)E=[E.slice(0,T-O*l.regularGrouping),y,E.slice(T-O*l.regularGrouping)].join("");else l.integerPartGroupingPositions.forEach((function(e){E=[E.slice(0,T-e),y,E.slice(T-e)].join(""),T++}));if(T=E.indexOf(b),l.fractionalPartGroupingPositions.forEach((function(e){E=[E.slice(0,e+T+1),y,E.slice(e+T+1)].join("")})),T=E.indexOf(b),-1!==l.picture.indexOf(b)&&T!==E.length-1||(E=E.substring(0,E.length-1)),void 0!==d){var C=k(d,0);(A=l.minimumExponentSize-C.length)>0&&(C=new Array(A+1).join(g)+C),E=E+n["exponent-separator"]+(d<0?v:"")+C}return E=l.prefix+E+l.suffix}},formatBase:function(e,t){if(void 0!==e){if(e=m(e),(t=void 0===t?10:m(t))<2||t>36)throw{code:"D3100",stack:(new Error).stack,value:t};return e.toString(t)}},number:function(e){var t;if(void 0!==e){if("number"==typeof e)t=e;else if("string"==typeof e&&/^-?[0-9]+(\.[0-9]+)?([Ee][-+]?[0-9]+)?$/.test(e)&&!isNaN(parseFloat(e))&&isFinite(e))t=parseFloat(e);else if("string"==typeof e&&/^(0[xX][0-9A-Fa-f]+)|(0[oO][0-7]+)|(0[bB][0-1]+)$/.test(e))t=Number(e);else if(!0===e)t=1;else{if(!1!==e)throw{code:"D3030",value:e,stack:(new Error).stack,index:1};t=0}return t}},floor:function(e){if(void 0!==e)return Math.floor(e)},ceil:function(e){if(void 0!==e)return Math.ceil(e)},round:m,abs:function(e){if(void 0!==e)return Math.abs(e)},sqrt:function(e){if(void 0!==e){if(e<0)throw{stack:(new Error).stack,code:"D3060",index:1,value:e};return Math.sqrt(e)}},power:function(e,t){var r;if(void 0!==e){if(r=Math.pow(e,t),!isFinite(r))throw{stack:(new Error).stack,code:"D3061",index:1,value:e,exp:t};return r}},random:function(){return Math.random()},boolean:g,not:function(e){if(void 0!==e)return!g(e)},map:async function(e,t){if(void 0!==e){for(var r=i(),n=0;n<e.length;n++){var a=b(t,e[n],n,e),o=await t.apply(this,a);void 0!==o&&r.push(o)}return r}},zip:function(){for(var e=[],t=Array.prototype.slice.call(arguments),r=Math.min.apply(Math,t.map((function(e){return Array.isArray(e)?e.length:0}))),n=0;n<r;n++){var a=t.map((e=>e[n]));e.push(a)}return e},filter:async function(e,t){if(void 0!==e){for(var r=i(),n=0;n<e.length;n++){var a=e[n],o=b(t,a,n,e);g(await t.apply(this,o))&&r.push(a)}return r}},single:async function(e,t){if(void 0!==e){for(var r,n=!1,a=0;a<e.length;a++){var i=e[a],o=!0;if(void 0!==t){var s=b(t,i,a,e);o=g(await t.apply(this,s))}if(o){if(n)throw{stack:(new Error).stack,code:"D3138",index:a};r=i,n=!0}}if(!n)throw{stack:(new Error).stack,code:"D3139"};return r}},foldLeft:async function(e,t,r){if(void 0!==e){var n,a,i=l(t);if(i<2)throw{stack:(new Error).stack,code:"D3050",index:1};for(void 0===r&&e.length>0?(n=e[0],a=1):(n=r,a=0);a<e.length;){var o=[n,e[a]];i>=3&&o.push(a),i>=4&&o.push(e),n=await t.apply(this,o),a++}return n}},sift:async function(e,t){var r={};for(var n in e){var a=e[n],i=b(t,a,n,e);g(await t.apply(this,i))&&(r[n]=a)}return 0===Object.keys(r).length&&(r=void 0),r},keys:function e(t){var r=i();if(Array.isArray(t)){var n={};t.forEach((function(t){e(t).forEach((function(e){n[e]=!0}))})),r=e(n)}else null===t||"object"!=typeof t||c(t)||Object.keys(t).forEach((e=>r.push(e)));return r},lookup:function e(t,r){var n;if(Array.isArray(t)){n=i();for(var a=0;a<t.length;a++){var o=e(t[a],r);void 0!==o&&(Array.isArray(o)?o.forEach((e=>n.push(e))):n.push(o))}}else null!==t&&"object"==typeof t&&(n=t[r]);return n},append:y,exists:function(e){return void 0!==e},spread:function e(t){var r=i();if(Array.isArray(t))t.forEach((function(t){r=y(r,e(t))}));else if(null===t||"object"!=typeof t||c(t))r=t;else for(var n in t){var a={};a[n]=t[n],r.push(a)}return r},merge:function(e){if(void 0!==e){var t={};return e.forEach((function(e){for(var r in e)t[r]=e[r]})),t}},reverse:function(e){if(void 0!==e){if(e.length<=1)return e;for(var t=e.length,r=new Array(t),n=0;n<t;n++)r[t-n-1]=e[n];return r}},each:async function(e,t){var r=i();for(var n in e){var a=b(t,e[n],n,e),o=await t.apply(this,a);void 0!==o&&r.push(o)}return r},error:function(e){throw{code:"D3137",stack:(new Error).stack,message:e||"$error() function evaluated"}},assert:function(e,t){if(!e)throw{code:"D3141",stack:(new Error).stack,message:t||"$assert() statement failed"}},type:function(t){if(void 0!==t)return null===t?"null":e(t)?"number":"string"==typeof t?"string":"boolean"==typeof t?"boolean":Array.isArray(t)?"array":s(t)?"function":"object"},sort:async function(e,r){if(void 0!==e){if(e.length<=1)return e;var n;if(void 0===r){if(!a(e)&&!t(e))throw{stack:(new Error).stack,code:"D3070",index:1};n=async function(e,t){return e>t}}else n=r;var i=async function(e){if(!Array.isArray(e)||e.length<=1)return e;var t=Math.floor(e.length/2),r=e.slice(0,t),a=e.slice(t);return r=await i(r),a=await i(a),await async function(e,t){var r=async function(e,t,a){0===t.length?Array.prototype.push.apply(e,a):0===a.length?Array.prototype.push.apply(e,t):await n(t[0],a[0])?(e.push(a[0]),await r(e,t,a.slice(1))):(e.push(t[0]),await r(e,t.slice(1),a))},a=[];return await r(a,e,t),a}(r,a)};return await i(e)}},shuffle:function(e){if(void 0!==e){if(e.length<=1)return e;for(var t=new Array(e.length),r=0;r<e.length;r++){var n=Math.floor(Math.random()*(r+1));r!==n&&(t[r]=t[n]),t[n]=e[r]}return t}},distinct:function(e){if(void 0!==e){if(!Array.isArray(e)||e.length<=1)return e;for(var t=o(e)?i():[],r=0;r<e.length;r++){for(var n=e[r],a=!1,s=0;s<t.length;s++)if(p(n,t[s])){a=!0;break}a||t.push(n)}return t}},base64encode:function(e){if(void 0!==e){var t="undefined"!=typeof window?window.btoa:function(e){return new r.Buffer.from(e,"binary").toString("base64")};return t(e)}},base64decode:function(e){if(void 0!==e){var t="undefined"!=typeof window?window.atob:function(e){return new r.Buffer.from(e,"base64").toString("binary")};return t(e)}},encodeUrlComponent:function(e){if(void 0!==e){var t;try{t=encodeURIComponent(e)}catch(t){throw{code:"D3140",stack:(new Error).stack,value:e,functionName:"encodeUrlComponent"}}return t}},encodeUrl:function(e){if(void 0!==e){var t;try{t=encodeURI(e)}catch(t){throw{code:"D3140",stack:(new Error).stack,value:e,functionName:"encodeUrl"}}return t}},decodeUrlComponent:function(e){if(void 0!==e){var t;try{t=decodeURIComponent(e)}catch(t){throw{code:"D3140",stack:(new Error).stack,value:e,functionName:"decodeUrlComponent"}}return t}},decodeUrl:function(e){if(void 0!==e){var t;try{t=decodeURI(e)}catch(t){throw{code:"D3140",stack:(new Error).stack,value:e,functionName:"decodeUrl"}}return t}}}})();t.exports=a}).call(this)}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./utils":6}],3:[function(e,t,r){var n=e("./datetime"),a=e("./functions"),i=e("./utils"),o=e("./parser"),s=e("./signature"),c=function(){"use strict";var e=i.isNumeric,t=i.isArrayOfStrings,r=i.isArrayOfNumbers,c=i.createSequence,u=i.isSequence,l=i.isFunction,p=i.isLambda,f=i.isIterable,d=i.isPromise,h=i.getFunctionArity,v=i.isDeepEqual,m=F(null);async function g(r,n,i){var o,s=i.lookup("__evaluate_entry");switch(s&&await s(r,n,i),r.type){case"path":o=await async function(e,t,r){var n,a;n=Array.isArray(t)&&"variable"!==e.steps[0].type?t:c(t);for(var i=!1,o=void 0,s=0;s<e.steps.length;s++){var u=e.steps[s];if(u.tuple&&(i=!0),0===s&&u.consarray?a=await g(u,n,r):i?o=await x(u,n,o,r):a=await y(u,n,r,s===e.steps.length-1),!i&&(void 0===a||0===a.length))break;void 0===u.focus&&(n=a)}if(i)if(e.tuple)a=o;else for(a=c(),s=0;s<o.length;s++)a.push(o[s]["@"]);return e.keepSingletonArray&&(Array.isArray(a)&&a.cons&&!a.sequence&&(a=c(a)),a.keepSingleton=!0),e.hasOwnProperty("group")&&(a=await D(e.group,i?o:a,r)),a}(r,n,i);break;case"binary":o=await async function(t,r,n){var i,o=await g(t.lhs,r,n),s=t.value,c=async()=>await g(t.rhs,r,n);if("and"===s||"or"===s)try{return await async function(e,t,r){var n,a=A(e);switch(r){case"and":n=a&&A(await t());break;case"or":n=a||A(await t())}return n}(o,c,s)}catch(e){throw e.position=t.position,e.token=s,e}var u=await c();try{switch(s){case"+":case"-":case"*":case"/":case"%":i=function(t,r,n){var a;if(void 0!==t&&!e(t))throw{code:"T2001",stack:(new Error).stack,value:t};if(void 0!==r&&!e(r))throw{code:"T2002",stack:(new Error).stack,value:r};if(void 0===t||void 0===r)return a;switch(n){case"+":a=t+r;break;case"-":a=t-r;break;case"*":a=t*r;break;case"/":a=t/r;break;case"%":a=t%r}return a}(o,u,s);break;case"=":case"!=":i=function(e,t,r){var n;if(void 0===e||void 0===t)return!1;switch(r){case"=":n=v(e,t);break;case"!=":n=!v(e,t)}return n}(o,u,s);break;case"<":case"<=":case">":case">=":i=function(e,t,r){var n,a=typeof e,i=typeof t;if("undefined"!==a&&"string"!==a&&"number"!==a||"undefined"!==i&&"string"!==i&&"number"!==i)throw{code:"T2010",stack:(new Error).stack,value:"string"!==a&&"number"!==a?e:t};if("undefined"!==a&&"undefined"!==i){if(a!==i)throw{code:"T2009",stack:(new Error).stack,value:e,value2:t};switch(r){case"<":n=e<t;break;case"<=":n=e<=t;break;case">":n=e>t;break;case">=":n=e>=t}return n}}(o,u,s);break;case"&":i=function(e,t){var r="",n="";return void 0!==e&&(r=a.string(e)),void 0!==t&&(n=a.string(t)),r.concat(n)}(o,u);break;case"..":i=function(e,t){var r;if(void 0!==e&&!Number.isInteger(e))throw{code:"T2003",stack:(new Error).stack,value:e};if(void 0!==t&&!Number.isInteger(t))throw{code:"T2004",stack:(new Error).stack,value:t};if(void 0===e||void 0===t)return r;if(e>t)return r;var n=t-e+1;if(n>1e7)throw{code:"D2014",stack:(new Error).stack,value:n};r=new Array(n);for(var a=e,i=0;a<=t;a++,i++)r[i]=a;return r.sequence=!0,r}(o,u);break;case"in":i=function(e,t){var r=!1;if(void 0===e||void 0===t)return!1;Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++)if(t[n]===e){r=!0;break}return r}(o,u)}}catch(e){throw e.position=t.position,e.token=s,e}return i}(r,n,i);break;case"unary":o=await async function(t,r,n){var i;switch(t.value){case"-":if(void 0===(i=await g(t.expression,r,n)))i=void 0;else{if(!e(i))throw{code:"D1002",stack:(new Error).stack,position:t.position,token:t.value,value:i};i=-i}break;case"[":i=[];let c=await Promise.all(t.expressions.map((async(e,t)=>(n.isParallelCall=t>0,[e,await g(e,r,n)]))));for(let e of c){var[o,s]=e;void 0!==s&&("["===o.value?i.push(s):i=a.append(i,s))}t.consarray&&Object.defineProperty(i,"cons",{enumerable:!1,configurable:!1,value:!0});break;case"{":i=await D(t,r,n)}return i}(r,n,i);break;case"name":o=function(e,t,r){return a.lookup(t,e.value)}(r,n);break;case"string":case"number":case"value":o=function(e){return e.value}(r);break;case"wildcard":o=function(e,t){var r=c();return Array.isArray(t)&&t.outerWrapper&&t.length>0&&(t=t[0]),null!==t&&"object"==typeof t&&Object.keys(t).forEach((function(e){var n=t[e];Array.isArray(n)?(n=E(n),r=a.append(r,n)):r.push(n)})),r}(0,n);break;case"descendant":o=function(e,t){var r,n=c();return void 0!==t&&(T(t,n),r=1===n.length?n[0]:n),r}(0,n);break;case"parent":o=i.lookup(r.slot.label);break;case"condition":o=await async function(e,t,r){var n,i=await g(e.condition,t,r);return a.boolean(i)?n=await g(e.then,t,r):void 0!==e.else&&(n=await g(e.else,t,r)),n}(r,n,i);break;case"block":o=await async function(e,t,r){for(var n,a=F(r),i=0;i<e.expressions.length;i++)n=await g(e.expressions[i],t,a);return n}(r,n,i);break;case"bind":o=await async function(e,t,r){var n=await g(e.rhs,t,r);return r.bind(e.lhs.value,n),n}(r,n,i);break;case"regex":o=function(e){var t=new Z.RegexEngine(e.value),r=function(n,a){var i;t.lastIndex=a||0;var o=t.exec(n);if(null!==o){if(i={match:o[0],start:o.index,end:o.index+o[0].length,groups:[]},o.length>1)for(var s=1;s<o.length;s++)i.groups.push(o[s]);i.next=function(){if(!(t.lastIndex>=n.length)){var a=r(n,t.lastIndex);if(a&&""===a.match)throw{code:"D1004",stack:(new Error).stack,position:e.position,value:e.value.source};return a}}}return i};return r}(r);break;case"function":o=await C(r,n,i);break;case"variable":o=function(e,t,r){return""===e.value?t&&t.outerWrapper?t[0]:t:r.lookup(e.value)}(r,n,i);break;case"lambda":o=function(e,t,r){var n={_jsonata_lambda:!0,input:t,environment:r,arguments:e.arguments,signature:e.signature,body:e.body};return!0===e.thunk&&(n.thunk=!0),n.apply=async function(e,a){return await P(n,a,t,e?e.environment:r)},n}(r,n,i);break;case"partial":o=await async function(e,t,r){for(var n,a=[],i=0;i<e.arguments.length;i++){var o=e.arguments[i];"operator"===o.type&&"?"===o.value?a.push(o):a.push(await g(o,t,r))}var s=await g(e.procedure,t,r);if(void 0===s&&"path"===e.procedure.type&&r.lookup(e.procedure.steps[0].value))throw{code:"T1007",stack:(new Error).stack,position:e.position,token:e.procedure.steps[0].value};if(p(s))n=M(s,a);else if(s&&!0===s._jsonata_function)n=I(s.implementation,a);else{if("function"!=typeof s)throw{code:"T1008",stack:(new Error).stack,position:e.position,token:"path"===e.procedure.type?e.procedure.steps[0].value:e.procedure.value};n=I(s,a)}return n}(r,n,i);break;case"apply":o=await async function(e,t,r){var n,a=await g(e.lhs,t,r);if("function"===e.rhs.type)n=await C(e.rhs,t,r,{context:a});else{var i=await g(e.rhs,t,r);if(!l(i))throw{code:"T2006",stack:(new Error).stack,position:e.position,value:i};if(l(a)){var o=await g(O,null,r);n=await P(o,[a,i],null,r)}else n=await P(i,[a],null,r)}return n}(r,n,i);break;case"transform":o=function(e,r,n){return U((async function(r){if(void 0!==r){var a=n.lookup("clone");if(!l(a))throw{code:"T2013",stack:(new Error).stack,position:e.position};var i=await P(a,[r],null,n),o=await g(e.pattern,i,n);if(void 0!==o){Array.isArray(o)||(o=[o]);for(var s=0;s<o.length;s++){var c=o[s],u=await g(e.update,c,n),p=typeof u;if("undefined"!==p){if("object"!==p||null===u||Array.isArray(u))throw{code:"T2011",stack:(new Error).stack,position:e.update.position,value:u};for(var f in u)c[f]=u[f]}if(void 0!==e.delete){var d=await g(e.delete,c,n);if(void 0!==d){var h=d;if(Array.isArray(d)||(d=[d]),!t(d))throw{code:"T2012",stack:(new Error).stack,position:e.delete.position,value:h};for(var v=0;v<d.length;v++)"object"==typeof c&&null!==c&&delete c[d[v]]}}}}return i}}),"<(oa):o>")}(r,0,i)}if(Object.prototype.hasOwnProperty.call(r,"predicate"))for(var f=0;f<r.predicate.length;f++)o=await k(r.predicate[f].expr,o,i);"path"!==r.type&&Object.prototype.hasOwnProperty.call(r,"group")&&(o=await D(r.group,o,i));var d=i.lookup("__evaluate_exit");return d&&await d(r,n,i,o),o&&u(o)&&!o.tupleStream&&(r.keepArray&&(o.keepSingleton=!0),0===o.length?o=void 0:1===o.length&&(o=o.keepSingleton?o:o[0])),o}function b(e,t){var r=F(e);for(const e in t)r.bind(e,t[e]);return r}async function y(e,t,r,n){var a;if("sort"===e.type)return a=await S(e,t,r),e.stages&&(a=await w(e.stages,a,r)),a;a=c();for(var i=0;i<t.length;i++){var o=await g(e,t[i],r);if(e.stages)for(var s=0;s<e.stages.length;s++)o=await k(e.stages[s].expr,o,r);void 0!==o&&a.push(o)}var l=c();return n&&1===a.length&&Array.isArray(a[0])&&!u(a[0])?l=a[0]:a.forEach((function(e){!Array.isArray(e)||e.cons?l.push(e):e.forEach((e=>l.push(e)))})),l}async function w(e,t,r){for(var n=t,a=0;a<e.length;a++){var i=e[a];switch(i.type){case"filter":n=await k(i.expr,n,r);break;case"index":for(var o=0;o<n.length;o++)n[o][i.value]=o}}return n}async function x(e,t,r,n){var a;if("sort"===e.type){if(r)a=await S(e,r,n);else{var i=await S(e,t,n);(a=c()).tupleStream=!0;for(var o=0;o<i.length;o++){var s={"@":i[o]};s[e.index]=o,a.push(s)}}return e.stages&&(a=await w(e.stages,a,n)),a}(a=c()).tupleStream=!0;var u=n;void 0===r&&(r=t.map((e=>({"@":e}))));for(var l=0;l<r.length;l++){u=b(n,r[l]);var p=await g(e,r[l]["@"],u);if(void 0!==p){Array.isArray(p)||(p=[p]);for(var f=0;f<p.length;f++)s={},Object.assign(s,r[l]),p.tupleStream?Object.assign(s,p[f]):(e.focus?(s[e.focus]=p[f],s["@"]=r[l]["@"]):s["@"]=p[f],e.index&&(s[e.index]=f),e.ancestor&&(s[e.ancestor.label]=r[l]["@"])),a.push(s)}}return e.stages&&(a=await w(e.stages,a,n)),a}async function k(t,n,i){var o=c();if(n&&n.tupleStream&&(o.tupleStream=!0),Array.isArray(n)||(n=c(n)),"number"===t.type){var s=Math.floor(t.value);s<0&&(s=n.length+s),void 0!==(u=n[s])&&(Array.isArray(u)?o=u:o.push(u))}else for(s=0;s<n.length;s++){var u,l=u=n[s],p=i;n.tupleStream&&(l=u["@"],p=b(i,u));var f=await g(t,l,p);e(f)&&(f=[f]),r(f)?f.forEach((function(e){var t=Math.floor(e);t<0&&(t=n.length+t),t===s&&o.push(u)})):a.boolean(f)&&o.push(u)}return o}function E(e,t){return void 0===t&&(t=[]),Array.isArray(e)?e.forEach((function(e){E(e,t)})):t.push(e),t}function T(e,t){Array.isArray(e)||t.push(e),Array.isArray(e)?e.forEach((function(e){T(e,t)})):null!==e&&"object"==typeof e&&Object.keys(e).forEach((function(r){T(e[r],t)}))}function A(e){var t=a.boolean(e);return void 0!==t&&t}async function D(e,t,r){var n={},i={},o=!(!t||!t.tupleStream);Array.isArray(t)||(t=c(t)),0===t.length&&t.push(void 0);for(var s=0;s<t.length;s++)for(var u=t[s],l=o?b(r,u):r,p=0;p<e.lhs.length;p++){var f,d=e.lhs[p];if("string"!=typeof(f=await g(d[0],o?u["@"]:u,l))&&void 0!==f)throw{code:"T1003",stack:(new Error).stack,position:e.position,value:f};if(void 0!==f){var h={data:u,exprIndex:p};if(i.hasOwnProperty(f)){if(i[f].exprIndex!==p)throw{code:"D1009",stack:(new Error).stack,position:e.position,value:f};i[f].data=a.append(i[f].data,u)}else i[f]=h}}let v=await Promise.all(Object.keys(i).map((async(t,n)=>{let s=i[t];var c=s.data,u=r;if(o){var l=function(e){if(!Array.isArray(e))return e;var t={};Object.assign(t,e[0]);for(var r=1;r<e.length;r++)for(const n in e[r])t[n]=a.append(t[n],e[r][n]);return t}(s.data);c=l["@"],delete l["@"],u=b(r,l)}return r.isParallelCall=n>0,[t,await g(e.lhs[s.exprIndex][1],c,u)]})));for(let e of v){var[f,m]=await e;void 0!==m&&(n[f]=m)}return n}async function S(e,t,r){var n=t,i=!!t.tupleStream,o={environment:r,input:t};return await a.sort.apply(o,[n,async function(t,n){for(var a=0,o=0;0===a&&o<e.terms.length;o++){var s=e.terms[o],c=t,u=r;i&&(c=t["@"],u=b(r,t));var l=await g(s.expression,c,u);c=n,u=r,i&&(c=n["@"],u=b(r,n));var p=await g(s.expression,c,u),f=typeof l,d=typeof p;if("undefined"!==f)if("undefined"!==d){if("string"!==f&&"number"!==f||"string"!==d&&"number"!==d)throw{code:"T2008",stack:(new Error).stack,position:e.position,value:"string"!==f&&"number"!==f?l:p};if(f!==d)throw{code:"T2007",stack:(new Error).stack,position:e.position,value:l,value2:p};l!==p&&(a=l<p?-1:1,!0===s.descending&&(a=-a))}else a=-1;else a="undefined"===d?0:1}return 1===a}])}var O=o("function($f, $g) { function($x){ $g($f($x)) } }");async function C(e,t,r,n){var a,i=await g(e.procedure,t,r);if(void 0===i&&"path"===e.procedure.type&&r.lookup(e.procedure.steps[0].value))throw{code:"T1005",stack:(new Error).stack,position:e.position,token:e.procedure.steps[0].value};var o=[];void 0!==n&&o.push(n.context);for(var s=0;s<e.arguments.length;s++){const n=await g(e.arguments[s],t,r);if(l(n)){const e=async function(...e){return await P(n,e,null,r)};e.arity=h(n),o.push(e)}else o.push(n)}var c="path"===e.procedure.type?e.procedure.steps[0].value:e.procedure.value;try{"object"==typeof i&&(i.token=c,i.position=e.position),a=await P(i,o,t,r)}catch(t){throw t.position||(t.position=e.position),t.token||(t.token=c),t}return a}async function P(e,t,r,n){var a;for(a=await N(e,t,r,n);p(a)&&!0===a.thunk;){var i=await g(a.body.procedure,a.input,a.environment);"variable"===a.body.procedure.type&&(i.token=a.body.procedure.value),i.position=a.body.procedure.position;for(var o=[],s=0;s<a.body.arguments.length;s++)o.push(await g(a.body.arguments[s],a.input,a.environment));a=await N(i,o,r,n)}return a}async function N(e,t,r,n){var a;try{var i=t;if(e&&(i=function(e,t,r){return void 0===e?t:e.validate(t,r)}(e.signature,t,r)),p(e))a=await async function(e,t){var r=F(e.environment);return e.arguments.forEach((function(e,n){r.bind(e.value,t[n])})),"function"==typeof e.body?await async function(e,t){var r=j(e).map((function(e){return t.lookup(e.trim())})),n={environment:t},a=e.apply(n,r);return d(a)&&(a=await a),a}(e.body,r):await g(e.body,e.input,r)}(e,i);else if(e&&!0===e._jsonata_function){var o={environment:n,input:r};a=e.implementation.apply(o,i),f(a)&&(a=a.next().value),d(a)&&(a=await a)}else{if("function"!=typeof e)throw{code:"T1006",stack:(new Error).stack};a=e.apply(r,i),d(a)&&(a=await a)}}catch(t){throw e&&(void 0===t.token&&void 0!==e.token&&(t.token=e.token),t.position=e.position),t}return a}function M(e,t){var r=F(e.environment),n=[];return e.arguments.forEach((function(e,a){var i=t[a];i&&"operator"===i.type&&"?"===i.value?n.push(e):r.bind(e.value,i)})),{_jsonata_lambda:!0,input:e.input,environment:r,arguments:n,body:e.body}}function I(e,t){var r=j(e),n="function("+(r=r.map((function(e){return"$"+e.trim()}))).join(", ")+"){ _ }",a=o(n);return a.body=e,M(a,t)}function j(e){var t=e.toString();return/\(([^)]*)\)/.exec(t)[1].split(",")}function U(e,t){var r={_jsonata_function:!0,implementation:e};return void 0!==t&&(r.signature=s(t)),r}function F(e){var t={};return{bind:function(e,r){t[e]=r},lookup:function(r){var n;return t.hasOwnProperty(r)?n=t[r]:e&&(n=e.lookup(r)),n},timestamp:e?e.timestamp:null,async:!!e&&e.async,isParallelCall:!!e&&e.isParallelCall,global:e?e.global:{ancestry:[null]}}}m.bind("sum",U(a.sum,"<a<n>:n>")),m.bind("count",U(a.count,"<a:n>")),m.bind("max",U(a.max,"<a<n>:n>")),m.bind("min",U(a.min,"<a<n>:n>")),m.bind("average",U(a.average,"<a<n>:n>")),m.bind("string",U(a.string,"<x-b?:s>")),m.bind("substring",U(a.substring,"<s-nn?:s>")),m.bind("substringBefore",U(a.substringBefore,"<s-s:s>")),m.bind("substringAfter",U(a.substringAfter,"<s-s:s>")),m.bind("lowercase",U(a.lowercase,"<s-:s>")),m.bind("uppercase",U(a.uppercase,"<s-:s>")),m.bind("length",U(a.length,"<s-:n>")),m.bind("trim",U(a.trim,"<s-:s>")),m.bind("pad",U(a.pad,"<s-ns?:s>")),m.bind("match",U(a.match,"<s-f<s:o>n?:a<o>>")),m.bind("contains",U(a.contains,"<s-(sf):b>")),m.bind("replace",U(a.replace,"<s-(sf)(sf)n?:s>")),m.bind("split",U(a.split,"<s-(sf)n?:a<s>>")),m.bind("join",U(a.join,"<a<s>s?:s>")),m.bind("formatNumber",U(a.formatNumber,"<n-so?:s>")),m.bind("formatBase",U(a.formatBase,"<n-n?:s>")),m.bind("formatInteger",U(n.formatInteger,"<n-s:s>")),m.bind("parseInteger",U(n.parseInteger,"<s-s:n>")),m.bind("number",U(a.number,"<(nsb)-:n>")),m.bind("floor",U(a.floor,"<n-:n>")),m.bind("ceil",U(a.ceil,"<n-:n>")),m.bind("round",U(a.round,"<n-n?:n>")),m.bind("abs",U(a.abs,"<n-:n>")),m.bind("sqrt",U(a.sqrt,"<n-:n>")),m.bind("power",U(a.power,"<n-n:n>")),m.bind("random",U(a.random,"<:n>")),m.bind("boolean",U(a.boolean,"<x-:b>")),m.bind("not",U(a.not,"<x-:b>")),m.bind("map",U(a.map,"<af>")),m.bind("zip",U(a.zip,"<a+>")),m.bind("filter",U(a.filter,"<af>")),m.bind("single",U(a.single,"<af?>")),m.bind("reduce",U(a.foldLeft,"<afj?:j>")),m.bind("sift",U(a.sift,"<o-f?:o>")),m.bind("keys",U(a.keys,"<x-:a<s>>")),m.bind("lookup",U(a.lookup,"<x-s:x>")),m.bind("append",U(a.append,"<xx:a>")),m.bind("exists",U(a.exists,"<x:b>")),m.bind("spread",U(a.spread,"<x-:a<o>>")),m.bind("merge",U(a.merge,"<a<o>:o>")),m.bind("reverse",U(a.reverse,"<a:a>")),m.bind("each",U(a.each,"<o-f:a>")),m.bind("error",U(a.error,"<s?:x>")),m.bind("assert",U(a.assert,"<bs?:x>")),m.bind("type",U(a.type,"<x:s>")),m.bind("sort",U(a.sort,"<af?:a>")),m.bind("shuffle",U(a.shuffle,"<a:a>")),m.bind("distinct",U(a.distinct,"<x:x>")),m.bind("base64encode",U(a.base64encode,"<s-:s>")),m.bind("base64decode",U(a.base64decode,"<s-:s>")),m.bind("encodeUrlComponent",U(a.encodeUrlComponent,"<s-:s>")),m.bind("encodeUrl",U(a.encodeUrl,"<s-:s>")),m.bind("decodeUrlComponent",U(a.decodeUrlComponent,"<s-:s>")),m.bind("decodeUrl",U(a.decodeUrl,"<s-:s>")),m.bind("eval",U((async function(e,t){if(void 0!==e){var r=this.input;void 0!==t&&(r=t,Array.isArray(r)&&!u(r)&&((r=c(r)).outerWrapper=!0));try{var n=o(e,!1)}catch(e){throw L(e),{stack:(new Error).stack,code:"D3120",value:e.message,error:e}}try{var a=await g(n,r,this.environment)}catch(e){throw L(e),{stack:(new Error).stack,code:"D3121",value:e.message,error:e}}return a}}),"<sx?:x>")),m.bind("toMillis",U(n.toMillis,"<s-s?:n>")),m.bind("fromMillis",U(n.fromMillis,"<n-s?s?:s>")),m.bind("clone",U((function(e){if(void 0!==e)return JSON.parse(a.string(e))}),"<(oa)-:o>"));var R={S0101:"String literal must be terminated by a matching quote",S0102:"Number out of range: {{token}}",S0103:"Unsupported escape sequence: \\{{token}}",S0104:"The escape sequence \\u must be followed by 4 hex digits",S0105:"Quoted property name must be terminated with a backquote (`)",S0106:"Comment has no closing tag",S0201:"Syntax error: {{token}}",S0202:"Expected {{value}}, got {{token}}",S0203:"Expected {{value}} before end of expression",S0204:"Unknown operator: {{token}}",S0205:"Unexpected token: {{token}}",S0206:"Unknown expression type: {{token}}",S0207:"Unexpected end of expression",S0208:"Parameter {{value}} of function definition must be a variable name (start with $)",S0209:"A predicate cannot follow a grouping expression in a step",S0210:"Each step can only have one grouping expression",S0211:"The symbol {{token}} cannot be used as a unary operator",S0212:"The left side of := must be a variable name (start with $)",S0213:"The literal value {{value}} cannot be used as a step within a path expression",S0214:"The right side of {{token}} must be a variable name (start with $)",S0215:"A context variable binding must precede any predicates on a step",S0216:"A context variable binding must precede the 'order-by' clause on a step",S0217:"The object representing the 'parent' cannot be derived from this expression",S0301:"Empty regular expressions are not allowed",S0302:"No terminating / in regular expression",S0402:"Choice groups containing parameterized types are not supported",S0401:"Type parameters can only be applied to functions and arrays",S0500:"Attempted to evaluate an expression containing syntax error(s)",T0410:"Argument {{index}} of function {{token}} does not match function signature",T0411:"Context value is not a compatible type with argument {{index}} of function {{token}}",T0412:"Argument {{index}} of function {{token}} must be an array of {{type}}",D1001:"Number out of range: {{value}}",D1002:"Cannot negate a non-numeric value: {{value}}",T1003:"Key in object structure must evaluate to a string; got: {{value}}",D1004:"Regular expression matches zero length string",T1005:"Attempted to invoke a non-function. Did you mean ${{{token}}}?",T1006:"Attempted to invoke a non-function",T1007:"Attempted to partially apply a non-function. Did you mean ${{{token}}}?",T1008:"Attempted to partially apply a non-function",D1009:"Multiple key definitions evaluate to same key: {{value}}",T1010:"The matcher function argument passed to function {{token}} does not return the correct object structure",T2001:"The left side of the {{token}} operator must evaluate to a number",T2002:"The right side of the {{token}} operator must evaluate to a number",T2003:"The left side of the range operator (..) must evaluate to an integer",T2004:"The right side of the range operator (..) must evaluate to an integer",D2005:"The left side of := must be a variable name (start with $)",T2006:"The right side of the function application operator ~> must be a function",T2007:"Type mismatch when comparing values {{value}} and {{value2}} in order-by clause",T2008:"The expressions within an order-by clause must evaluate to numeric or string values",T2009:"The values {{value}} and {{value2}} either side of operator {{token}} must be of the same data type",T2010:"The expressions either side of operator {{token}} must evaluate to numeric or string values",T2011:"The insert/update clause of the transform expression must evaluate to an object: {{value}}",T2012:"The delete clause of the transform expression must evaluate to a string or array of strings: {{value}}",T2013:"The transform expression clones the input object using the $clone() function.  This has been overridden in the current scope by a non-function.",D2014:"The size of the sequence allocated by the range operator (..) must not exceed 1e6.  Attempted to allocate {{value}}.",D3001:"Attempting to invoke string function on Infinity or NaN",D3010:"Second argument of replace function cannot be an empty string",D3011:"Fourth argument of replace function must evaluate to a positive number",D3012:"Attempted to replace a matched string with a non-string value",D3020:"Third argument of split function must evaluate to a positive number",D3030:"Unable to cast value to a number: {{value}}",D3040:"Third argument of match function must evaluate to a positive number",D3050:"The second argument of reduce function must be a function with at least two arguments",D3060:"The sqrt function cannot be applied to a negative number: {{value}}",D3061:"The power function has resulted in a value that cannot be represented as a JSON number: base={{value}}, exponent={{exp}}",D3070:"The single argument form of the sort function can only be applied to an array of strings or an array of numbers.  Use the second argument to specify a comparison function",D3080:"The picture string must only contain a maximum of two sub-pictures",D3081:"The sub-picture must not contain more than one instance of the 'decimal-separator' character",D3082:"The sub-picture must not contain more than one instance of the 'percent' character",D3083:"The sub-picture must not contain more than one instance of the 'per-mille' character",D3084:"The sub-picture must not contain both a 'percent' and a 'per-mille' character",D3085:"The mantissa part of a sub-picture must contain at least one character that is either an 'optional digit character' or a member of the 'decimal digit family'",D3086:"The sub-picture must not contain a passive character that is preceded by an active character and that is followed by another active character",D3087:"The sub-picture must not contain a 'grouping-separator' character that appears adjacent to a 'decimal-separator' character",D3088:"The sub-picture must not contain a 'grouping-separator' at the end of the integer part",D3089:"The sub-picture must not contain two adjacent instances of the 'grouping-separator' character",D3090:"The integer part of the sub-picture must not contain a member of the 'decimal digit family' that is followed by an instance of the 'optional digit character'",D3091:"The fractional part of the sub-picture must not contain an instance of the 'optional digit character' that is followed by a member of the 'decimal digit family'",D3092:"A sub-picture that contains a 'percent' or 'per-mille' character must not contain a character treated as an 'exponent-separator'",D3093:"The exponent part of the sub-picture must comprise only of one or more characters that are members of the 'decimal digit family'",D3100:"The radix of the formatBase function must be between 2 and 36.  It was given {{value}}",D3110:"The argument of the toMillis function must be an ISO 8601 formatted timestamp. Given {{value}}",D3120:"Syntax error in expression passed to function eval: {{value}}",D3121:"Dynamic error evaluating the expression passed to function eval: {{value}}",D3130:"Formatting or parsing an integer as a sequence starting with {{value}} is not supported by this implementation",D3131:"In a decimal digit pattern, all digits must be from the same decimal group",D3132:"Unknown component specifier {{value}} in date/time picture string",D3133:"The 'name' modifier can only be applied to months and days in the date/time picture string, not {{value}}",D3134:"The timezone integer format specifier cannot have more than four digits",D3135:"No matching closing bracket ']' in date/time picture string",D3136:"The date/time picture string is missing specifiers required to parse the timestamp",D3137:"{{{message}}}",D3138:"The $single() function expected exactly 1 matching result.  Instead it matched more.",D3139:"The $single() function expected exactly 1 matching result.  Instead it matched 0.",D3140:"Malformed URL passed to ${{{functionName}}}(): {{value}}",D3141:"{{{message}}}"};function L(e){var t=R[e.code];if(void 0!==t){var r=t.replace(/\{\{\{([^}]+)}}}/g,(function(){return e[arguments[1]]}));r=r.replace(/\{\{([^}]+)}}/g,(function(){return JSON.stringify(e[arguments[1]])})),e.message=r}}function Z(e,t){var r,a;try{r=o(e,t&&t.recover),a=r.errors,delete r.errors}catch(e){throw L(e),e}var i=F(m),s=new Date;return i.bind("now",U((function(e,t){return n.fromMillis(s.getTime(),e,t)}),"<s?s?:s>")),i.bind("millis",U((function(){return s.getTime()}),"<:n>")),t&&t.RegexEngine?Z.RegexEngine=t.RegexEngine:Z.RegexEngine=RegExp,{evaluate:async function(e,t,n){if(void 0!==a){var o={code:"S0500",position:0};throw L(o),o}var l,p;if(void 0!==t)for(var f in l=F(i),t)l.bind(f,t[f]);else l=i;l.bind("$",e),s=new Date,l.timestamp=s,Array.isArray(e)&&!u(e)&&((e=c(e)).outerWrapper=!0);try{return p=await g(r,e,l),"function"==typeof n&&n(null,p),p}catch(o){throw L(o),o}},assign:function(e,t){i.bind(e,t)},registerFunction:function(e,t,r){var n=U(t,r);i.bind(e,n)},ast:function(){return r},errors:function(){return a}}}return Z.parser=o,Z}();t.exports=c},{"./datetime":1,"./functions":2,"./parser":4,"./signature":5,"./utils":6}],4:[function(e,t,r){var n=e("./signature");const a=(()=>{"use strict";var e={".":75,"[":80,"]":0,"{":70,"}":0,"(":80,")":0,",":0,"@":80,"#":80,";":80,":":80,"?":20,"+":50,"-":50,"*":60,"/":60,"%":60,"|":20,"=":40,"<":40,">":40,"^":40,"**":60,"..":20,":=":10,"!=":40,"<=":40,">=":40,"~>":40,and:30,or:25,in:40,"&":50,"!":0,"~":0},t={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},r=function(r){var n=0,a=r.length,i=function(e,t){return{type:e,value:t,position:n}},o=function(s){if(n>=a)return null;for(var c=r.charAt(n);n<a&&" \t\n\r\v".indexOf(c)>-1;)n++,c=r.charAt(n);if("/"===c&&"*"===r.charAt(n+1)){var u=n;for(n+=2,c=r.charAt(n);"*"!==c||"/"!==r.charAt(n+1);)if(c=r.charAt(++n),n>=a)throw{code:"S0106",stack:(new Error).stack,position:u};return n+=2,c=r.charAt(n),o(s)}if(!0!==s&&"/"===c)return n++,i("regex",function(){for(var e,t,i=n,o=0,s=function(e){if("/"===r.charAt(e)&&0===o){for(var t=0;"\\"===r.charAt(e-(t+1));)t++;if(t%2==0)return!0}return!1};n<a;){var c=r.charAt(n);if(s(n)){if(""===(e=r.substring(i,n)))throw{code:"S0301",stack:(new Error).stack,position:n};for(n++,c=r.charAt(n),i=n;"i"===c||"m"===c;)n++,c=r.charAt(n);return t=r.substring(i,n)+"g",new RegExp(e,t)}"("!==c&&"["!==c&&"{"!==c||"\\"===r.charAt(n-1)||o++,")"!==c&&"]"!==c&&"}"!==c||"\\"===r.charAt(n-1)||o--,n++}throw{code:"S0302",stack:(new Error).stack,position:n}}());if("."===c&&"."===r.charAt(n+1))return n+=2,i("operator","..");if(":"===c&&"="===r.charAt(n+1))return n+=2,i("operator",":=");if("!"===c&&"="===r.charAt(n+1))return n+=2,i("operator","!=");if(">"===c&&"="===r.charAt(n+1))return n+=2,i("operator",">=");if("<"===c&&"="===r.charAt(n+1))return n+=2,i("operator","<=");if("*"===c&&"*"===r.charAt(n+1))return n+=2,i("operator","**");if("~"===c&&">"===r.charAt(n+1))return n+=2,i("operator","~>");if(Object.prototype.hasOwnProperty.call(e,c))return n++,i("operator",c);if('"'===c||"'"===c){var l=c;n++;for(var p="";n<a;){if("\\"===(c=r.charAt(n)))if(n++,c=r.charAt(n),Object.prototype.hasOwnProperty.call(t,c))p+=t[c];else{if("u"!==c)throw{code:"S0103",stack:(new Error).stack,position:n,token:c};var f=r.substr(n+1,4);if(!/^[0-9a-fA-F]+$/.test(f))throw{code:"S0104",stack:(new Error).stack,position:n};var d=parseInt(f,16);p+=String.fromCharCode(d),n+=4}else{if(c===l)return n++,i("string",p);p+=c}n++}throw{code:"S0101",stack:(new Error).stack,position:n}}var h,v=/^-?(0|([1-9][0-9]*))(\.[0-9]+)?([Ee][-+]?[0-9]+)?/.exec(r.substring(n));if(null!==v){var m=parseFloat(v[0]);if(!isNaN(m)&&isFinite(m))return n+=v[0].length,i("number",m);throw{code:"S0102",stack:(new Error).stack,position:n,token:v[0]}}if("`"===c){n++;var g=r.indexOf("`",n);if(-1!==g)return h=r.substring(n,g),n=g+1,i("name",h);throw n=a,{code:"S0105",stack:(new Error).stack,position:n}}for(var b,y=n;;)if(b=r.charAt(y),y===a||" \t\n\r\v".indexOf(b)>-1||Object.prototype.hasOwnProperty.call(e,b)){if("$"===r.charAt(n))return h=r.substring(n+1,y),n=y,i("variable",h);switch(h=r.substring(n,y),n=y,h){case"or":case"in":case"and":return i("operator",h);case"true":return i("value",!0);case"false":return i("value",!1);case"null":return i("value",null);default:return n===a&&""===h?null:i("name",h)}}else y++};return o};return function(t,a){var i,o,s={},c=[],u=function(){var e=[];"(end)"!==i.id&&e.push({type:i.type,value:i.value,position:i.position});for(var t=o();null!==t;)e.push(t),t=o();return e},l={nud:function(){var e={code:"S0211",token:this.value,position:this.position};if(a)return e.remaining=u(),e.type="error",c.push(e),e;throw e.stack=(new Error).stack,e}},p=function(e,t){var r=s[e];return t=t||0,r?t>=r.lbp&&(r.lbp=t):((r=Object.create(l)).id=r.value=e,r.lbp=t,s[e]=r),r},f=function(e){if(a){e.remaining=u(),c.push(e);var t=s["(error)"];return(i=Object.create(t)).error=e,i.type="(error)",i}throw e.stack=(new Error).stack,e},d=function(e,r){if(e&&i.id!==e){var n={code:"(end)"===i.id?"S0203":"S0202",position:i.position,token:i.value,value:e};return f(n)}var a=o(r);if(null===a)return(i=s["(end)"]).position=t.length,i;var c,u=a.value,l=a.type;switch(l){case"name":case"variable":c=s["(name)"];break;case"operator":if(!(c=s[u]))return f({code:"S0204",stack:(new Error).stack,position:a.position,token:u});break;case"string":case"number":case"value":c=s["(literal)"];break;case"regex":l="regex",c=s["(regex)"];break;default:return f({code:"S0205",stack:(new Error).stack,position:a.position,token:u})}return(i=Object.create(c)).value=u,i.type=l,i.position=a.position,i},h=function(e){var t,r=i;for(d(null,!0),t=r.nud();e<i.lbp;)r=i,d(),t=r.led(t);return t},v=function(e){p(e,0).nud=function(){return this}},m=function(t,r,n){var a=r||e[t],i=p(t,a);return i.led=n||function(e){return this.lhs=e,this.rhs=h(a),this.type="binary",this},i},g=function(e,t,r){var n=p(e,t);return n.led=r,n},b=function(e,t){var r=p(e);return r.nud=t||function(){return this.expression=h(70),this.type="unary",this},r};v("(end)"),v("(name)"),v("(literal)"),v("(regex)"),p(":"),p(";"),p(","),p(")"),p("]"),p("}"),p(".."),m("."),m("+"),m("-"),m("*"),m("/"),m("%"),m("="),m("<"),m(">"),m("!="),m("<="),m(">="),m("&"),m("and"),m("or"),m("in"),v("and"),v("or"),v("in"),b("-"),m("~>"),g("(error)",10,(function(e){return this.lhs=e,this.error=i.error,this.remaining=u(),this.type="error",this})),b("*",(function(){return this.type="wildcard",this})),b("**",(function(){return this.type="descendant",this})),b("%",(function(){return this.type="parent",this})),m("(",e["("],(function(e){if(this.procedure=e,this.type="function",this.arguments=[],")"!==i.id)for(;"operator"===i.type&&"?"===i.id?(this.type="partial",this.arguments.push(i),d("?")):this.arguments.push(h(0)),","===i.id;)d(",");if(d(")",!0),"name"===e.type&&("function"===e.value||"λ"===e.value)){if(this.arguments.forEach((function(e,t){if("variable"!==e.type)return f({code:"S0208",stack:(new Error).stack,position:e.position,token:e.value,value:t+1})})),this.type="lambda","<"===i.id){for(var t=i.position,r=1,a="<";r>0&&"{"!==i.id&&"(end)"!==i.id;){var o=d();">"===o.id?r--:"<"===o.id&&r++,a+=o.value}d(">");try{this.signature=n(a)}catch(e){return e.position=t+e.offset,f(e)}}d("{"),this.body=h(0),d("}")}return this})),b("(",(function(){for(var e=[];")"!==i.id&&(e.push(h(0)),";"===i.id);)d(";");return d(")",!0),this.type="block",this.expressions=e,this})),b("[",(function(){var e=[];if("]"!==i.id)for(;;){var t=h(0);if(".."===i.id){var r={type:"binary",value:"..",position:i.position,lhs:t};d(".."),r.rhs=h(0),t=r}if(e.push(t),","!==i.id)break;d(",")}return d("]",!0),this.expressions=e,this.type="unary",this})),m("[",e["["],(function(t){if("]"===i.id){for(var r=t;r&&"binary"===r.type&&"["===r.value;)r=r.lhs;return r.keepArray=!0,d("]"),t}return this.lhs=t,this.rhs=h(e["]"]),this.type="binary",d("]",!0),this})),m("^",e["^"],(function(e){d("(");for(var t=[];;){var r={descending:!1};if("<"===i.id?d("<"):">"===i.id&&(r.descending=!0,d(">")),r.expression=h(0),t.push(r),","!==i.id)break;d(",")}return d(")"),this.lhs=e,this.rhs=t,this.type="binary",this}));var y=function(e){var t=[];if("}"!==i.id)for(;;){var r=h(0);d(":");var n=h(0);if(t.push([r,n]),","!==i.id)break;d(",")}return d("}",!0),void 0===e?(this.lhs=t,this.type="unary"):(this.lhs=e,this.rhs=t,this.type="binary"),this};b("{",y),m("{",e["{"],y),g(":=",e[":="],(function(t){return"variable"!==t.type?f({code:"S0212",stack:(new Error).stack,position:t.position,token:t.value}):(this.lhs=t,this.rhs=h(e[":="]-1),this.type="binary",this)})),m("@",e["@"],(function(t){return this.lhs=t,this.rhs=h(e["@"]),"variable"!==this.rhs.type?f({code:"S0214",stack:(new Error).stack,position:this.rhs.position,token:"@"}):(this.type="binary",this)})),m("#",e["#"],(function(t){return this.lhs=t,this.rhs=h(e["#"]),"variable"!==this.rhs.type?f({code:"S0214",stack:(new Error).stack,position:this.rhs.position,token:"#"}):(this.type="binary",this)})),m("?",e["?"],(function(e){return this.type="condition",this.condition=e,this.then=h(0),":"===i.id&&(d(":"),this.else=h(0)),this})),b("|",(function(){return this.type="transform",this.pattern=h(0),d("|"),this.update=h(0),","===i.id&&(d(","),this.delete=h(0)),d("|"),this}));var w=function(e){var t;if("function"!==e.type||e.predicate)if("condition"===e.type)e.then=w(e.then),void 0!==e.else&&(e.else=w(e.else)),t=e;else if("block"===e.type){var r=e.expressions.length;r>0&&(e.expressions[r-1]=w(e.expressions[r-1])),t=e}else t=e;else{var n={type:"lambda",thunk:!0,arguments:[],position:e.position};n.body=e,t=n}return t},x=0,k=0,E=[],T=function(e,t){switch(e.type){case"name":case"wildcard":t.level--,0===t.level&&(void 0===e.ancestor||(E[t.index].slot.label=e.ancestor.label),e.ancestor=t,e.tuple=!0);break;case"parent":t.level++;break;case"block":e.expressions.length>0&&(e.tuple=!0,t=T(e.expressions[e.expressions.length-1],t));break;case"path":e.tuple=!0;var r=e.steps.length-1;for(t=T(e.steps[r--],t);t.level>0&&r>=0;)t=T(e.steps[r--],t);break;default:throw{code:"S0217",token:e.type,position:e.position}}return t},A=function(e,t){if(void 0!==t.seekingParent||"parent"===t.type){var r=void 0!==t.seekingParent?t.seekingParent:[];"parent"===t.type&&r.push(t.slot),void 0===e.seekingParent?e.seekingParent=r:Array.prototype.push.apply(e.seekingParent,r)}},D=function(e){var t=e.steps.length-1,r=e.steps[t],n=void 0!==r.seekingParent?r.seekingParent:[];"parent"===r.type&&n.push(r.slot);for(var a=0;a<n.length;a++){var i=n[a];for(t=e.steps.length-2;i.level>0;){if(t<0){void 0===e.seekingParent?e.seekingParent=[i]:e.seekingParent.push(i);break}for(var o=e.steps[t--];t>=0&&o.focus&&e.steps[t].focus;)o=e.steps[t--];i=T(o,i)}}},S=function(e){var t;switch(e.type){case"binary":switch(e.value){case".":var r=S(e.lhs);t="path"===r.type?r:{type:"path",steps:[r]},"parent"===r.type&&(t.seekingParent=[r.slot]);var n=S(e.rhs);"function"===n.type&&"path"===n.procedure.type&&1===n.procedure.steps.length&&"name"===n.procedure.steps[0].type&&"function"===t.steps[t.steps.length-1].type&&(t.steps[t.steps.length-1].nextFunction=n.procedure.steps[0].value),"path"===n.type?Array.prototype.push.apply(t.steps,n.steps):(void 0!==n.predicate&&(n.stages=n.predicate,delete n.predicate),t.steps.push(n)),t.steps.filter((function(e){if("number"===e.type||"value"===e.type)throw{code:"S0213",stack:(new Error).stack,position:e.position,value:e.value};return"string"===e.type})).forEach((function(e){e.type="name"})),t.steps.filter((function(e){return!0===e.keepArray})).length>0&&(t.keepSingletonArray=!0);var i=t.steps[0];"unary"===i.type&&"["===i.value&&(i.consarray=!0);var o=t.steps[t.steps.length-1];"unary"===o.type&&"["===o.value&&(o.consarray=!0),D(t);break;case"[":var s=t=S(e.lhs),u="predicate";if("path"===t.type&&(s=t.steps[t.steps.length-1],u="stages"),void 0!==s.group)throw{code:"S0209",stack:(new Error).stack,position:e.position};void 0===s[u]&&(s[u]=[]);var l=S(e.rhs);void 0!==l.seekingParent&&(l.seekingParent.forEach((e=>{1===e.level?T(s,e):e.level--})),A(s,l)),s[u].push({type:"filter",expr:l,position:e.position});break;case"{":if(void 0!==(t=S(e.lhs)).group)throw{code:"S0210",stack:(new Error).stack,position:e.position};t.group={lhs:e.rhs.map((function(e){return[S(e[0]),S(e[1])]})),position:e.position};break;case"^":"path"!==(t=S(e.lhs)).type&&(t={type:"path",steps:[t]});var p={type:"sort",position:e.position};p.terms=e.rhs.map((function(e){var t=S(e.expression);return A(p,t),{descending:e.descending,expression:t}})),t.steps.push(p),D(t);break;case":=":(t={type:"bind",value:e.value,position:e.position}).lhs=S(e.lhs),t.rhs=S(e.rhs),A(t,t.rhs);break;case"@":if(t=S(e.lhs),s=t,"path"===t.type&&(s=t.steps[t.steps.length-1]),void 0!==s.stages||void 0!==s.predicate)throw{code:"S0215",stack:(new Error).stack,position:e.position};if("sort"===s.type)throw{code:"S0216",stack:(new Error).stack,position:e.position};e.keepArray&&(s.keepArray=!0),s.focus=e.rhs.value,s.tuple=!0;break;case"#":t=S(e.lhs),s=t,"path"===t.type?s=t.steps[t.steps.length-1]:(t={type:"path",steps:[t]},void 0!==s.predicate&&(s.stages=s.predicate,delete s.predicate)),void 0===s.stages?s.index=e.rhs.value:s.stages.push({type:"index",value:e.rhs.value,position:e.position}),s.tuple=!0;break;case"~>":(t={type:"apply",value:e.value,position:e.position}).lhs=S(e.lhs),t.rhs=S(e.rhs);break;default:(t={type:e.type,value:e.value,position:e.position}).lhs=S(e.lhs),t.rhs=S(e.rhs),A(t,t.lhs),A(t,t.rhs)}break;case"unary":t={type:e.type,value:e.value,position:e.position},"["===e.value?t.expressions=e.expressions.map((function(e){var r=S(e);return A(t,r),r})):"{"===e.value?t.lhs=e.lhs.map((function(e){var r=S(e[0]);A(t,r);var n=S(e[1]);return A(t,n),[r,n]})):(t.expression=S(e.expression),"-"===e.value&&"number"===t.expression.type?(t=t.expression).value=-t.value:A(t,t.expression));break;case"function":case"partial":(t={type:e.type,name:e.name,value:e.value,position:e.position}).arguments=e.arguments.map((function(e){var r=S(e);return A(t,r),r})),t.procedure=S(e.procedure);break;case"lambda":t={type:e.type,arguments:e.arguments,signature:e.signature,position:e.position};var f=S(e.body);t.body=w(f);break;case"condition":(t={type:e.type,position:e.position}).condition=S(e.condition),A(t,t.condition),t.then=S(e.then),A(t,t.then),void 0!==e.else&&(t.else=S(e.else),A(t,t.else));break;case"transform":(t={type:e.type,position:e.position}).pattern=S(e.pattern),t.update=S(e.update),void 0!==e.delete&&(t.delete=S(e.delete));break;case"block":(t={type:e.type,position:e.position}).expressions=e.expressions.map((function(e){var r=S(e);return A(t,r),(r.consarray||"path"===r.type&&r.steps[0].consarray)&&(t.consarray=!0),r}));break;case"name":t={type:"path",steps:[e]},e.keepArray&&(t.keepSingletonArray=!0);break;case"parent":t={type:"parent",slot:{label:"!"+x++,level:1,index:k++}},E.push(t);break;case"string":case"number":case"value":case"wildcard":case"descendant":case"variable":case"regex":t=e;break;case"operator":if("and"===e.value||"or"===e.value||"in"===e.value)e.type="name",t=S(e);else{if("?"!==e.value)throw{code:"S0201",stack:(new Error).stack,position:e.position,token:e.value};t=e}break;case"error":t=e,e.lhs&&(t=S(e.lhs));break;default:var d="S0206";"(end)"===e.id&&(d="S0207");var h={code:d,position:e.position,token:e.value};if(a)return c.push(h),{type:"error",error:h};throw h.stack=(new Error).stack,h}return e.keepArray&&(t.keepArray=!0),t};o=r(t),d();var O=h(0);if("(end)"!==i.id){var C={code:"S0201",position:i.position,token:i.value};f(C)}if("parent"===(O=S(O)).type||void 0!==O.seekingParent)throw{code:"S0217",token:O.type,position:O.position};return c.length>0&&(O.errors=c),O}})();t.exports=a},{"./signature":5}],5:[function(e,t,r){var n=e("./utils");const a=(()=>{"use strict";var e={a:"arrays",b:"booleans",f:"functions",n:"numbers",o:"objects",s:"strings"};return function(t){for(var r=1,a=[],i={},o=i;r<t.length;){var s=t.charAt(r);if(":"===s)break;var c=function(){a.push(i),o=i,i={}},u=function(e,t,r,n){for(var a=1,i=t;i<e.length;)if(i++,(s=e.charAt(i))===n){if(0==--a)break}else s===r&&a++;return i};switch(s){case"s":case"n":case"b":case"l":case"o":i.regex="["+s+"m]",i.type=s,c();break;case"a":i.regex="[asnblfom]",i.type=s,i.array=!0,c();break;case"f":i.regex="f",i.type=s,c();break;case"j":i.regex="[asnblom]",i.type=s,c();break;case"x":i.regex="[asnblfom]",i.type=s,c();break;case"-":o.context=!0,o.contextRegex=new RegExp(o.regex),o.regex+="?";break;case"?":case"+":o.regex+=s;break;case"(":var l=u(t,r,"(",")"),p=t.substring(r+1,l);if(-1!==p.indexOf("<"))throw{code:"S0402",stack:(new Error).stack,value:p,offset:r};i.regex="["+p+"m]",i.type="("+p+")",r=l,c();break;case"<":if("a"!==o.type&&"f"!==o.type)throw{code:"S0401",stack:(new Error).stack,value:o.type,offset:r};var f=u(t,r,"<",">");o.subtype=t.substring(r+1,f),r=f}r++}var d="^"+a.map((function(e){return"("+e.regex+")"})).join("")+"$",h=new RegExp(d),v=function(e){var t;if(n.isFunction(e))t="f";else switch(typeof e){case"string":t="s";break;case"number":t="n";break;case"boolean":t="b";break;case"object":t=null===e?"l":Array.isArray(e)?"a":"o";break;default:t="m"}return t};return{definition:t,validate:function(t,r){var n="";t.forEach((function(e){n+=v(e)}));var i=h.exec(n);if(i){var o=[],s=0;return a.forEach((function(n,a){var c=t[s],u=i[a+1];if(""===u)if(n.context&&n.contextRegex){var l=v(r);if(!n.contextRegex.test(l))throw{code:"T0411",stack:(new Error).stack,value:r,index:s+1};o.push(r)}else o.push(c),s++;else u.split("").forEach((function(r){if("a"===n.type){if("m"===r)c=void 0;else{c=t[s];var a=!0;if(void 0!==n.subtype)if("a"!==r&&u!==n.subtype)a=!1;else if("a"===r&&c.length>0){var i=v(c[0]);a=i===n.subtype.charAt(0)&&0===c.filter((function(e){return v(e)!==i})).length}if(!a)throw{code:"T0412",stack:(new Error).stack,value:c,index:s+1,type:e[n.subtype]};"a"!==r&&(c=[c])}o.push(c),s++}else o.push(c),s++}))})),o}!function(e,t){for(var r="^",n=0,i=0;i<a.length;i++){r+=a[i].regex;var o=t.match(r);if(null===o)throw{code:"T0410",stack:(new Error).stack,value:e[n],index:n+1};n=o[0].length}throw{code:"T0410",stack:(new Error).stack,value:e[n],index:n+1}}(t,n)}}}})();t.exports=a},{"./utils":6}],6:[function(e,t,r){const n=(()=>{"use strict";function e(e){var t=!1;if("number"==typeof e&&(t=!isNaN(e))&&!isFinite(e))throw{code:"D1001",value:e,stack:(new Error).stack};return t}var t=("function"==typeof Symbol?Symbol:{}).iterator||"@@iterator";return{isNumeric:e,isArrayOfStrings:function(e){var t=!1;return Array.isArray(e)&&(t=0===e.filter((function(e){return"string"!=typeof e})).length),t},isArrayOfNumbers:function(t){var r=!1;return Array.isArray(t)&&(r=0===t.filter((function(t){return!e(t)})).length),r},createSequence:function(){var e=[];return e.sequence=!0,1===arguments.length&&e.push(arguments[0]),e},isSequence:function(e){return!0===e.sequence&&Array.isArray(e)},isFunction:function(e){return e&&(!0===e._jsonata_function||!0===e._jsonata_lambda)||"function"==typeof e},isLambda:function(e){return e&&!0===e._jsonata_lambda},isIterable:function(e){return"object"==typeof e&&null!==e&&t in e&&"next"in e&&"function"==typeof e.next},getFunctionArity:function(e){return"number"==typeof e.arity?e.arity:"function"==typeof e.implementation?e.implementation.length:"number"==typeof e.length?e.length:e.arguments.length},isDeepEqual:function e(t,r){if(t===r)return!0;if("object"==typeof t&&"object"==typeof r&&null!==t&&null!==r){if(Array.isArray(t)&&Array.isArray(r)){if(t.length!==r.length)return!1;for(var n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0}var a=Object.getOwnPropertyNames(t),i=Object.getOwnPropertyNames(r);if(a.length!==i.length)return!1;for(a=a.sort(),i=i.sort(),n=0;n<a.length;n++)if(a[n]!==i[n])return!1;for(n=0;n<a.length;n++){var o=a[n];if(!e(t[o],r[o]))return!1}return!0}return!1},stringToArray:function(e){var t=[];for(let r of e)t.push(r);return t},isPromise:function(e){return"object"==typeof e&&null!==e&&"then"in e&&"function"==typeof e.then}}})();t.exports=n},{}]},{},[3])(3)},2705:(e,t,r)=>{var n=r(5639).Symbol;e.exports=n},4239:(e,t,r)=>{var n=r(2705),a=r(9607),i=r(2333),o=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?a(e):i(e)}},7561:(e,t,r)=>{var n=r(7990),a=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(a,""):e}},1957:(e,t,r)=>{var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=n},9607:(e,t,r)=>{var n=r(2705),a=Object.prototype,i=a.hasOwnProperty,o=a.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=i.call(e,s),r=e[s];try{e[s]=void 0;var n=!0}catch(e){}var a=o.call(e);return n&&(t?e[s]=r:delete e[s]),a}},2333:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},5639:(e,t,r)=>{var n=r(1957),a="object"==typeof self&&self&&self.Object===Object&&self,i=n||a||Function("return this")();e.exports=i},7990:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},3279:(e,t,r)=>{var n=r(3218),a=r(7771),i=r(4841),o=Math.max,s=Math.min;e.exports=function(e,t,r){var c,u,l,p,f,d,h=0,v=!1,m=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function b(t){var r=c,n=u;return c=u=void 0,h=t,p=e.apply(n,r)}function y(e){var r=e-d;return void 0===d||r>=t||r<0||m&&e-h>=l}function w(){var e=a();if(y(e))return x(e);f=setTimeout(w,function(e){var r=t-(e-d);return m?s(r,l-(e-h)):r}(e))}function x(e){return f=void 0,g&&c?b(e):(c=u=void 0,p)}function k(){var e=a(),r=y(e);if(c=arguments,u=this,d=e,r){if(void 0===f)return function(e){return h=e,f=setTimeout(w,t),v?b(e):p}(d);if(m)return clearTimeout(f),f=setTimeout(w,t),b(d)}return void 0===f&&(f=setTimeout(w,t)),p}return t=i(t)||0,n(r)&&(v=!!r.leading,l=(m="maxWait"in r)?o(i(r.maxWait)||0,t):l,g="trailing"in r?!!r.trailing:g),k.cancel=function(){void 0!==f&&clearTimeout(f),h=0,c=d=u=f=void 0},k.flush=function(){return void 0===f?p:x(a())},k}},3218:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},7005:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},3448:(e,t,r)=>{var n=r(4239),a=r(7005);e.exports=function(e){return"symbol"==typeof e||a(e)&&"[object Symbol]"==n(e)}},7771:(e,t,r)=>{var n=r(5639);e.exports=function(){return n.Date.now()}},3493:(e,t,r)=>{var n=r(3279),a=r(3218);e.exports=function(e,t,r){var i=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return a(r)&&(i="leading"in r?!!r.leading:i,o="trailing"in r?!!r.trailing:o),n(e,t,{leading:i,maxWait:t,trailing:o})}},4841:(e,t,r)=>{var n=r(7561),a=r(3218),i=r(3448),o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return NaN;if(a(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=a(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=s.test(e);return r||c.test(e)?u(e.slice(2),r?2:8):o.test(e)?NaN:+e}},2982:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(907),a=r(181);function i(e){return function(e){if(Array.isArray(e))return(0,n.Z)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,a.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}]);
//# sourceMappingURL=../sourcemaps/986.7ad212681abf4de81ab8a51c278d77e6.js.map