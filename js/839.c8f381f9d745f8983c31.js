(self.webpackChunkprovisioning_frontend=self.webpackChunkprovisioning_frontend||[]).push([[839],{93708:(e,t,n)=>{"use strict";n.d(t,{Zz:()=>r.Zz,go:()=>r.go,kD:()=>r.kD,zc:()=>r.zc});var r=n(58061)},61321:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Rt});var r=n(87462),a=n(70885),c=n(45987),i=n(45697),o=n.n(i),u=n(3669),s=n(93264),l=n.n(s),p=n(33806);const d={chosenSource:void 0,chosenNumOfInstances:1,chosenInstanceType:void 0,uploadedKey:!1,chosenRegion:void 0,chosenImageID:void 0,sshPublicName:"",sshPublicKey:"",chosenSshKeyId:void 0,chosenSshKeyName:null,provider:void 0};var f=(0,p.fH)((function(){return(0,s.useState)(d)})),m=f.Provider,b=f.useTracked,y=n(88767),v=new y.QueryClient;const h=function(e){var t=e.children;return l().createElement(y.QueryClientProvider,{client:v},t)};var g=function(e){var t=e.isOpen,n=e.onConfirm,r=e.onCancel;return l().createElement(u.Modal,{ouiaId:"app-confirm-modal",id:"app-confirm-modal","aria-label":"confirm cancel of launch modal",variant:u.ModalVariant.small,title:"Exit instance launching?",isOpen:t,onClose:r,actions:[l().createElement(u.Button,{key:"exit",variant:"primary",onClick:n,ouiaId:"btn-exit-confirm"},"Exit"),l().createElement(u.Button,{key:"stay",variant:"link",onClick:r},"Stay")],titleIconVariant:"warning"},"All inputs will be discarded.")};g.propTypes={isOpen:o().bool.isRequired,onConfirm:o().func.isRequired,onCancel:o().func.isRequired};const O=g;var S=n(80159),E=n(64572),w=n(93708),P=function(e){switch(e){case w.Zz:return"us-east-1";case w.go:return"us-central1-a";case w.kD:return"eastus";default:throw new Error("Unrecognized provider was entered: ".concat(e))}},I=function(e){switch(e){case w.Zz:return"Amazon cloud";case w.kD:return"Azure";case w.go:return"Google cloud";default:throw new Error("Unrecognized provider was entered: ".concat(e))}},j=n(84213),D=n(57223),k="sources",_="pubkeys",T="image_region",x=n(15861),Z=n(64687),C=n.n(Z),z=n(65564),N=n.n(z),R=n(58061),A=function(e){return"/api/provisioning/v1/".concat(e)},L=function(e){return"/api/image-builder/v1/".concat(e)},V=function(e,t){return e===R.kD?A("instance_types/".concat(e,"?region=").concat(t,"&zone=1")):A("instance_types/".concat(e,"?region=").concat(t))},q=function(){var e=(0,x.Z)(C().mark((function e(t){var n,r;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(A("sources?provider=".concat(t)));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=(0,x.Z)(C().mark((function e(){var t,n;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(A("pubkeys"));case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,x.Z)(C().mark((function e(t,n){var r,a,c;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=V(n,t),e.next=3,N().get(r);case 3:return a=e.sent,c=a.data,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),G=function(e){return function(){var t=(0,x.Z)(C().mark((function t(n){return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",N().post(A("reservations/".concat(e)),n));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},K=function(){var e=(0,x.Z)(C().mark((function e(t){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",N().post(A("pubkeys"),t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=(0,x.Z)(C().mark((function e(t){var n,r;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(A("reservations/".concat(t)));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=(0,x.Z)(C().mark((function e(t){var n,r;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(L("composes/".concat(t,"/clones")));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=(0,x.Z)(C().mark((function e(t){var n,r;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(L("clones/".concat(t)));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=(0,x.Z)(C().mark((function e(t,n){var r,a;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(A("reservations/".concat(n,"/").concat(t)));case 2:return r=e.sent,a=r.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),U=function(){var e=(0,x.Z)(C().mark((function e(t,n){var r,a;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(A("/sources/".concat(t,"/launch_templates?region=").concat(n)));case 2:return r=e.sent,a=r.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){(0,E.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=function(e){var t=e.setValidation,n=e.imageSourceID,r=b(),c=(0,a.Z)(r,2),i=c[0],o=i.provider,s=i.chosenSource,p=c[1],d=l().useState(!1),f=(0,a.Z)(d,2),m=f[0],v=f[1],h=l().useState(null),g=(0,a.Z)(h,2),O=g[0],S=g[1],E=function(e,t){return{id:e,toString:function(){return t},compareTo:function(t){return t.id===e}}},P=(0,y.useQuery)([k,o],(function(){return q(o)}),{enabled:!!o,onSuccess:function(e){var r=s;if(w.zc.includes(o)&&n)S(E(n,e.find((function(e){return e.id===n})).name)),p((function(e){return $($({},e),{},{chosenSource:n})})),t("success");else{if(!r)return;S(E(r,e.find((function(e){return e.id===r})).name))}}}),I=P.error,j=P.isLoading,D=P.data;return I?(console.warn("Failed to fetch sources list"),l().createElement(l().Fragment,null,l().createElement(u.Alert,{ouiaId:"select_account_alert",variant:"warning",isInline:!0,title:"There are problems fetching accounts"}),l().createElement(u.Select,{ouiaId:"select_account_empty",isDisabled:!0,placeholderText:"No accounts found","aria-label":"Select account"}))):j?l().createElement(u.Spinner,{isSVG:!0,size:"sm","aria-label":"Loading accounts"}):l().createElement(u.Select,{ouiaId:"select_account",isOpen:m,onToggle:function(e){return v(e)},selections:O,isDisabled:!!n,onSelect:function(e,n,r){r?(S(null),p((function(e){return $($({},e),{},{chosenSource:null})})),t("error")):(S(n),p((function(e){return $($({},e),{},{chosenSource:n.id})})),t("success")),v(!1)},placeholderText:"Select account","aria-label":"Select account"},D&&D.map((function(e){var t=e.name,n=e.id;return l().createElement(u.SelectOption,{"aria-label":"Source account",key:n,value:E(n,t)})})))};X.propTypes={setValidation:o().func.isRequired,imageSourceID:o().number};const Y=X;function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){(0,E.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const ne=function(){var e=b(),t=(0,a.Z)(e,2),n=t[0].chosenNumOfInstances,r=t[1];return l().createElement(u.NumberInput,{max:45,min:1,value:n,onMinus:function(){var e=n-1;r((function(t){return te(te({},t),{},{chosenNumOfInstances:e})}))},onChange:function(e){var t=Math.floor(Number(e.target.value));t>45&&(t=45),t<1&&(t=1),r((function(e){return te(te({},e),{},{chosenNumOfInstances:t})}))},onPlus:function(){var e=n+1;r((function(t){return te(te({},t),{},{chosenNumOfInstances:e})}))},inputName:"instances",inputAriaLabel:"number of instances",minusBtnAriaLabel:"instances-minus",plusBtnAriaLabel:"instances-plus"})};function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){(0,E.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=function(e){var t=e.setValidation,n=e.architecture,c=b(),i=(0,a.Z)(c,2),o=i[0],s=o.chosenInstanceType,p=o.chosenRegion,d=o.chosenSource,f=o.provider,m=i[1],v=l().useState(!1),h=(0,a.Z)(v,2),g=h[0],O=h[1],S=l().useState(5),E=(0,a.Z)(S,2),w=E[0],P=E[1],I=l().useState(null),j=(0,a.Z)(I,2),D=j[0],k=j[1],_=l().useState(""),T=(0,a.Z)(_,2),x=T[0],Z=T[1],C=l().useState(!0),z=(0,a.Z)(C,2),N=z[0],R=z[1],A=(0,y.useQuery)(["instanceTypes",p],(function(){return B(p,f)}),{select:function(e){return e.filter((function(e){return e.architecture===n}))},enabled:!!p&&!!d}),L=A.isLoading,V=A.error,q=A.data;if(!d||""===d)return l().createElement(l().Fragment,null,l().createElement(u.TextInput,{ouiaId:"instance_type_readonly",className:"pf-c-form-control",readOnly:!0,type:"text",value:"Select account to load instances",id:"input-readonly","aria-label":"Select instance type - disabled"}));if(V)return console.warn("Failed to fetch instance types list"),l().createElement(l().Fragment,null,l().createElement(u.Alert,{ouiaId:"instance_type_alert",variant:"warning",isInline:!0,title:"There are problems fetching instance types"}),l().createElement(u.Select,{ouiaId:"instance_type_empty",isDisabled:!0,placeholderText:"No instance types found",toggleAriaLabel:"Select instance type"}));if(L)return l().createElement(u.Spinner,{isSVG:!0,size:"sm","aria-label":"Contents of the small example"});var F=D||q;return l().createElement(l().Fragment,null,!N&&l().createElement(u.Alert,{"data-testid":"unsupported_type_alert",ouiaId:"instance_type_not_supported_alert",variant:"warning",isInline:!0,title:"Warning: The selected specification does not meet minimum requirements for this image."}),l().createElement(u.Select,(0,r.Z)({ouiaId:"select_instance_type",variant:"typeahead",typeAheadAriaLabel:"Selected instance type",toggleAriaLabel:"Select instance type",placeholderText:"Select instance type",maxHeight:"450px",isOpen:g,selections:s,onToggle:function(e){O(e)},onSelect:function(e,n,r){if(r)t("error"),R(!0),m((function(e){return ae(ae({},e),{},{chosenInstanceType:null})})),O(!1);else{var a=q.find((function(e){return n===e.name}));R(a.supported),m((function(e){return ae(ae({},e),{},{chosenInstanceType:n})})),t("success"),O(!1)}},onFilter:function(e,t){var n=t.replace(/\\+$/,"");x!==n&&(P(5),Z(n),k(q.filter((function(e){return e.name.includes(n)}))))}},w<(null==F?void 0:F.length)&&{loadingVariant:{text:"View more (".concat(F.length-w,")"),onClick:function(){return P(w+5)}}}),function(e,t){var n,r;return t<(null===(n=e)||void 0===n?void 0:n.length)&&(e=e.slice(0,t)),null===(r=e)||void 0===r?void 0:r.map((function(e,t){return l().createElement(u.SelectOption,{"aria-label":"Instance Type ".concat(e.name),key:t,description:"".concat(e.cores||"only vCPU"," cores |\n          ").concat(e.vcpus," vCPU |\n          ").concat((parseFloat(e.memory_mib)/1024).toFixed(1)," GiB memory |\n          ").concat(e.storage_gb>0?e.storage_gb+" GB storage | ":"EBS only | ","\n          ").concat(e.architecture),value:e.name})}))}(F,w)))};ce.propTypes={setValidation:o().func.isRequired,architecture:o().string.isRequired};const ie=ce;var oe=n(42982);function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){(0,E.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var le=function(e){var t=e.composeID,n=b(),r=(0,a.Z)(n,2),c=r[0],i=c.provider,o=c.chosenRegion,s=r[1],p=l().useState(!1),d=(0,a.Z)(p,2),f=d[0],m=d[1],v=(0,y.useQuery)([T,t],(function(){return M(t)}),{select:function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{id:e.id,region:e.request.region}}))}}),h=v.isError,g=v.isLoading,O=v.data,S=(0,y.useQueries)((null==O?void 0:O.map((function(e){return{queryKey:[T,e.id],queryFn:function(){return Q(e.id)}}})))||[]),E=S.some((function(e){return e.isLoading})),w=[{region:i&&P(i),id:t}];if(S.length&&S.every((function(e){return!1===e.isLoading}))){var I=null==S?void 0:S.map((function(e){return null==e?void 0:e.data})),j=null==O?void 0:O.filter((function(e,t){return"success"===I[t].status}));w.push.apply(w,(0,oe.Z)(j))}return h?l().createElement(l().Fragment,null,l().createElement(u.Alert,{ouiaId:"regions_alert",variant:"warning",isInline:!0,title:"There are problems fetching image's regions"}),l().createElement(u.Select,{ouiaId:"regions_empty",isDisabled:!0,placeholderText:"No regions have been found"})):g||E?l().createElement(u.Spinner,{isSVG:!0,size:"sm","aria-label":"loading available regions"}):l().createElement(u.Select,{ouiaId:"select_regions",variant:"typeahead","aria-label":"Select region",label:"Select region",maxHeight:"450px",isOpen:f,selections:o,onToggle:function(e){m(e)},onSelect:function(e,t){s((function(e){var n;return se(se({},e),{},{chosenRegion:t,chosenImageID:null===(n=w.find((function(e){return e.region===t})))||void 0===n?void 0:n.id})})),m(!1)},isDisabled:((null==O?void 0:O.length)||0)<=1},w.map((function(e){var t=e.id,n=e.region;return l().createElement(u.SelectOption,{"aria-label":"Region item",key:t,value:n})})))};le.propTypes={composeID:o().string.isRequired};const pe=le;function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){(0,E.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const me=function(){var e,t=b(),n=(0,a.Z)(t,2),r=n[0],c=r.chosenSource,i=r.chosenRegion,o=r.chosenTemplate,s=n[1],p=l().useState(!1),d=(0,a.Z)(p,2),f=d[0],m=d[1],v=(0,y.useQuery)(["Templates","".concat(i,"-").concat(c)],(function(){return U(c,i)}),{enabled:!!c&&!!i}),h=v.error,g=v.isLoading,O=v.data,S=o&&(null===(e=O.find((function(e){return e.id===o})))||void 0===e?void 0:e.name);return h?l().createElement(l().Fragment,null,l().createElement(u.Alert,{ouiaId:"select_template_alert",variant:"warning",isInline:!0,title:"There are problems fetching templates"}),l().createElement(u.Select,{ouiaId:"select_template_empty",isDisabled:!0,placeholderText:"No templates found","aria-label":"Select template"})):g?l().createElement(u.Spinner,{isSVG:!0,size:"sm","aria-label":"Loading templates"}):l().createElement(u.Select,{ouiaId:"select_templates",isOpen:f,onToggle:function(e){return m(e)},selections:S,onSelect:function(e,t,n){n||s((function(e){var n;return fe(fe({},e),{},{chosenTemplate:null===(n=O.find((function(e){return e.name===t})))||void 0===n?void 0:n.id})})),m(!1)},placeholderText:"Select templates","aria-label":"Select templates"},O&&O.map((function(e){var t=e.name,n=e.id;return l().createElement(u.SelectOption,{"aria-label":"template option",key:n,value:t})})))};function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){(0,E.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ve=function(e){var t=e.setStepValidated,n=e.architecture,r=e.composeID,c=e.imageSourceID,i=b(),o=(0,a.Z)(i,1)[0],s=o.chosenSource,p=o.chosenInstanceType,d=l().useState({sources:s?"success":"default",types:p?"success":"default"}),f=(0,a.Z)(d,2),m=f[0],y=f[1],v=(0,D.useFlag)("provisioning.aws.templates");return l().useEffect((function(){var e=Object.values(m).some((function(e){return"success"!==e}));t(!e)}),[m]),l().createElement(u.Form,null,l().createElement(u.Title,{ouiaId:"account_custom_title",headingLevel:"h1",size:"xl"},"Account and customizations | Amazon"),l().createElement(u.Text,{ouiaId:"account_custom_description"},"Configure instances that will run on your AWS. All the instances will launch with the same configuration."),l().createElement(u.FormGroup,{label:"Select account",validated:m.sources,helperTextInvalid:"Please pick a value",isRequired:!0,fieldId:"aws-select-source"},l().createElement(Y,{imageSourceID:c,setValidation:function(e){return y((function(t){return ye(ye({},t),{},{sources:e})}))}})),l().createElement(u.FormGroup,{label:"Select region",isRequired:!0,fieldId:"aws-select-region",labelIcon:l().createElement(u.Popover,{bodyContent:"Select available geographical region"},l().createElement(u.Button,{ouiaId:"region_help",type:"button","aria-label":"More info for regions field",onClick:function(e){return e.preventDefault()},"aria-describedby":"aws-select-region",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(j.ZP,{noVerticalAlign:!0})))},l().createElement(pe,{composeID:r})),v&&l().createElement(u.FormGroup,{label:"Select template",fieldId:"aws-select-template",labelIcon:l().createElement(u.Popover,{bodyContent:l().createElement("span",null,"Launch templates contains the configuration information to launch an instance. Note that instance type and public SSH key will be still required and will override template values. For further information and for creating launch templates"," ",l().createElement("a",{rel:"noreferrer",target:"_blank",href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-launch-templates.html"},"click here"))},l().createElement(u.Button,{ouiaId:"template_help",type:"button","aria-label":"template field info",onClick:function(e){return e.preventDefault()},"aria-describedby":"aws-select-template",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(j.ZP,{noVerticalAlign:!0})))},l().createElement(me,null)),l().createElement(u.FormGroup,{label:"Select instance type",isRequired:!0,helperTextInvalid:"Please pick a value",fieldId:"aws-select-instance-types",labelIcon:l().createElement(u.Popover,{bodyContent:"Select AWS instance type based on your computing, memory, networking, or storage needs"},l().createElement(u.Button,{ouiaId:"instance_type_help",type:"button","aria-label":"More info for instance types field",onClick:function(e){return e.preventDefault()},"aria-describedby":"aws-select-instance-types",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(j.ZP,{noVerticalAlign:!0})))},l().createElement(ie,{architecture:n,setValidation:function(e){return y((function(t){return ye(ye({},t),{},{types:e})}))}})),l().createElement(u.FormGroup,{label:"Count",isRequired:!0,fieldId:"aws-select-instance-counter",labelIcon:l().createElement(u.Popover,{bodyContent:"Specify the number of AWS instances to be launched"},l().createElement(u.Button,{ouiaId:"instance_count_help",type:"button","aria-label":"More info for instance counter field",onClick:function(e){return e.preventDefault()},"aria-describedby":"aws-select-instance-counter",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(j.ZP,{noVerticalAlign:!0})))},l().createElement(ne,null)))};ve.propTypes={setStepValidated:o().func.isRequired,architecture:o().string.isRequired,composeID:o().string.isRequired,imageSourceID:o().number.isRequired};const he=ve;function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){(0,E.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Se=function(e){var t=e.setStepValidated,n=e.architecture,r=e.composeID,c=b(),i=(0,a.Z)(c,1)[0],o=l().useState({sources:i.chosenSource?"success":"default",types:i.chosenInstanceType?"success":"default"}),s=(0,a.Z)(o,2),p=s[0],d=s[1];return l().useEffect((function(){var e=Object.values(p).some((function(e){return"success"!==e}));t(!e)}),[p]),l().createElement(u.Form,null,l().createElement(u.Title,{ouiaId:"account_custom_title",headingLevel:"h1",size:"xl"},"Account and customizations | Google cloud"),l().createElement(u.Text,{ouiaId:"account_custom_description"},"Configure instances that will run on your Google cloud. All the instances will launch with the same configuration."),l().createElement(u.FormGroup,{label:"Select account",validated:p.sources,helperTextInvalid:"Please pick a value",isRequired:!0,fieldId:"gcp-select-source"},l().createElement(Y,{setValidation:function(e){return d((function(t){return Oe(Oe({},t),{},{sources:e})}))}})),l().createElement(u.FormGroup,{label:"Select zone",isRequired:!0,fieldId:"gcp-select-zone",labelIcon:l().createElement(u.Popover,{headerContent:l().createElement("div",null,"GCP zones")},l().createElement(u.Button,{ouiaId:"zone_help",type:"button","aria-label":"More info for zones field",onClick:function(e){return e.preventDefault()},"aria-describedby":"gcp-select-zone",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(j.ZP,{noVerticalAlign:!0})))},l().createElement(pe,{composeID:r})),l().createElement(u.FormGroup,{label:"Select machine type",isRequired:!0,helperTextInvalid:"Please pick a value",fieldId:"gcp-select-machine-types",labelIcon:l().createElement(u.Popover,{headerContent:l().createElement("div",null,"GCP machine types")},l().createElement(u.Button,{ouiaId:"machine_type_help",type:"button","aria-label":"More info for machine types field",onClick:function(e){return e.preventDefault()},"aria-describedby":"gcp-select-machine-types",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(j.ZP,{noVerticalAlign:!0})))},l().createElement(ie,{architecture:n,setValidation:function(e){return d((function(t){return Oe(Oe({},t),{},{types:e})}))}})),l().createElement(u.FormGroup,{label:"Count",isRequired:!0,fieldId:"gcp-select-instance-counter",labelIcon:l().createElement(u.Popover,{headerContent:l().createElement("div",null,"Number of GCP instances")},l().createElement(u.Button,{ouiaId:"instance_count_help",type:"button","aria-label":"More info for instance counter field",onClick:function(e){return e.preventDefault()},"aria-describedby":"gcp-select-instance-counter",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(j.ZP,{noVerticalAlign:!0})))},l().createElement(ne,null)))};Se.propTypes={architecture:o().string.isRequired,composeID:o().string.isRequired,setStepValidated:o().func.isRequired};const Ee=Se;function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){(0,E.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ie=function(e){var t=e.setStepValidated,n=e.architecture,r=e.composeID,c=b(),i=(0,a.Z)(c,1)[0],o=l().useState({sources:i.chosenSource?"success":"default",types:i.chosenInstanceType?"success":"default"}),s=(0,a.Z)(o,2),p=s[0],d=s[1];return l().useEffect((function(){var e=Object.values(p).some((function(e){return"success"!==e}));t(!e)}),[p]),l().createElement(u.Form,null,l().createElement(u.Title,{ouiaId:"account_custom_title",headingLevel:"h1",size:"xl"},"Account and customizations | Azure"),l().createElement(u.Text,{ouiaId:"account_custom_description"},"Configure instances that will run on your Azure cloud. All the instances will launch with the same configuration."),l().createElement(u.FormGroup,{label:"Select account",validated:p.sources,helperTextInvalid:"Please pick a value",isRequired:!0,fieldId:"azure-select-source"},l().createElement(Y,{setValidation:function(e){return d((function(t){return Pe(Pe({},t),{},{sources:e})}))}})),l().createElement(u.FormGroup,{label:"Select location",isRequired:!0,fieldId:"azure-select-location",labelIcon:l().createElement(u.Popover,{headerContent:l().createElement("div",null,"Azure locations")},l().createElement(u.Button,{ouiaId:"location_help",type:"button","aria-label":"More info for location field",onClick:function(e){return e.preventDefault()},"aria-describedby":"azure-select-location",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(j.ZP,{noVerticalAlign:!0})))},l().createElement(pe,{composeID:r})),l().createElement(u.FormGroup,{label:"Select instance size",isRequired:!0,helperTextInvalid:"Please pick a value",fieldId:"azure-select-instance-size",labelIcon:l().createElement(u.Popover,{headerContent:l().createElement("div",null,"Azure instance sizes")},l().createElement(u.Button,{ouiaId:"machine_type_help",type:"button","aria-label":"More info for instance size field",onClick:function(e){return e.preventDefault()},"aria-describedby":"azure-select-instance-size",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(j.ZP,{noVerticalAlign:!0})))},l().createElement(ie,{architecture:n,setValidation:function(e){return d((function(t){return Pe(Pe({},t),{},{types:e})}))}})),l().createElement(u.FormGroup,{label:"Count",isRequired:!0,fieldId:"azure-select-instance-counter",labelIcon:l().createElement(u.Popover,{headerContent:l().createElement("div",null,"Number of Azure instances")},l().createElement(u.Button,{ouiaId:"instance_count_help",type:"button","aria-label":"More info for instance counter field",onClick:function(e){return e.preventDefault()},"aria-describedby":"azure-select-instance-counter",className:"pf-c-form__group-label-help",variant:"plain"},l().createElement(j.ZP,{noVerticalAlign:!0})))},l().createElement(ne,null)))};Ie.propTypes={architecture:o().string.isRequired,composeID:o().string.isRequired,setStepValidated:o().func.isRequired};const je=Ie;function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){(0,E.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _e=function(e){var t=e.setStepValidated,n=e.architecture,r=e.composeID,c=e.provider,i=e.imageSourceID,o=b(),u=(0,a.Z)(o,2)[1];switch(l().useEffect((function(){c&&u((function(e){return ke(ke({},e),{},{provider:c,chosenRegion:P(c),chosenImageID:r})}))}),[c,u]),c){case w.Zz:return l().createElement(he,{setStepValidated:t,architecture:n,composeID:r,imageSourceID:i});case w.kD:return l().createElement(je,{setStepValidated:t,architecture:n,composeID:r});case w.go:return l().createElement(Ee,{setStepValidated:t,architecture:n,composeID:r});default:throw new Error("Can not render AccountCustomizations for unrecognized provider: ".concat(c))}};_e.propTypes={setStepValidated:o().func.isRequired,architecture:o().string.isRequired,composeID:o().string.isRequired,provider:o().oneOf([w.Zz,w.kD,w.go]),imageSourceID:o().number};const Te=_e;var xe=[500,600,700,800,900,1e3,1200,1400,1600,1800,2e3,3e3,4e3,5e3,1e4,15e3,2e4,25e3,3e4,6e4],Ze=[{name:"Create reservation",description:"Submit requested data"},{name:"Transfer keys",description:"Uploading public key to AWS"},{name:"Launch instance(s)",description:"Call AWS API for launching instance(s)"},{name:"Instance description",description:"Fetch instance(s) descriptions"}],Ce=[{name:"Create reservation",description:"Submit data of requested instances"},{name:"Ensure resource group",description:"Ensure resource group is present on Azure account"},{name:"Launch instance(s)",description:"Launch defined instance(s) on Azure"}],ze=[{name:"Create reservation",description:"Submit requested data"},{name:"Launch instance(s)",description:"Call Google API"}],Ne=[{name:"New SSH key",description:"Creating new SSH public key resource"}],Re=[w.Zz],Ae=function(e){switch(e){case w.Zz:return Ze;case w.kD:return Ce;case w.go:return ze;default:throw new Error("Steps requested for unknown provider: ".concat(e))}},Le=function(e){switch(e){case w.Zz:return"instance_type";case w.kD:return"instance_size";case w.go:return"machine_type";default:return"instance_type"}},Ve=function(e){switch(e){case w.Zz:return"region";case w.go:return"zone";default:return"region"}},qe=function(e){var t=e.imageName,n=b(),r=(0,a.Z)(n,1)[0],c=r.chosenRegion,i=r.chosenSshKeyName,o=r.uploadedKey,s=r.chosenInstanceType,p=r.chosenNumOfInstances,d=r.chosenSource,f=r.sshPublicName,m=r.provider,v=(0,y.useQuery)([k,m],(function(){return q(m)})).data,h=l().useState(!0),g=(0,a.Z)(h,2),O=g[0],S=g[1],E=Ve(m).charAt(0).toUpperCase()+Ve(m).slice(1),w=Le(m).replace("_"," "),P=w.charAt(0).toUpperCase()+w.slice(1);return l().createElement(u.ExpandableSection,{toggleText:m,onToggle:function(e){S(e)},isExpanded:O,isIndented:!0},l().createElement(u.DescriptionList,{isHorizontal:!0},l().createElement(u.DescriptionListGroup,null,l().createElement(u.DescriptionListTerm,null,"Image"),l().createElement(u.DescriptionListDescription,null,t)),l().createElement(u.DescriptionListGroup,null,l().createElement(u.DescriptionListTerm,null,"Account"),l().createElement(u.DescriptionListDescription,null,null==v?void 0:v.find((function(e){return e.id===d})).name)),l().createElement(u.DescriptionListGroup,null,l().createElement(u.DescriptionListTerm,null,E),l().createElement(u.DescriptionListDescription,null,c)),l().createElement(u.DescriptionListGroup,null,l().createElement(u.DescriptionListTerm,null,P),l().createElement(u.DescriptionListDescription,null,s)),l().createElement(u.DescriptionListGroup,null,l().createElement(u.DescriptionListTerm,null,"Count"),l().createElement(u.DescriptionListDescription,null,p)),l().createElement(u.DescriptionListGroup,null,l().createElement(u.DescriptionListTerm,null,o?"New SSH key":"Existing SSH key"),l().createElement(u.DescriptionListDescription,null,o?f:i))))};qe.propTypes={imageName:o().string.isRequired};const Fe=qe;var Be=function(e){var t=e.imageName;return l().createElement("div",{className:"pf-c-form"},l().createElement(u.Title,{ouiaId:"review_details_title",headingLevel:"h1"},"Review details"),l().createElement(u.Text,{ouiaId:"review_details_description"},"Review the information below and then click ",l().createElement("b",null,"Launch")," to finish the process."),l().createElement(Fe,{imageName:t}))};Be.propTypes={imageName:o().string.isRequired};const Ge=Be;function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){(0,E.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Me=function(e,t){return{id:e,toString:function(){return t},compareTo:function(t){return t.id==e}}},Qe=function(e){var t=e.setStepValidated,n=b(),r=(0,a.Z)(n,2),c=r[0],i=r[1],o=l().useState(!1),s=(0,a.Z)(o,2),p=s[0],d=s[1],f=l().useState(c.chosenSshKeyId?Me(c.chosenSshKeyId,c.chosenSshKeyName):null),m=(0,a.Z)(f,2),v=m[0],h=m[1];l().useEffect((function(){t(!!v)}),[v]);var g=(0,y.useQuery)(_,F),O=g.isLoading,S=g.isError,E=g.data;return O?l().createElement(u.Spinner,{isSVG:!0,size:"sm","aria-label":"Loading saved SSH keys"}):S||E&&E.length<1?l().createElement(l().Fragment,null,S&&l().createElement(u.Alert,{ouiaId:"pubkey_alert",variant:"warning",isInline:!0,title:"There are problems fetching saved SSH keys"}),l().createElement(u.Select,{ouiaId:"pubkey_empty",isDisabled:!0,placeholderText:"No SSH key found","aria-label":"Select public key"})):l().createElement(u.Select,{ouiaId:"select_pubkey",onToggle:function(e){return d(e)},onSelect:function(e,t){i((function(e){return He(He({},e),{},{chosenSshKeyId:t.id,chosenSshKeyName:t.toString()})})),h(t),d(!1)},isOpen:p,selections:v,placeholderText:"Select public key...","aria-label":"Select public key"},E.map((function(e){var t=e.id,n=e.name;return l().createElement(u.SelectOption,{"aria-label":"Public key ".concat(n),key:t,value:Me(t,n)})})))};Qe.propTypes={setStepValidated:o().func.isRequired};const We=Qe;function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){(0,E.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $e=function(e){return new RegExp("^(ssh|ecdsa)").test(e)},Xe=function(e){var t=e.setStepValidated,n=b(),r=(0,a.Z)(n,2),c=r[0],i=c.sshPublicName,o=c.sshPublicKey,s=r[1],p=l().useState(),d=(0,a.Z)(p,2),f=d[0],m=d[1],y=l().useState({sshKeyBody:$e(o)?"success":"default",sshKeyName:i?"success":"default"}),v=(0,a.Z)(y,2),h=v[0],g=v[1],O=l().useState(i),S=(0,a.Z)(O,2),w=S[0],P=S[1],I=l().useState(o),j=(0,a.Z)(I,2),D=j[0],k=j[1];l().useEffect((function(){var e=Object.values(h).some((function(e){return"success"!==e}));t(!e)}),[h]);var _=function(e,t){return g((function(n){return Je(Je({},n),{},(0,E.Z)({},e,t))}))};return l().createElement(u.FormGroup,{isStack:!0},l().createElement(u.FormGroup,{validated:h.sshKeyName,helperTextInvalid:"Name is required",label:"Name",isRequired:!0,fieldId:"ssh-name"},l().createElement(u.TextInput,{ouiaId:"new_pubkey_name",validated:h.sshKeyName,value:w,id:"public-key-name",onChange:function(e){s((function(t){return Je(Je({},t),{},{sshPublicName:e})})),P(e)},onBlur:function(){0!==w.length?_("sshKeyName","success"):_("sshKeyName","error")},type:"text"})),l().createElement(u.FormGroup,{helperTextInvalid:"Must be SSH public key format",label:"SSH public key",isRequired:!0,fieldId:"ssh-file",validated:h.sshKeyBody},l().createElement(u.FileUpload,{ouiaId:"new_pubkey_file",id:"public-key-value",onDataChange:function(e){$e(e)?(s((function(t){return Je(Je({},t),{},{sshPublicKey:e})})),k(e),_("sshKeyBody","success")):_("sshKeyBody","error")},allowEditingUploadedText:!0,onTextChange:function(e){s((function(t){return Je(Je({},t),{},{sshPublicKey:e})})),k(e)},onTextAreaBlur:function(){_("sshKeyBody",""===D?"default":$e(D)?"success":"error")},type:"text",value:D,validated:h.sshKeyBody,onReadStarted:function(){m(!0)},onReadFinished:function(){m(!1)},onReadFailed:function(){s((function(e){return Je(Je({},e),{},{sshPublicName:"<Failed to load the file>"})})),_("sshKeyBody","error")},onClearClick:function(){s((function(e){return Je(Je({},e),{},{sshPublicName:void 0,sshPublicKey:void 0})})),k(""),_("sshKeyBody","default")},isLoading:f,filenamePlaceholder:"Drag a file here"})))};Xe.propTypes={setStepValidated:o().func.isRequired};const Ye=Xe;function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach((function(t){(0,E.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var nt="newKey",rt=function(e){var t=e.setStepValidated,n=b(),r=(0,a.Z)(n,2),c=r[0],i=r[1],o=(0,y.useQuery)(_,F),s=o.isError,p=o.data,d=l().useState(!1),f=(0,a.Z)(d,2),m=f[0],v=f[1],h=function(e){i((function(t){return tt(tt({},t),{},{uploadedKey:nt===e})}))},g=function(e,t){h(t.currentTarget.value)};return l().useEffect((function(){(s||(null==p?void 0:p.length)<1)&&(v(!0),h(nt))}),[s,p]),l().createElement(u.Form,{className:"pubkeys"},l().createElement(u.Title,{ouiaId:"pubkey_title",headingLevel:"h1"},"SSH keys authentication"),l().createElement(u.Text,{ouiaId:"pubkey_description"},"Establish secure, reliable communication and strong encryption to protect data."),l().createElement(u.FormGroup,{role:"radiogroup",isStack:!0,isRequired:!0,label:"Select a method to add SSH pubic key"},l().createElement(u.Radio,{id:"existing-pubkey-radio",ouiaId:"pubkey_radio",isChecked:!c.uploadedKey,isDisabled:m,name:"ssh-keys-radio",value:"existKey",onChange:g,label:"Select existing SSH public key","data-testid":"existing-pubkey-radio",body:(!c.uploadedKey||m)&&l().createElement(u.FormGroup,{label:"Select public key"},l().createElement(We,{setStepValidated:t}))}),l().createElement(u.Radio,{id:"upload-pubkey-radio",ouiaId:"new_pubkey_radio",isChecked:c.uploadedKey,name:"ssh-keys-radio",value:nt,onChange:g,label:"Add and save a new SSH public key",description:"Newly added key will be automatically saved. Result of the provisioning will not be affected this process.","data-testid":"upload-pubkey-radio",body:c.uploadedKey&&l().createElement(Ye,{setStepValidated:t})})))};rt.propTypes={setStepValidated:o().func.isRequired};const at=rt;var ct=n(16948),it=n(41942),ot=n(35451);function ut(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return st(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?st(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,i=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){o=!0,c=e},f:function(){try{i||null==n.return||n.return()}finally{if(o)throw c}}}}function st(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var lt=C().mark((function e(t){var n,r,a;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=ut(t),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return a=r.value,e.next=7,a;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])}));var pt=n(51249),dt=n(58240),ft=n(76771),mt=n(97365),bt=n(3134),yt=n(24793),vt=n(50470);const ht=function(e,t,n){switch(t){case"aws":return"https://console.aws.amazon.com/ec2/home?region=".concat(n,"#InstanceDetails:instanceId=").concat(e);case"azure":return"https://portal.azure.com/#@rhdevcloudops.onmicrosoft.com/resource".concat(e,"/overview");default:return null}};function gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(n),!0).forEach((function(t){(0,E.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var St=[{title:"5",value:5},{title:"10",value:10},{title:"20",value:20},{title:"50",value:50}],Et=function(e){var t=e.reservationID,n=e.provider,r=e.region,c=l().useState({perPage:5,page:1,startIdx:0,endIdx:5}),i=(0,a.Z)(c,2),o=i[0],s=i[1],p=(0,y.useQuery)(["launchInfo",t],(function(){return W(t,n)}),{select:function(e){return null==e?void 0:e.instances}}).data,d=null==p?void 0:p.slice(o.startIdx,o.endIdx);return l().createElement(u.Card,{style:{position:"relative",marginLeft:"-20%",marginRight:"-20%"}},l().createElement(u.Pagination,{itemCount:(null==p?void 0:p.length)||0,page:o.page,onSetPage:function(e,t,n,r,a){s({perPage:n,page:t,startIdx:r,endIdx:a})},perPage:o.perPage,onPerPageSelect:function(e,t,n,r,a){s((function(e){return Ot(Ot({},e),{},{perPage:t,page:n,startIdx:r,endIdx:a})}))},perPageOptions:St,isCompact:!0,ouiaId:"instances-pagination"}),l().createElement(pt.X,{ouiaId:"instances table","aria-label":"instances description table",variant:"compact"},l().createElement(dt.h,null,l().createElement(ft.Tr,null,l().createElement(mt.Th,null,"ID"),l().createElement(mt.Th,null,"DNS"),l().createElement(mt.Th,null,"SSH command"))),l().createElement(bt.p,null,null==d?void 0:d.map((function(e){var t=e.instance_id,a=e.detail;return l().createElement(ft.Tr,{key:t},l().createElement(yt.Td,{"aria-label":"instance id",dataLabel:"ID"},l().createElement("a",{href:ht(t,n,r),rel:"noreferrer",target:"_blank"},l().createElement("span",null,t," ",l().createElement(vt.ZP,null)))),l().createElement(yt.Td,{"aria-label":"instance dns",dataLabel:"DNS"},null!=a&&a.public_dns?l().createElement(u.ClipboardCopy,{isReadOnly:!0,hoverTip:"Copy DNS",clickTip:"DNS was copied!",variant:"expansion"},null==a?void 0:a.public_dns):"N/A"),l().createElement(yt.Td,{dataLabel:"SSH"},null!=a&&a.public_ipv4?l().createElement(u.ClipboardCopy,{isReadOnly:!0,hoverTip:"Copy SSH command",clickTip:"SSH was copied!",variant:"expansion"},"ssh ".concat(function(e){if(e===w.Zz)return"ec2-user"}(n),"@").concat(null==a?void 0:a.public_ipv4)):"N/A"))})))))};Et.propTypes={provider:o().string.isRequired,region:o().string.isRequired,reservationID:o().number.isRequired};const wt=Et;function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function It(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(n),!0).forEach((function(t){(0,E.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var jt=function(e){var t=e.setLaunchSuccess,n=l().useState([]),r=(0,a.Z)(n,2),c=r[0],i=r[1],o=l().useState(),s=(0,a.Z)(o,2),p=s[0],d=s[1],f=l().useState(),m=(0,a.Z)(f,2),v=m[0],h=m[1],g=l().useState(0),O=(0,a.Z)(g,2),S=O[0],w=O[1],P=l().useState(0),j=(0,a.Z)(P,2),D=j[0],k=j[1],_=l().useState(),T=(0,a.Z)(_,2),x=T[0],Z=T[1],C=b(),z=(0,a.Z)(C,1)[0],N=z.chosenSource,R=z.chosenInstanceType,A=z.chosenNumOfInstances,L=z.chosenRegion,V=z.sshPublicName,q=z.sshPublicKey,F=z.chosenSshKeyId,B=z.uploadedKey,M=z.chosenImageID,Q=z.provider,W=z.chosenTemplate,U=function(e){var t=l().useRef(null),n=l().useRef(e),r=l().useState(),c=(0,a.Z)(r,2),i=c[0],o=c[1];return l().useEffect((function(){t.current=lt(n.current)}),[]),{nextInterval:function(){var e=t.current.next().value;return o(void 0!==e&&e),void 0!==e&&e},currentInterval:i}}(xe),J=U.nextInterval,$=U.currentInterval,X=(0,y.useMutation)(G(Q),{onSuccess:function(e){var t;ie(),Z(null==e||null===(t=e.data)||void 0===t?void 0:t.reservation_id)}}),Y=X.mutate,ee=X.error,te=function(){var e;return It((e={source_id:N},(0,E.Z)(e,Le(Q),R),(0,E.Z)(e,"amount",A),(0,E.Z)(e,"image_id",M),(0,E.Z)(e,Ve(Q),L),(0,E.Z)(e,"pubkey_id",F),e),W&&{launch_template_id:W})};l().useEffect((function(){G&&(B?(i(Ne.concat(Ae(Q))),re({name:V,body:q})):(i(Ae(Q)),Y(te())))}),[G,i,B]);var ne=(0,y.useMutation)(K,{onSuccess:function(e){var t;ie(),Y(It(It({},te()),{},{pubkey_id:null==e||null===(t=e.data)||void 0===t?void 0:t.id}))}}),re=ne.mutate,ae=ne.error,ce=(0,y.useQuery)(["reservation",x],(function(){return H(x)}),{enabled:!!x&&S<c.length&&!p,refetchInterval:function(e){return!(null!=e&&e.success||null!=e&&e.error)&&$},onSuccess:function(e){D<e.step&&!e.error&&(k((function(e){return e+1})),ie()),(null==e||!e.success)&&J(),e.success&&t()},refetchIntervalInBackground:!0}).data;l().useEffect((function(){if(!1===$&&h("The launch progress is slower than expected, but we are still on it.\n         It is safe to close this window and check your ".concat(I(Q)," console later")),ee||ae||null!=ce&&ce.error){var e,t,n,r,a=null==ee||null===(e=ee.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.msg,c=null==ae||null===(n=ae.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.msg;d(a||c||(null==ce?void 0:ce.error))}}),[ee,ae,null==ce?void 0:ce.error,$]);var ie=function(){return w((function(e){return e+1}))};return l().createElement(u.WizardContextConsumer,null,(function(e){var t=e.goToStepById,n=e.onClose;return l().createElement(u.EmptyState,{variant:"large"},l().createElement(u.EmptyStateIcon,{color:(null==ce?void 0:ce.success)&&"#3E8635",icon:null!=ce&&ce.success?ot.ZP:ct.ZP}),l().createElement(u.Title,{headingLevel:"h4",size:"lg",ouiaId:"launch-status"},null!=ce&&ce.success?"System(s) launched successfully":"Launching system(s)"),x&&l().createElement(u.Text,{component:"small",ouiaId:"launch-id"},"launch ID: ".concat(x)),l().createElement(u.EmptyStateBody,null,!(null!=ce&&ce.success)&&l().createElement(u.ProgressStepper,{isCenterAligned:!0},c.map((function(e,t){var n=e.name,r=e.description,a=function(e,t,n,r){return e<t?"success":e===t&&n?"danger":e===t&&r?"warning":e===t?"info":e>t?"pending":void 0}(t,S,p,v);return l().createElement(u.ProgressStep,{variant:a,id:n,key:n,icon:t>S?l().createElement(it.ZP,null):void 0,isCurrent:t===S,description:r,titleId:n,"aria-label":"step ".concat(n," ").concat(a),popoverRender:(p||v)&&t===S?function(e){return l().createElement(u.Popover,{"aria-label":"".concat(n," error message"),headerContent:p?"Error":"Warning",bodyContent:p||v,reference:e,position:"right"})}:void 0},n)})))),(null==ce?void 0:ce.success)&&Re.includes(Q)&&l().createElement(wt,{provider:Q,region:L,reservationID:x}),p&&l().createElement(u.Button,{id:"wizard-provisioning-failed-edit-button",onClick:function(){return t(1)},variant:"primary"},"Edit"),l().createElement(u.EmptyStateSecondaryActions,null,l().createElement(u.Button,{variant:"link",isDisabled:!p&&S<2,onClick:n},"Close")))}))};jt.propTypes={setLaunchSuccess:o().func.isRequired};const Dt=jt;function kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kt(Object(n),!0).forEach((function(t){(0,E.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Tt={1:"account",4:"sshkey",5:"review"},xt=function(e){return Tt[e]};const Zt=function(){return s.createElement(u.WizardFooter,null,s.createElement(u.WizardContextConsumer,null,(function(e){var t=e.activeStep,n=e.onNext,r=e.onBack,a=e.onClose,c=void 0===t.enableNext||t.enableNext;return s.createElement(s.Fragment,null,s.createElement(u.Button,{id:"wizard-provisioning-".concat(xt(t.id),"-next-button"),variant:u.ButtonVariant.primary,type:"submit",onClick:n,isDisabled:!c},t.nextButtonText||"Next"),!t.hideBackButton&&s.createElement(u.Button,{id:"wizard-provisioning-".concat(xt(t.id),"-back-button"),variant:u.ButtonVariant.secondary,onClick:r,isDisabled:1==t.id},"Back"),!t.hideCancelButton&&s.createElement("div",{className:S.Z.wizardFooterCancel},s.createElement(u.Button,{variant:u.ButtonVariant.link,onClick:a},"Cancel")))})))};var Ct=["isOpen","onClose","image"],zt={sshStep:!1,awsStep:!1},Nt=function(e){var t=e.isOpen,n=e.onClose,i=e.image,o=(0,c.Z)(e,Ct),s=l().useState(1),p=(0,a.Z)(s,2),d=p[0],f=p[1],b=l().useState(zt),y=(0,a.Z)(b,2),v=y[0],g=y[1],S=l().useState(!1),E=(0,a.Z)(S,2),w=E[0],P=E[1],j=l().useState(),D=(0,a.Z)(j,2),k=D[0],_=D[1],T=function(){P(!1),f(1),g(zt),n()},x=function(e){var t=e.stepIdReached,n=e.image,r=n.name,a=n.id,c=n.architecture,i=n.provider,o=n.sourceId,u=e.stepValidation,s=e.setStepValidation,p=e.setLaunchSuccess;return[{name:"Account and customization",steps:[{name:I(i),id:1,enableNext:u.awsStep,component:l().createElement(Te,{provider:i,architecture:c||"x86_64",composeID:a,imageSourceID:o,setStepValidated:function(e){return s((function(t){return _t(_t({},t),{},{awsStep:e})}))}}),canJumpTo:t>=1}]},{name:"SSH key authentication",id:4,component:l().createElement(at,{setStepValidated:function(e){return s((function(t){return _t(_t({},t),{},{sshStep:e})}))}}),canJumpTo:t>=4,enableNext:u.sshStep},{name:"Review details",id:5,component:l().createElement(Ge,{imageName:r}),canJumpTo:t>=5,nextButtonText:"Launch"},{name:"Finish Progress",id:6,component:l().createElement(Dt,{setLaunchSuccess:function(){return p(!0)},imageID:a}),isFinishedStep:!0}]}({stepIdReached:d,image:i,stepValidation:v,setStepValidation:g,setLaunchSuccess:_});return t?l().createElement(m,null,l().createElement(h,null,l().createElement(u.Wizard,(0,r.Z)({},o,{title:"Launch",description:"Launch image ".concat(i.name),steps:x,isOpen:!0,onClose:function(){d>=5&&!k?P(!0):T()},onNext:function(e,t){var n=e.id,r=e.name,a=t.prevId,c=t.prevName;console.debug("current id: ".concat(n,", current name: ").concat(r,", previous id: ").concat(a,", previous name: ").concat(c)),f((function(e){return e<n?n:e}))},className:"provisioning",footer:l().createElement(Zt,null)})),l().createElement(O,{isOpen:w,onConfirm:T,onCancel:function(){return P(!1)}}))):null};Nt.propTypes={isOpen:o().bool.isRequired,onClose:o().func,image:o().shape({name:o().string,id:o().string,architecture:o().string,provider:o().string}).isRequired};const Rt=Nt},58061:(e,t,n)=>{"use strict";n.d(t,{Zz:()=>r,go:()=>c,kD:()=>a,zc:()=>i});var r="aws",a="azure",c="gcp",i=[r]},11452:()=>{},34946:()=>{},32857:()=>{},28992:()=>{},30187:()=>{},21626:()=>{},66822:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},67761:()=>{},49854:()=>{},40209:()=>{},74543:()=>{}}]);
//# sourceMappingURL=../sourcemaps/839.925dc0fd2a7eec8ed4d6d6cb1c140ede.js.map